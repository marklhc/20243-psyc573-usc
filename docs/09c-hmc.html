<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.33">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>17&nbsp; Hamiltonian Monte Carlo – PSYC 573 Bayesian Data Analysis (2024 Fall): Course Notes</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./10-glm.html" rel="next">
<link href="./09b-gibbs.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-07ba0ad10f5680c660e360ac31d2f3b6.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-6d9163938730c4bb45bb2ddd9242afb9.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script type="text/javascript">

(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-225295148', 'auto');

ga('send', {
  hitType: 'pageview',
  'anonymizeIp': true,
});
</script><script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script><script src="site_libs/plotly-binding-4.10.4/plotly.js"></script><script src="site_libs/typedarray-0.1/typedarray.min.js"></script><script src="site_libs/jquery-3.5.1/jquery.min.js"></script><link href="site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script><link href="site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script><link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
</head>
<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">PSYC 573 Bayesian Data Analysis (2024 Fall): Course Notes</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item">
    <a class="nav-link" href="./../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./../modules.html"> 
<span class="menu-text">Modules</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./../docs/index.html"> 
<span class="menu-text">Notes</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./../exercises/index.html"> 
<span class="menu-text">Exercises</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./../syllabus/index.html"> 
<span class="menu-text">Syllabus</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./../resources.html"> 
<span class="menu-text">Resources</span></a>
  </li>  
</ul>
</div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
    <a href="https://github.com/marklhc/usc-psyc573-notes" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <a href="./PSYC-573-Bayesian-Data-Analysis--2024-Fall---Course-Notes.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./09-mcmc.html">Week 10–11</a></li><li class="breadcrumb-item"><a href="./09c-hmc.html"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Hamiltonian Monte Carlo</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Week 1</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Week 2</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-probability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Probability</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-bayes-theorem.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Bayes’s Theorem</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Week 3</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-beta-bernoulli-model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Beta-Bernoulli Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04b-beta-bernoulli-stan.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Beta-Bernoulli Model With Stan</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04c-poisson-model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Poisson Model</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Week 4</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-hierarchical-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Hierarchical Models</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Week 5–6</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-linear-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Linear Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06b-multiple-predictors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Multiple Predictors</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06c-regression-diagnostics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Model Diagnostics</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">Week 7</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-model-comparison.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Model Comparison</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07b-stacking-and-regularization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Stacking, Regularization, and Variable Selection</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">Week 9</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-causal-inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Causal Inference</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08b-mediation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Mediation</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true">
 <span class="menu-text">Week 10–11</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-mcmc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Markov Chain Monte Carlo</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09b-gibbs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Gibbs Sampling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09c-hmc.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Hamiltonian Monte Carlo</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="true">
 <span class="menu-text">Week 12</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-glm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Generalized Linear Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10b-glm2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Generalized Linear Model (II)</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#leapfrog-integrator" id="toc-leapfrog-integrator" class="nav-link active" data-scroll-target="#leapfrog-integrator"><span class="header-section-number">17.1</span> Leapfrog Integrator</a></li>
  <li><a href="#the-no-u-turn-sampler-nuts" id="toc-the-no-u-turn-sampler-nuts" class="nav-link" data-scroll-target="#the-no-u-turn-sampler-nuts"><span class="header-section-number">17.2</span> The No-U-Turn Sampler (NUTS)</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./09-mcmc.html">Week 10–11</a></li><li class="breadcrumb-item"><a href="./09c-hmc.html"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Hamiltonian Monte Carlo</span></a></li></ol></nav><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">
<span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Hamiltonian Monte Carlo</span>
</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><p>A more recent development in MCMC is the development of algorithms under the umbrella of <em>Hamiltonian Monte Carlo</em> or <em>hybrid Monte Carlo</em> (HMC). The algorithm is a bit complex, and my goal is to help you develop some intuition of the algorithm, hopefully, enough to help you diagnose the Markov chains.</p>
<ol type="1">
<li>It produces simulation samples that are much less correlated, meaning that if you get 10,000 samples from Metropolis and 10,000 samples from HMC, HMC generally provides a much higher effective sample size (ESS).</li>
<li>It does not require conjugate priors</li>
<li>When there is a problem in convergence, HMC tends to raise a clear red flag, meaning it goes really, really wrong.</li>
</ol>
<p>So now, how does HMC work? First, consider a two-dimensional posterior below, which is the posterior of <span class="math inline">\((\mu, \sigma^2)\)</span> from a normal model.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ybar</span> <span class="op">&lt;-</span> <span class="fl">3.096129</span></span>
<span><span class="va">s2y</span> <span class="op">&lt;-</span> <span class="fl">1.356451</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">31</span></span>
<span><span class="co"># Hyperparameters</span></span>
<span><span class="va">mu_0</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span><span class="va">sigma2_0</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">kappa_0</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">10</span><span class="op">^</span><span class="fl">2</span></span>
<span><span class="va">nu_0</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="co"># Joint log density</span></span>
<span><span class="va">lp_mu_sigma</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">mu</span>, <span class="va">sigma2</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">kappa_n</span> <span class="op">&lt;-</span> <span class="va">kappa_0</span> <span class="op">+</span> <span class="va">n</span></span>
<span>    <span class="va">mu_n</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">kappa_0</span> <span class="op">*</span> <span class="va">mu_0</span> <span class="op">+</span> <span class="va">n</span> <span class="op">*</span> <span class="va">ybar</span><span class="op">)</span> <span class="op">/</span> <span class="va">kappa_n</span></span>
<span>    <span class="va">nu_n</span> <span class="op">&lt;-</span> <span class="va">nu_0</span> <span class="op">+</span> <span class="va">n</span></span>
<span>    <span class="va">sigma2_n</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">nu_0</span> <span class="op">*</span> <span class="va">sigma2_0</span> <span class="op">+</span> <span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="va">s2y</span> <span class="op">+</span></span>
<span>        <span class="va">kappa_0</span> <span class="op">*</span> <span class="va">n</span> <span class="op">/</span> <span class="va">kappa_n</span> <span class="op">*</span> <span class="op">(</span><span class="va">ybar</span> <span class="op">-</span> <span class="va">mu_0</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="va">nu_n</span></span>
<span>    <span class="va">log_dens</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="op">(</span><span class="va">mu</span> <span class="op">-</span> <span class="va">mu_n</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">/</span> <span class="fl">2</span> <span class="op">/</span> <span class="va">sigma2</span> <span class="op">*</span> <span class="va">kappa_n</span> <span class="op">+</span></span>
<span>        <span class="op">(</span><span class="op">-</span><span class="va">nu_n</span> <span class="op">/</span> <span class="fl">2</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">sigma2</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="op">(</span><span class="op">-</span><span class="va">nu_n</span> <span class="op">*</span> <span class="va">sigma2_n</span> <span class="op">/</span> <span class="fl">2</span> <span class="op">/</span> <span class="va">sigma2</span><span class="op">)</span></span>
<span>    <span class="va">log_dens</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/is.finite.html">is.nan</a></span><span class="op">(</span><span class="va">log_dens</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="cn">Inf</span></span>
<span>    <span class="va">log_dens</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">num_gridpoints</span> <span class="op">&lt;-</span> <span class="fl">51</span></span>
<span><span class="va">mu_grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">2</span>, to <span class="op">=</span> <span class="fl">4</span>, length.out <span class="op">=</span> <span class="va">num_gridpoints</span><span class="op">)</span></span>
<span><span class="va">sigma2_grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0.5</span>, to <span class="op">=</span> <span class="fl">4.5</span>, length.out <span class="op">=</span> <span class="va">num_gridpoints</span><span class="op">)</span></span>
<span><span class="va">grid_density</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/outer.html">outer</a></span><span class="op">(</span><span class="va">mu_grid</span>,</span>
<span>    Y <span class="op">=</span> <span class="va">sigma2_grid</span>,</span>
<span>    FUN <span class="op">=</span> <span class="va">lp_mu_sigma</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">plot_ly</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="op">~</span><span class="va">sigma2_grid</span>, y <span class="op">=</span> <span class="op">~</span><span class="va">mu_grid</span>, z <span class="op">=</span> <span class="op">~</span><span class="va">grid_density</span>,</span>
<span>    type <span class="op">=</span> <span class="st">"surface"</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-normal-posterior" class="cell-output-display quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-normal-posterior-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="plotly html-widget html-fill-item" id="htmlwidget-eda704fd8d70b978da14" style="width:100%;height:650px;"></div>
<script type="application/json" data-for="htmlwidget-eda704fd8d70b978da14">{"x":{"visdat":{"122bcc10af28e8":["function () ","plotlyVisDat"]},"cur_data":"122bcc10af28e8","attrs":{"122bcc10af28e8":{"x":{},"y":{},"z":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"surface"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"sigma2_grid"},"yaxis":{"title":"mu_grid"},"zaxis":{"title":"grid_density"}},"hovermode":"closest","showlegend":false,"legend":{"yanchor":"top","y":0.5}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"colorbar":{"title":"grid_density","ticklen":2,"len":0.5,"lenmode":"fraction","y":1,"yanchor":"top"},"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666667","rgba(70,19,97,1)"],["0.0833333333333333","rgba(72,32,111,1)"],["0.125","rgba(71,45,122,1)"],["0.166666666666667","rgba(68,58,128,1)"],["0.208333333333333","rgba(64,70,135,1)"],["0.25","rgba(60,82,138,1)"],["0.291666666666667","rgba(56,93,140,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.375","rgba(46,114,142,1)"],["0.416666666666667","rgba(42,123,142,1)"],["0.458333333333333","rgba(38,133,141,1)"],["0.5","rgba(37,144,140,1)"],["0.541666666666667","rgba(33,154,138,1)"],["0.583333333333333","rgba(39,164,133,1)"],["0.625","rgba(47,174,127,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.708333333333333","rgba(79,191,110,1)"],["0.75","rgba(98,199,98,1)"],["0.791666666666667","rgba(119,207,85,1)"],["0.833333333333333","rgba(147,214,70,1)"],["0.875","rgba(172,220,52,1)"],["0.916666666666667","rgba(199,225,42,1)"],["0.958333333333333","rgba(226,228,40,1)"],["1","rgba(253,231,37,1)"]],"showscale":true,"x":[0.5,0.57999999999999996,0.66000000000000003,0.73999999999999999,0.82000000000000006,0.90000000000000002,0.97999999999999998,1.0600000000000001,1.1400000000000001,1.22,1.3,1.3799999999999999,1.46,1.54,1.6200000000000001,1.7,1.78,1.8600000000000001,1.9399999999999999,2.02,2.1000000000000001,2.1799999999999997,2.2599999999999998,2.3399999999999999,2.4199999999999999,2.5,2.5800000000000001,2.6600000000000001,2.7400000000000002,2.8199999999999998,2.8999999999999999,2.98,3.0600000000000001,3.1400000000000001,3.2200000000000002,3.3000000000000003,3.3799999999999999,3.46,3.54,3.6200000000000001,3.7000000000000002,3.7800000000000002,3.8599999999999999,3.9399999999999999,4.0199999999999996,4.0999999999999996,4.1799999999999997,4.2599999999999998,4.3399999999999999,4.4199999999999999,4.5],"y":[2,2.04,2.0800000000000001,2.1200000000000001,2.1600000000000001,2.2000000000000002,2.2400000000000002,2.2800000000000002,2.3199999999999998,2.3599999999999999,2.3999999999999999,2.4399999999999999,2.48,2.52,2.5600000000000001,2.6000000000000001,2.6400000000000001,2.6800000000000002,2.7199999999999998,2.7599999999999998,2.7999999999999998,2.8399999999999999,2.8799999999999999,2.9199999999999999,2.96,3,3.04,3.0800000000000001,3.1200000000000001,3.1600000000000001,3.2000000000000002,3.2400000000000002,3.2800000000000002,3.3200000000000003,3.3600000000000003,3.4000000000000004,3.4399999999999999,3.48,3.52,3.5600000000000001,3.6000000000000001,3.6400000000000001,3.6799999999999997,3.7199999999999998,3.7599999999999998,3.7999999999999998,3.8399999999999999,3.8799999999999999,3.9199999999999999,3.96,4],"z":[[6.2405139044304915e-30,2.7135850922367682e-26,1.1641758132896104e-23,1.0772700053784337e-21,3.4430169538983504e-20,5.1278898641120777e-19,4.3429465367038273e-18,2.3990597189465385e-17,9.5275612733873734e-17,2.9199186984510869e-16,7.2791791240160191e-16,1.5361844608702345e-15,2.8300407853256686e-15,4.6617312817745875e-15,6.9975418163724714e-15,9.7180087607446411e-15,1.2640591148613436e-14,1.5554570389211177e-14,1.8256590351348522e-14,2.0578347130066903e-14,2.2402592650617223e-14,2.3667634002499318e-14,2.4362936778909436e-14,2.4519288636218287e-14,2.4196727610858405e-14,2.3472640016820996e-14,2.2431509124619543e-14,2.1156995184769579e-14,1.9726448566792724e-14,1.8207605005657749e-14,1.6657042842682589e-14,1.5119940869003056e-14,1.3630710676754075e-14,1.2214149980558932e-14,1.0886846789034453e-14,9.6586430726376887e-15,8.5340331280819594e-15,7.5134237856711477e-15,6.5942215255406535e-15,5.7717374875813626e-15,5.0399177799218969e-15,4.3919158440485743e-15,3.8205280192428933e-15,3.3185145413958262e-15,2.878827274531107e-15,2.494763412107584e-15,2.1600618157470342e-15,1.8689559787755453e-15,1.6161950493500189e-15,1.3970420511489455e-15,1.2072564536553709e-15],[9.0219578086184652e-29,2.7140183930916604e-25,8.8077988508856955e-23,6.5488146783045714e-21,1.7551138005635577e-19,2.2616626207394763e-18,1.6969234717497706e-17,8.4576325320587741e-17,3.0746023834468916e-16,8.7259668970364539e-16,2.0336077571474138e-15,4.043545799137069e-15,7.064485127844738e-15,1.1096773665792241e-14,1.5958608472374928e-14,2.1319519614518268e-14,2.6769032549069231e-14,3.1893897951099979e-14,3.6342054392209546e-14,3.986200248237418e-14,4.2316321678924571e-14,4.3674539984485689e-14,4.3993103667610536e-14,4.3389865236736682e-14,4.2018706225916491e-14,4.0047741194097812e-14,3.7642658057611476e-14,3.4955395449674842e-14,3.2117550437151126e-14,2.9237541007400946e-14,2.6400476844176112e-14,2.366979307573209e-14,2.108988086862894e-14,1.8689144963594059e-14,1.6483097398599182e-14,1.4477243546860038e-14,1.266962779399823e-14,1.1052984652319513e-14,9.6164925991013199e-15,8.3471587776047193e-15,7.2308787317224217e-15,6.2532213638485226e-15,5.3999890068073559e-15,4.6575985676381142e-15,4.0133239808132379e-15,3.4554339036097663e-15,2.9732524283085879e-15,2.5571649777622692e-15,2.1985866775297443e-15,1.8899064066527254e-15,1.6244163870452258e-15],[1.1810963254284347e-27,2.4918992644824287e-24,6.1811287060651671e-22,3.7229051823295947e-20,8.4215766750654394e-19,9.4400605419678065e-18,6.3030727739245196e-17,2.8453015838806651e-16,9.4993623416380339e-16,2.5037681167970666e-15,5.4686058551397975e-15,1.0267551860550537e-14,1.7045488917111051e-14,2.5577261394580056e-14,3.52974499079045e-14,4.5425767673920527e-14,5.5130556231547256e-14,6.3675484476864971e-14,7.0516716845613272e-14,7.5342570006284106e-14,7.8065043614253831e-14,7.8780267465117378e-14,7.7715039586213014e-14,7.51727102900156e-14,7.1486593616564023e-14,6.6984594242733462e-14,6.1965527645178125e-14,5.6685726511388367e-14,5.1353696250222918e-14,4.6130455806924629e-14,4.1133466427534576e-14,3.6442484057174286e-14,3.2106128389042632e-14,2.8148367391692082e-14,2.4574439840912133e-14,2.1375976348422786e-14,1.8535241710956029e-14,1.6028523412530667e-14,1.3828748483533134e-14,1.1907437354945964e-14,1.0236109734760017e-14,8.7872519540654442e-15,7.5349433332128919e-15,6.4552246362422074e-15,5.5262769245210227e-15,4.7284653978308725e-15,4.0442907634629392e-15,3.4582805177473191e-15,2.9568442253050511e-15,2.5281102702295352e-15,2.1617564021112735e-15],[1.4001479694399895e-26,2.1003735019794442e-23,4.0236460411500055e-21,1.979166776510347e-19,3.8036761997977506e-18,3.7288899520435338e-17,2.2256387638801373e-16,9.1343897819552791e-16,2.8099476748672156e-15,6.8978284668130025e-15,1.4155027140429261e-14,2.5151099977541928e-14,3.9753881315529566e-14,5.7084628248448897e-14,7.5716483259696216e-14,9.4005198004039689e-14,1.1041967893652517e-13,1.2378043187260449e-13,1.3337287120784898e-13,1.3894868605903651e-13,1.4065150142485349e-13,1.389063755446465e-13,1.3430465008179675e-13,1.2750393505246606e-13,1.1915229630032959e-13,1.0983800958719918e-13,1.0006175161118879e-13,9.022616110801851e-14,8.0637449698604473e-14,7.1514404873697145e-14,6.3001156235344802e-14,5.5181134640224657e-14,4.8090571061812128e-14,4.1730595564323572e-14,3.6077506857724667e-14,3.1091119265168484e-14,2.6721295926007818e-14,2.291288272025895e-14,1.9609298650831812e-14,1.6755039744042135e-14,1.429733246925503e-14,1.2187141056335172e-14,1.0379698378277563e-14,8.8346966327883791e-15,7.5162441654734547e-15,6.3926693474291906e-15,5.4362315621564973e-15,4.6227827383084709e-15,3.9314099456030973e-15,3.344079747417182e-15,2.8452976896148402e-15],[1.5030265127456327e-25,1.6252154146669303e-22,2.4295359768386665e-20,9.8392942924631032e-19,1.6170955322712039e-17,1.3939339037234537e-16,7.4708380663604487e-16,2.7983531073312923e-15,7.9579333425437243e-15,1.8246031383362715e-14,3.5267074859913854e-14,5.9433677297273403e-14,8.9617069375394625e-14,1.2336504849845671e-13,1.5752022791954753e-13,1.8894099319753793e-13,2.150775066223243e-13,2.3428625330109931e-13,2.4588708814001384e-13,2.5003520046999916e-13,2.4749772281245534e-13,2.3941013141534798e-13,2.2706099331730281e-13,2.1172807065569192e-13,1.9457010630140557e-13,1.7656767387528251e-13,1.5850177477688176e-13,1.4095825255092228e-13,1.2434766738857927e-13,1.0893268118898749e-13,9.485744013196375e-14,8.217551275240634e-14,7.087451745319484e-14,6.0896670562685539e-14,5.2155185835272335e-14,4.4546857203409654e-14,3.7961349670871213e-14,3.2287782257809534e-14,2.7419166645946793e-14,2.325520357016983e-14,1.9703860678356418e-14,1.6682075383698975e-14,1.4115852280994002e-14,1.1939960729402818e-14,1.009738528254455e-14,8.5386393273355682e-15,7.2210193818035562e-15,6.107852524658923e-15,5.1677709004052353e-15,4.3740338076192595e-15,3.7039083693177822e-15],[1.461044480437321e-24,1.1544461730818498e-21,1.3607504398944803e-19,4.5743211383536882e-18,6.47127448851876e-17,4.9313136228098592e-16,2.3839451559027859e-15,8.1808273996411603e-15,2.1577476207966553e-14,4.6340656980346518e-14,8.4577106441425971e-14,1.3548579375559741e-13,1.9527338974664574e-13,2.5815046513389497e-13,3.178198525239287e-13,3.6882916192067083e-13,4.0741584322791011e-13,4.3177421049378646e-13,4.4187227611489963e-13,4.3901621275321659e-13,4.2534086636554256e-13,4.0334668090755197e-13,3.7554287246190396e-13,3.4421101513421072e-13,3.1127604674540154e-13,2.7825985526647249e-13,2.462908271648577e-13,2.1614629706024529e-13,1.8831039074746977e-13,1.630353344222317e-13,1.4039897963280483e-13,1.2035478506931369e-13,1.0277286900967355e-13,8.747221193840873e-14,7.4244889456736004e-14,6.2873566965149409e-14,5.3143559350919893e-14,4.4850673262571757e-14,3.7805888429272969e-14,3.1837749034287708e-14,2.6793155715353346e-14,2.2537088171289226e-14,1.8951653371139489e-14,1.5934745495469467e-14,1.339851874134696e-14,1.1267809557390322e-14,9.4785970363818117e-15,7.9765555939661635e-15,6.7157296633157599e-15,5.6573434147443546e-15,4.7687474455930322e-15],[1.2860691612623898e-23,7.5280899116292963e-21,7.0694432992694948e-19,1.9887055832580761e-17,2.4376198160783591e-16,1.6509765093808157e-15,7.2316181778866086e-15,2.2822524702813473e-14,5.6014347435655471e-14,1.130039690235144e-13,1.9523642930214349e-13,2.9794798867319309e-13,4.1127898542043776e-13,5.2307204635985649e-13,6.2190565413092265e-13,6.9927667450090235e-13,7.5054241636207147e-13,7.7478582798760864e-13,7.7401716280478833e-13,7.5212956344141151e-13,7.1390772983506761e-13,6.6424771175708964e-13,6.0763393577142694e-13,5.4785112824442428e-13,4.8787793239974415e-13,4.2990325382809294e-13,3.7541396563396053e-13,3.2531520125056595e-13,2.8005717848607343e-13,2.3975306358208781e-13,2.0428015246467478e-13,1.7336181424816142e-13,1.4663074142461307e-13,1.2367566741388224e-13,1.0407435337444013e-13,8.7415701288921726e-14,7.3313591843944862e-14,6.1414650540957828e-14,5.1401720127005199e-14,4.2994419612830723e-14,3.5947826468659179e-14,3.0050036993305381e-14,2.5119138021990323e-14,2.0999953853825028e-14,1.756080662190572e-14,1.4690437445445414e-14,1.2295171677056789e-14,1.0296367736574567e-14,8.6281600497783444e-15,7.2354883099473395e-15,6.0723944787520528e-15],[1.025107240009476e-22,4.5065506845954637e-20,3.4067756231722459e-18,8.0852876815437498e-17,8.6429923398273606e-16,5.2309069186661319e-15,2.0853886540649079e-14,6.0757777937638949e-14,1.3921825962439331e-13,2.6458361752277001e-13,4.3380398724305718e-13,6.3208094176412303e-13,8.3728073854249957e-13,1.0262612532433195e-12,1.1802303594637967e-12,1.2876492059637489e-12,1.3446429403389647e-12,1.3536977767269969e-12,1.3215914919225442e-12,1.25729577360407e-12,1.1702701463948501e-12,1.0692943287040553e-12,9.6181163061446362e-13,8.5367355644439145e-13,7.4915646792546611e-13,6.5113603028799038e-13,5.6133315098346715e-13,4.8057389939787307e-13,4.0902976857072238e-13,3.4642200679669606e-13,2.9218510035231037e-13,2.4559112442344391e-13,2.0583999623501162e-13,1.7212185207152711e-13,1.4365771887407011e-13,1.1972396991271992e-13,9.966512635446893e-14,8.2898614200818001e-14,6.8914223016233517e-14,5.727028609761162e-14,4.7588019773010701e-14,3.9545011027565484e-14,3.2868507823123154e-14,2.7328923517166453e-14,2.2733795297224055e-14,1.8922318989930167e-14,1.5760504693726061e-14,1.3136948226067478e-14,1.0959183854982865e-14,9.1505678826575141e-15,7.6476357784627615e-15],[7.3990909755089108e-22,2.4765783711372185e-19,1.5228370337010682e-17,3.073984002570109e-16,2.8845913079548978e-15,1.5684508641444371e-14,5.7167712628352544e-14,1.5435184293117904e-13,3.3127709175099074e-13,5.9479860938160205e-13,9.277925324561219e-13,1.2935716040397341e-12,1.6475811257410401e-12,1.9496747833396067e-12,2.1722402261932393e-12,2.3028774078276195e-12,2.3427886875448826e-12,2.3029093391921914e-12,2.1995644111914694e-12,2.0507605166327619e-12,1.8735670388186006e-12,1.6825968704984243e-12,1.4893731995945761e-12,1.3023045848576602e-12,1.1270152133155278e-12,9.6683762031842611e-13,8.2333966346617847e-13,6.968114328183454e-13,5.8667678945848434e-13,4.9181940751253336e-13,4.108276156437589e-13,3.4216929450234252e-13,2.8431035957332956e-13,2.3578998364663717e-13,1.9526405292023754e-13,1.6152624192645868e-13,1.3351400125769731e-13,1.1030490465024808e-13,9.1107280295700067e-14,7.5247857826243782e-14,6.2158261406057594e-14,5.136152070575302e-14,4.2459304161697782e-14,3.5120257052400941e-14,2.9069612454888856e-14,2.4080105868754374e-14,1.9964141115301898e-14,1.6567108868490787e-14,1.3761737405356444e-14,1.1443349049271467e-14,9.5258991965572152e-15],[4.8360582536970034e-21,1.2494193999988317e-18,6.3141502483728427e-17,1.0929212517679087e-15,9.062050103944511e-15,4.4506420962453432e-14,1.4897963843718072e-13,3.7419113707396235e-13,7.5471832409684174e-13,1.2838511684997961e-12,1.9099977511437756e-12,2.5538406243356107e-12,3.133744916949518e-12,3.5865281048416818e-12,3.8774634694544139e-12,4.0000811903357378e-12,3.969663260178706e-12,3.8145827836778549e-12,3.5683622888202607e-12,3.2638119979934961e-12,2.9294859365784153e-12,2.5880848301793752e-12,2.2562257507144606e-12,1.9450231844296796e-12,1.6610507820407145e-12,1.4073955452249134e-12,1.1846374645293485e-12,9.9167558344202513e-13,8.2637787241136023e-13,6.8606416030403862e-13,5.678463817299891e-13,4.6885499136774783e-13,3.8637924416895394e-13,3.1794521113449564e-13,2.613507321829828e-13,2.1467199153459994e-13,1.7625249214901917e-13,1.4468204672923473e-13,1.1877097123988073e-13,9.752286587107949e-14,8.0108078019558428e-14,6.5839046003301145e-14,5.4148120286510159e-14,4.4568069483245052e-14,3.6715238268111973e-14,3.0275186397786116e-14,2.4990568059263129e-14,2.0650984398976044e-14,1.7084542509540024e-14,1.4150869966572631e-14,1.1735357714105895e-14],[2.8622579476412646e-20,5.7864575009050591e-18,2.4284433528850263e-16,3.6337687068919331e-15,2.6797275034071592e-14,1.1951770707100798e-13,3.6907557661427093e-13,8.6565913205232629e-13,1.6461775295416133e-12,2.6607076526186112e-12,3.7847699694920299e-12,4.8638777244624158e-12,5.7613147701002257e-12,6.388429751934365e-12,6.712532032575e-12,6.7482556329113118e-12,6.5413686420234336e-12,6.1522266356697127e-12,5.6427915133551809e-12,5.0683665655058404e-12,4.4735538200737063e-12,3.8912806504922895e-12,3.3436982286871464e-12,2.8439926360820175e-12,2.3984569508123888e-12,2.0084435106804796e-12,1.6720142263868621e-12,1.3852343046813457e-12,1.1431263498191174e-12,9.403351793985473e-13,7.7156366503743599e-13,6.3183720592213493e-13,5.1664600700117435e-13,4.2200424317391015e-13,3.4445558550505605e-13,2.8104638169936221e-13,2.2928127438615619e-13,1.8707111356999653e-13,1.5267943369352464e-13,1.2467124483886685e-13,1.0186617383494466e-13,8.3296867186323201e-14,6.8172861842493978e-14,5.5849711624648102e-14,4.5802931219795386e-14,3.7606218114025517e-14,3.0913388522274759e-14,2.5443484365573884e-14,2.0968553609462951e-14,1.7303662362166534e-14,1.4298755776434869e-14],[1.5340167660825122e-19,2.4601729774736779e-17,8.6634849658495117e-16,1.1298136882692935e-14,7.4589348589143101e-14,3.0373837262516027e-13,8.6919253694977182e-13,1.9110501037976497e-12,3.437690144164396e-12,5.2944076644595696e-12,7.2188957869124867e-12,8.9362857124475108e-12,1.0238131217023613e-11,1.1018483615217016e-11,1.1269997525033143e-11,1.1057042470629118e-11,1.0482816626142687e-11,9.6612358637690592e-12,8.6978492185367222e-12,7.6796883391930136e-12,6.6719530993635752e-12,5.7190279470621543e-12,4.8477152880466577e-12,4.0712111274221963e-12,3.3929450961443658e-12,2.8098548671021415e-12,2.3149549979923676e-12,1.8992236989827801e-12,1.5529074532877528e-12,1.2663668014673362e-12,1.0305815010686797e-12,8.3741549120247092e-13,6.7972078525724679e-13,5.5133928836793233e-13,4.4704457630016061e-13,3.6245235687739123e-13,2.9391839863830997e-13,2.3843559313218658e-13,1.9353689982884569e-13,1.5720764531730771e-13,1.2780854900225318e-13,1.0400956715109838e-13,8.4733919271613257e-14,6.9111293817830991e-14,5.6439090359211433e-14,4.6150551661292561e-14,3.7788711431112101e-14,3.0985193117813584e-14,2.5443018179460762e-14,2.0922704506738699e-14,1.7231049508767261e-14],[7.4448428108998101e-19,9.6021143468860656e-17,2.8668756643840895e-15,3.285016275313093e-14,1.954271961447088e-13,7.3050786913220254e-13,1.9459378312490636e-12,4.0259555232160398e-12,6.8731381592268896e-12,1.0115220169188593e-11,1.3253381687532566e-11,1.5838606994382459e-11,1.7585750443744203e-11,1.840167508639284e-11,1.8351013865394434e-11,1.7595886904860959e-11,1.6337355533512741e-11,1.4772300108313279e-11,1.3068403989933392e-11,1.1354077897261077e-11,9.7183463330616885e-12,8.2161337418093975e-12,6.8756322834451202e-12,5.7057173587848222e-12,4.7023789280563207e-12,3.8537982379815756e-12,3.1440773135592986e-12,2.5558082558579852e-12,2.0717278104899144e-12,1.6756959908757478e-12,1.3532018676738257e-12,1.0915557654419941e-12,8.7988559626854341e-13,7.0902028243971221e-13,5.7131617190659669e-13,4.6046240187343667e-13,3.7128706893211337e-13,2.9957647666876187e-13,2.4191345644173551e-13,1.9553682357409484e-13,1.582216987677737e-13,1.281791516865205e-13,1.03973027945571e-13,8.4451639981324978e-14,6.869206165945101e-14,5.5954952846142149e-14,4.5648082657970249e-14,3.729697620706876e-14,3.0521355374095948e-14,2.5016267244238121e-14,2.0536989337497297e-14],[3.2717871986592227e-18,3.4404595524213196e-16,8.7998784511848793e-15,8.9320132961477044e-14,4.8196465904544644e-13,1.6626772832525588e-12,4.1414671865576827e-12,8.0935231347632388e-12,1.3156540405274187e-11,1.8555430873658192e-11,2.3421100016746197e-11,2.708086047552321e-11,2.9197270071685812e-11,2.9757792261468355e-11,2.8979781003529556e-11,2.7196190744088771e-11,2.4761670430839928e-11,2.1992704408166118e-11,1.9139299351257705e-11,1.6379205766804789e-11,1.3825181076546353e-11,1.1537943243892633e-11,9.5401166611699122e-12,7.8286766598363672e-12,6.3849029369257614e-12,5.1817311604288406e-12,4.1888225260037919e-12,3.3758231067982536e-12,2.7142859609223964e-12,2.1786618351389799e-12,1.7466766121562865e-12,1.3993295578563831e-12,1.1206759472202465e-12,8.975031270805991e-13,7.1896921220887843e-13,5.7624575300781335e-13,4.6218701572412856e-13,3.7103646902908453e-13,2.9817366287309049e-13,2.399004017830757e-13,1.9326286354546753e-13,1.5590533609406559e-13,1.2595102822193283e-13,1.0190561816097484e-13,8.2579625464945541e-14,6.7026196074948207e-14,5.4491402415557066e-14,4.4374639139015431e-14,3.6197121568188926e-14,2.9576861729875859e-14,2.4208807135453005e-14],[1.3020229971172508e-17,1.1316559022438717e-15,2.5055096059677591e-14,2.2711317990924791e-13,1.1188384756652526e-12,3.5813672306840238e-12,8.3789920610366161e-12,1.5526658203454332e-11,2.4111632676339084e-11,3.2681688681711702e-11,3.9839375482517092e-11,4.4667688249301686e-11,4.6855946478731936e-11,4.6596347829730142e-11,4.4384254364512685e-11,4.0825332206148928e-11,3.6498290624681498e-11,3.1880434385590865e-11,2.7322618953428926e-11,2.3055073110526621e-11,1.9208274502079858e-11,1.583816683841036e-11,1.294971574761335e-11,1.0516178040730508e-11,8.4935033573503084e-12,6.8303286108911838e-12,5.474428441158094e-12,4.3765345305914993e-12,3.4923220631741306e-12,2.7831928623705301e-12,2.2163180958259296e-12,1.764262610315631e-12,1.4044040656467607e-12,1.1182808190681546e-12,8.9094759057166914e-13,7.1038145824849581e-13,5.6695752334084879e-13,4.5299953406596017e-13,3.6240279723342962e-13,2.9032265105674957e-13,2.3292012020266446e-13,1.8715612703790085e-13,1.5062614835574754e-13,1.2142808439091785e-13,9.8057107618817341e-14,7.9322247779208809e-14,6.4280377208788075e-14,5.2184056984349353e-14,4.2440382612931248e-14,3.4578533562681144e-14,2.8224195326861787e-14],[4.6919821505193743e-17,3.417123559483216e-15,6.6170901909225282e-14,5.4002822248528729e-13,2.4447902105167746e-12,7.3004154517881939e-12,1.6115419827895555e-11,2.8424321952235759e-11,4.230676507852624e-11,5.5268245195912192e-11,6.5229252994816297e-11,7.1073881357181931e-11,7.2682241027410823e-11,7.064978926663496e-11,6.5926732363008728e-11,5.952180717906985e-11,5.2319010098896962e-11,4.4997138982505494e-11,3.8019939580538268e-11,3.1664516735870516e-11,2.6064232911058903e-11,2.1251864863255068e-11,1.7196192267354592e-11,1.3829897978303346e-11,1.1069176500450471e-11,8.8265124387231209e-12,7.0183283980202061e-12,5.5690395514536847e-12,4.4127442506918615e-12,3.4934590708765376e-12,2.7645302750847855e-12,2.1876386892247812e-12,1.7316586628433379e-12,1.3715238851687445e-12,1.0871816424214421e-12,8.6267222147948526e-13,6.8534329773852574e-13,5.4519414054872832e-13,4.3433698166084201e-13,3.465599663577068e-13,2.7697580251248528e-13,2.217413063859879e-13,1.7783475986975572e-13,1.4287989937604458e-13,1.1500720814518583e-13,9.2744860740334234e-14,7.4933123290955216e-14,6.0657239223803577e-14,4.9194842911677273e-14,3.9974767710238779e-14,3.2544777972750426e-14],[1.5310808953962111e-16,9.4722974196789346e-15,1.6210246516333014e-13,1.2008028723233663e-12,5.0284925261598534e-12,1.4083290040347158e-11,2.9464817788410434e-11,4.9656256417532801e-11,7.1070816373977712e-11,8.9739698154445476e-11,1.0280090504827948e-10,1.090968294593986e-10,1.0897654398381484e-10,1.0372362454804582e-10,9.4971427552170252e-11,8.4284404402224045e-11,7.293582822180382e-11,6.1838742594941372e-11,5.1569548134544656e-11,4.2433799518271795e-11,3.4541453703510626e-11,2.7874352944658898e-11,2.2339315181310623e-11,1.7806210156172922e-11,1.4133172132703761e-11,1.1181948682445062e-11,8.8262590022554475e-12,6.9555185020494092e-12,5.4756919879195405e-12,4.3085079450821841e-12,3.3898484218683213e-12,2.6678235576773499e-12,2.1008289151504614e-12,1.6557450624023736e-12,1.3063518115379078e-12,1.031977733442081e-12,8.1637685338855144e-13,6.468102168152437e-13,5.1330451447255437e-13,4.0805940396747183e-13,3.2497719182760105e-13,2.5929171310255254e-13,2.0727673685510637e-13,1.6601758937311435e-13,1.3323270800216506e-13,1.0713443797745758e-13,8.6320558156119542e-14,6.9689802607362112e-14,5.6376083159897492e-14,4.5697266587718089e-14,3.7115269861793939e-14],[4.5242231079136903e-16,2.4104510840128283e-14,3.6835262405127023e-13,2.4969400818738439e-12,9.7354498991791626e-12,2.5710972222461469e-11,5.1212760534788965e-11,8.2780791962774109e-11,1.1430653875602931e-10,1.3990436832912934e-10,1.5594667566968945e-10,1.6154732299881128e-10,1.5793517968010479e-10,1.4745256089089683e-10,1.3268541123262416e-10,1.1591591510744354e-10,9.8881882725108282e-11,8.2746851347008739e-11,6.8181733112911358e-11,5.5486032473655352e-11,4.4706981009347356e-11,3.5737828538481981e-11,2.839049243746897e-11,2.2444786850121597e-11,1.7679088536418392e-11,1.3887583079828124e-11,1.088849180828772e-11,8.5266410988982034e-12,6.6727529587466877e-12,5.22103997040868e-12,4.0860989401426752e-12,3.1996888914770236e-12,2.507709743389643e-12,1.9675290617124551e-12,1.5457038251967625e-12,1.2160884298619419e-12,9.5829243748973369e-13,7.5644059968035225e-13,5.9818616701946082e-13,4.7393187107001498e-13,3.7621851263016097e-13,2.9924724104892177e-13,2.3850753355598179e-13,1.9048818647140686e-13,1.5245317086411316e-13,1.2226798052045582e-13,9.826517496203697e-14,7.9140287498601059e-14,6.3871226153613385e-14,5.1655836020086699e-14,4.1863496434583453e-14],[1.2105813521620776e-15,5.6310537490544173e-14,7.7640710303475276e-13,4.8554072845528753e-12,1.7741741588689771e-11,4.442124256053151e-11,8.4618418415022846e-11,1.3169124985450927e-10,1.7601477696946559e-10,2.09418809947494e-10,2.2770887330024399e-10,2.3076659491105361e-10,2.2124112263810725e-10,2.0297136674063239e-10,1.7978447105386797e-10,1.5483304198741086e-10,1.3037278473275938e-10,1.0780958692148537e-10,8.7868973598315322e-11,7.0792641700302559e-11,5.6513101839051941e-11,4.4788564566493298e-11,3.5297301296044105e-11,2.7698161824382755e-11,2.1665862342453533e-11,1.6908950908804289e-11,1.317670640736559e-11,1.0259488786991557e-11,7.9855873612204596e-12,6.2165011612518417e-12,4.8418033700963862e-12,3.7742229099450424e-12,2.945249107495639e-12,2.3013699452632006e-12,1.8009452079799711e-12,1.4116606303871923e-12,1.1084862347041234e-12,8.7205736957116237e-13,6.8740178382267741e-13,5.4294515968391637e-13,4.2973791367942435e-13,3.4085616693307848e-13,2.7093884052297062e-13,2.158305744855601e-13,1.7230658707782502e-13,1.3786079663193586e-13,1.1054268535921504e-13,8.8831666051135758e-14,7.1540280942160148e-14,5.7739559104254556e-14,4.6701404142129933e-14],[2.9332429521043699e-15,1.207617439871164e-13,1.5179826758198171e-12,8.8292609391401542e-12,3.0433960927516855e-11,7.2630784271743694e-11,1.3291191395843693e-10,1.999198892587636e-10,2.5949289430806985e-10,3.0098014110171295e-10,3.2004307723966043e-10,3.1800332272604789e-10,2.9956698945797094e-10,2.705359935107304e-10,2.3625443602262581e-10,2.0086716821937258e-10,1.6716739104762384e-10,1.3676606914269717e-10,1.1038139468870461e-10,8.8130302615750046e-11,6.9768922459784976e-11,5.4868330245962141e-11,4.2931452802942423e-11,3.3464002447260515e-11,2.6012852268752989e-11,2.0183081526884995e-11,1.5642065121496864e-11,1.2116375501103828e-11,9.3852201992496579e-12,7.2726703290172323e-12,5.6399478604863124e-12,4.3784105551872428e-12,3.4034939535558931e-12,2.6496548918307765e-12,2.0662497159539611e-12,1.6142313070905351e-12,1.2635353981603276e-12,9.9103170866869776e-13,7.7892913931801768e-13,6.1354093323199075e-13,4.8433227252665153e-13,3.8318776999830029e-13,3.0384917587112745e-13,2.4148427866157874e-13,1.9235660845713011e-13,1.5357242058675258e-13,1.2288683983832931e-13,9.8555254976081549e-14,7.9219311302452534e-14,6.3819357691596509e-14,5.1527128957175097e-14],[6.4358539780111159e-15,2.3774830711977562e-13,2.7529334556274786e-12,1.5014268584637799e-11,4.9140855637919188e-11,1.1238506281421974e-10,1.9846101629357694e-10,2.8961885095411962e-10,3.6626894332838753e-10,4.1533424165262272e-10,4.3297375354684444e-10,4.2274250219819572e-10,3.9206961212995895e-10,3.491589296173052e-10,3.0109709127483513e-10,2.5309233931632476e-10,2.0845417336029303e-10,1.6893297318192094e-10,1.3516025659266653e-10,1.0705207742301126e-10,8.412284562436952e-11,6.5704022861052778e-11,5.1082856565073275e-11,3.9581868406261104e-11,3.0598198375572119e-11,2.3617781678924201e-11,1.8215008961694265e-11,1.4044911023770572e-11,1.0832229455706389e-11,8.3598919612356473e-12,6.4582179962661035e-12,4.9954493544285462e-12,3.869778597810663e-12,3.0028233301744649e-12,2.3343888609871192e-12,1.8183251499091277e-12,1.4192842636079281e-12,1.1102027818610476e-12,8.7035865821643093e-13,6.8387802000628669e-13,5.385913498391892e-13,4.2515922417951315e-13,3.36405033855343e-13,2.6680608699604623e-13,2.1210560944877976e-13,1.690168785186569e-13,1.3499750077986156e-13,1.0807706913991143e-13,8.6725441044828877e-14,6.975194008529747e-14,5.6228113970082737e-14],[1.2786992720743043e-14,4.2968861185228645e-13,4.6310150835995754e-12,2.3876196850256264e-11,7.4687677646528205e-11,1.6457136804288479e-10,2.8170775381288103e-10,4.0037724820622701e-10,4.9496330859853909e-10,5.5029475709243893e-10,5.6381854141261245e-10,5.4213283202011512e-10,4.9599070508966255e-10,4.3634406602476121e-10,3.7216192682108106e-10,3.0972322683732937e-10,2.5279241067915591e-10,2.0317279930711409e-10,1.613225004074118e-10,1.2688130394260182e-10,9.9061514574801164e-11,7.6909111628778325e-11,5.9462103920824941e-11,4.5835942939582338e-11,3.5261405879324359e-11,2.7093901706808456e-11,2.0807158158562996e-11,1.5979549276687734e-11,1.2277982728554799e-11,9.4420502974971384e-12,7.2697584771861631e-12,5.6053376848688494e-12,4.3291779522337027e-12,3.3497148955678115e-12,2.5969984240651105e-12,2.0176584102254932e-12,1.5710001524428323e-12,1.22599680825948e-12,9.5898444789137885e-13,7.5190206043322263e-13,5.9095113092641695e-13,4.6557650423048642e-13,3.6769230160572346e-13,2.9109421904473634e-13,2.3101331354056805e-13,1.8377707076265675e-13,1.4655176987119337e-13,1.1714644843187769e-13,9.3863556393811576e-14,7.5385019471439813e-14,6.068518130365534e-14],[2.3005662483403909e-14,7.1291640334894703e-13,7.2261714359104288e-12,3.5506450824595312e-11,1.068506585483915e-10,2.2806455490000584e-10,3.8013221953706462e-10,5.2818211958650509e-10,6.4038949882218905e-10,7.0005273170635732e-10,7.0671089524212268e-10,6.7068878582093266e-10,6.0649192002109198e-10,5.2801081302485837e-10,4.4612454317600067e-10,3.6812327998464132e-10,2.9813425321580923e-10,2.3792045460410355e-10,1.8768678216460973e-10,1.4673471146049693e-10,1.1392919830370284e-10,8.7999305730423202e-11,6.771281589633933e-11,5.1964592005726231e-11,3.9810650857793006e-11,3.0470867319445671e-11,2.3315472810078191e-11,1.7844702972054204e-11,1.3666961409260908e-11,1.0478300170383191e-11,8.0444607180107643e-12,6.1858323368059529e-12,4.765219850334904e-12,3.678099736214084e-12,2.8449737162439066e-12,2.205433946576739e-12,1.7135939975029813e-12,1.3345923626210594e-12,1.0419284133597594e-12,8.1543890956296103e-13,6.3976428311249604e-13,5.0318766583350401e-13,3.9675665182307578e-13,3.1361902751086043e-13,2.4852018994612498e-13,1.9742264880360037e-13,1.57217683795133e-13,1.2550657806038526e-13,1.0043440859683714e-13,8.0563570990873757e-14,6.4777376750065996e-14],[3.7480481365797412e-14,1.0858547229174189e-12,1.0459042052516529e-11,4.9377661376857583e-11,1.4388895443947603e-10,2.9910187532719404e-10,4.8762150757959542e-10,6.6492052687241925e-10,7.93256578476501e-10,8.5507434409420688e-10,8.5264621768805455e-10,8.004273508308814e-10,7.1683240142723577e-10,6.1867758284292366e-10,5.1865561522946358e-10,4.2494969604597899e-10,3.4194332273261469e-10,2.7127706346579676e-10,2.1284587557010205e-10,1.6557729644972748e-10,1.2796882668085084e-10,9.8422935455909347e-11,7.5433973421558502e-11,5.7676692256507071e-11,4.4034677330400352e-11,3.3595329062002606e-11,2.5628534023467243e-11,1.9559303542963044e-11,1.4940072361503136e-11,1.1425474425919828e-11,8.7507153853689326e-12,6.713726582698597e-12,5.1608190397807612e-12,3.9753626445095148e-12,3.0689719518400406e-12,2.374711113660643e-12,1.8418934463513002e-12,1.4321225997439325e-12,1.116290440661974e-12,8.7230650718481602e-13,6.8338374015279609e-13,5.367454874791225e-13,4.2265063365233872e-13,3.3365850747905898e-13,2.6407431169115915e-13,2.095303918760907e-13,1.6666972032796183e-13,1.3290632378358505e-13,1.0624367420968518e-13,8.5136788133447953e-14,6.8387326364705216e-14],[5.5294211058306189e-14,1.5182846290506495e-12,1.4041940903611987e-11,6.4214767278080605e-11,1.8238945119464803e-10,3.7122593175984251e-10,5.9462520625418281e-10,7.98780632289272e-10,9.4076564231623379e-10,1.0028009553367424e-09,9.9019471252476798e-10,9.2152757538316782e-10,8.1893863918272571e-10,7.0192993677360902e-10,5.8479122229559945e-10,4.7643811232736149e-10,3.8140886802644209e-10,3.0116843223491245e-10,2.3528248380680768e-10,1.8230618687160698e-10,1.4038231621831005e-10,1.0760414438252789e-10,8.2210748208019793e-11,6.2673600058366949e-11,4.7718440858862252e-11,3.6312303574656214e-11,2.7634485435733046e-11,2.1042469908549826e-11,1.6038701941160427e-11,1.2240989653128129e-11,9.3575003685592675e-12,7.1663546898366793e-12,5.4993644849271887e-12,4.2292912839982242e-12,3.2599855022680391e-12,2.5188240486539904e-12,1.9509490980223236e-12,1.5149002196479345e-12,1.179314224889519e-12,9.2043753402813622e-13,7.202537374392385e-13,5.6507526782203154e-13,4.4448433574522703e-13,3.5053628336134006e-13,2.7715993337376614e-13,2.197057773335104e-13,1.7460513283344676e-13,1.3911264141340567e-13,1.1111141277836881e-13,8.8965313376720932e-14,7.1406781572303139e-14],[7.3868326790917702e-14,1.9488706688300117e-12,1.7486945481035418e-11,7.8094500371337441e-11,2.1761758296314213e-10,4.3602892856694002e-10,6.8931236354378954e-10,9.1570809312557898e-10,1.0681875184131019e-09,1.129180433114083e-09,1.1068709411324373e-09,1.0234821916247572e-09,9.0432851295039846e-10,7.7113598799763677e-10,6.3947180326274229e-10,5.1880027780051146e-10,4.13734610429131e-10,3.2555239801949264e-10,2.5351680920980664e-10,1.9585502709654758e-10,1.5040410457890872e-10,1.1499456119369168e-10,8.7650767599954214e-11,6.6674598670561078e-11,5.0660976705067781e-11,3.8477736807491069e-11,2.9229883145921364e-11,2.2219757149298511e-11,1.6909139815751503e-11,1.2885987340007179e-11,9.8366182625809708e-12,7.5231910449256143e-12,5.765866235518233e-12,4.4289016491198592e-12,3.4099381877129987e-12,2.6318140078352536e-12,2.0363491308987588e-12,1.57964728809388e-12,1.2285557685299235e-12,9.5800340893417373e-13,7.4900139764017755e-13,5.8714271936976539e-13,4.6147589914530495e-13,3.6365932509435519e-13,2.8732575213516361e-13,2.2760423064364438e-13,1.8075998350265307e-13,1.4392271494254425e-13,1.1488128674920081e-13,9.1928264419294998e-14,7.3741990911023897e-14],[8.9359544783251351e-14,2.2964722235387688e-12,2.0200045814830485e-11,8.8815165703859025e-11,2.4440509446746842e-10,4.846744534281052e-10,7.5962825781997986e-10,1.0017476204378297e-09,1.1612128548967817e-09,1.2208145328857242e-09,1.1909623135800304e-09,1.0965735981947796e-09,9.6525533892685843e-10,8.2030621032330541e-10,6.7817339313698016e-10,5.4867937718689278e-10,4.3646289235348654e-10,3.4264738929040415e-10,2.6626662329126603e-10,2.0530557120448672e-10,1.5737873213319055e-10,1.201271625918512e-10,9.1421502250139696e-11,6.9442868298922713e-11,5.269346503141518e-11,3.9971096015228736e-11,3.0328494704772658e-11,2.3029322745387568e-11,1.7506913927573392e-11,1.3328391809172904e-11,1.0164861210132467e-11,7.7673884399911639e-12,5.9480526708110182e-12,4.565223760608206e-12,3.512250095210166e-12,2.7088370060855737e-12,2.0945146682288082e-12,1.6237100966708606e-12,1.2620402933239908e-12,9.8352932847492937e-13,7.6852139787535009e-13,6.0211652035475278e-13,4.7299790496966417e-13,3.7255247681711722e-13,2.9421070343769665e-13,2.3295046662292742e-13,1.849236966485353e-13,1.4717494544433678e-13,1.1742888747437656e-13,9.3929563870173185e-14,7.5318528005953339e-14],[9.7887609681213446e-14,2.4842066945156759e-12,2.1644239763463055e-11,9.4457174841563151e-11,2.5837383547959987e-10,5.098504212698103e-10,7.9578994338577333e-10,1.0457583163235055e-09,1.2085773640983447e-09,1.2672834960961478e-09,1.2334561140650727e-09,1.1333937672891347e-09,9.9586238186684445e-10,8.4494579468349355e-10,6.9752357051379617e-10,5.6358808940281901e-10,4.4778259328700641e-10,3.5114705756001505e-10,2.725960183232388e-10,2.0999040033603304e-10,1.6083163059546031e-10,1.226650259058613e-10,9.3283855953093072e-11,7.0808658019211993e-11,5.3695246926232274e-11,4.070646712694875e-11,3.0869010698991137e-11,2.3427302728116706e-11,1.7800551616781815e-11,1.3545551222898757e-11,1.032587252739907e-11,7.8870955252897257e-12,6.0373066181616102e-12,4.6319695497036963e-12,3.5623160518825369e-12,2.7465080112886576e-12,2.1229483983654752e-12,1.6452394841264223e-12,1.2783935577753267e-12,9.959902835815336e-13,7.7804645508933532e-13,6.0942026149098313e-13,4.7861580712276989e-13,3.7688700000988493e-13,2.9756523923454159e-13,2.3555441048490555e-13,1.8695101471847377e-13,1.4875796160497621e-13,1.1866854974038541e-13,9.4903110722140198e-14,7.6085229406820442e-14],[9.7099856802993984e-14,2.4669628650412607e-12,2.151215414737289e-11,9.3942889769627358e-11,2.5710398985715569e-10,5.0756686591719619e-10,7.9251606037573634e-10,1.0417801424246679e-09,1.2043018735575848e-09,1.2630938173177584e-09,1.2296288241938559e-09,1.1300805353360987e-09,9.9311048980073613e-10,8.4273206671052973e-10,6.9578621731692951e-10,5.622503158586705e-10,4.4676742017326428e-10,3.5038517122901726e-10,2.7202892920524164e-10,2.0957083508639698e-10,1.6052251554685181e-10,1.224379099926181e-10,9.3117248051393997e-11,7.0686511437499974e-11,5.3605680823037327e-11,4.0640737948774282e-11,3.0820710526430601e-11,2.3391748066159967e-11,1.7774324628280597e-11,1.3526159241615302e-11,1.0311497391798418e-11,7.8764100918200836e-12,6.0293409757002157e-12,4.6260137188813148e-12,3.5578493206499123e-12,2.7431476437640254e-12,2.1204124005369343e-12,1.6433195551449805e-12,1.2769354179230034e-12,9.9487934544600694e-13,7.7719736770696085e-13,6.0876926493729799e-13,4.7811512954498144e-13,3.7650074159048223e-13,2.972663408297572e-13,2.3532241523404521e-13,1.867704107244412e-13,1.4861695145782554e-13,1.1855813439202666e-13,9.4816405475437081e-14,7.6016951756296993e-14],[8.721949047481891e-14,2.2489813288452924e-12,1.9832481121247157e-11,8.7372350766806539e-11,2.4081919837489363e-10,4.7819119187257065e-10,7.5029143404506401e-10,9.9035879695490633e-10,1.1489326020796025e-09,1.2087463658948645e-09,1.1799103700073475e-09,1.0869848949885029e-09,9.5727548602025974e-10,8.1387556843166804e-10,6.7311853390324767e-10,5.4478148872395507e-10,4.3350108699184831e-10,3.4042189134530705e-10,2.6460831220999633e-10,2.0407741377420283e-10,1.5647303914009173e-10,1.1946114617601382e-10,9.0932531569764006e-11,6.9084116178928996e-11,5.2430219368905587e-11,3.9777783196674149e-11,3.0186354030429477e-11,2.2924629802576936e-11,1.7429644841033981e-11,1.3271230440847112e-11,1.0122467331081744e-11,7.7358614282837682e-12,5.9245400791903857e-12,4.5476363687005783e-12,3.4990547914440315e-12,2.6989063356983786e-12,2.0870175354200817e-12,1.618032312446615e-12,1.2577267553058098e-12,9.8024188089532142e-13,7.6600806482119954e-13,6.0018899725084385e-13,4.7151505509760681e-13,3.7140820199579037e-13,2.9332500717864011e-13,2.3226285233690942e-13,1.8438827771185383e-13,1.4675681330996547e-13,1.1710140666087827e-13,9.3672351618676906e-14,7.5115941037648536e-14],[7.0943496804849513e-14,1.8821639075425579e-12,1.6959841188001229e-11,7.599154385408207e-11,2.1232219857395691e-10,4.2635141515069517e-10,6.7524938177795457e-10,8.9842285772685381e-10,1.049426506299909e-09,1.1106379146899737e-09,1.0898046360579234e-09,1.0086097529399525e-09,8.9190260574606419e-10,7.6108703741741397e-10,6.3154757088581426e-10,5.1267212963274497e-10,4.0906591470091875e-10,3.2203592354660996e-10,2.5089076748987144e-10,1.9390621781723874e-10,1.4896428204196297e-10,1.1393392629801357e-10,8.6870823446551809e-11,6.6101503124517881e-11,5.023985991879605e-11,3.8168086300995317e-11,2.9001920342085166e-11,2.2051658062121479e-11,1.678493834950676e-11,1.2794012355653225e-11,9.7683385303432123e-12,7.4723668655596234e-12,5.7279289612397496e-12,4.4005011574861687e-12,3.3886133971331406e-12,2.6157531630812485e-12,2.0242154072826126e-12,1.5704518470809464e-12,1.2215652599842337e-12,9.5267247869735379e-13,7.4492335657753196e-13,5.8401341621248141e-13,4.5906720583038172e-13,3.6179963170360459e-13,2.858855830742718e-13,2.2648561027174837e-13,1.7988855307316828e-13,1.4324187324710073e-13,1.1434782298157585e-13,9.1509094183805833e-14,7.3411709889311905e-14],[5.2253541087535185e-14,1.4460302750462244e-12,1.345296759777471e-11,6.18069989431578e-11,1.7620641075921194e-10,3.5974243764450607e-10,5.7771107476421568e-10,7.7775132997586903e-10,9.1771491627732734e-10,9.7982282213130921e-10,9.6888656549851162e-10,9.0283493871982898e-10,8.0322839818539686e-10,6.891574577162727e-10,5.746711335967484e-10,4.6857790606422547e-10,3.7539700516083556e-10,2.9662396697774101e-10,2.3187753990846128e-10,1.7977165825917169e-10,1.3850448818884062e-10,1.0621725351063437e-10,8.1188422103785227e-11,6.1920711356276443e-11,4.7164045662699694e-11,3.5903849325355492e-11,2.7333228309520503e-11,2.0819938053786849e-11,1.5874013525612619e-11,1.2118844765789806e-11,9.2666911998731088e-12,7.0986674761773331e-12,5.4487739267564763e-12,4.1913713655612736e-12,3.2314794051948828e-12,2.4973305051502047e-12,1.9346937096312119e-12,1.502568660435484e-12,1.1699304756546096e-12,9.1327487702800573e-13,7.1476959365019727e-13,5.6086340111624483e-13,4.4123972274882331e-13,3.4802923467712716e-13,2.7521698443388546e-13,2.1819554283991773e-13,1.7342780849297384e-13,1.3819219193786315e-13,1.1038974313037531e-13,8.8397907896196209e-14,7.0959432334438473e-14],[3.4851618588410425e-14,1.0198720355321976e-12,9.8984226673858098e-12,4.7010101373152039e-11,1.3764803414265629e-10,2.8725888155907516e-10,4.698610898622745e-10,6.4249902460037964e-10,7.683548501204823e-10,8.2996608917730378e-10,8.2912854473419393e-10,7.7961303423254155e-10,6.9920061740601484e-10,6.0424131472011438e-10,5.071442306722748e-10,4.1595719262199067e-10,3.350292467633971e-10,2.6602547965693944e-10,2.0889377335809002e-10,1.6262353943374465e-10,1.2577218759961808e-10,9.679494739423476e-11,7.4230052957267239e-11,5.6787403370911146e-11,4.3378004440612831e-11,3.3110249840213661e-11,2.5269880141377693e-11,1.9293760423369479e-11,1.4743124209115811e-11,1.1279102941918876e-11,8.6416833860218831e-12,6.6323070246018962e-12,5.0998586565734142e-12,3.9295945113484258e-12,3.0345119342555538e-12,2.3486894760295816e-12,1.8221854665349799e-12,1.4171515476735563e-12,1.1048833827783418e-12,8.6358865602320013e-13,6.7670093334488101e-13,5.3160720849637566e-13,4.1868804930097674e-13,3.3059349851242786e-13,2.6169656442707372e-13,2.0768041192500458e-13,1.6522620606094957e-13,1.3177675645292922e-13,1.0535728686884635e-13,8.4439298001321971e-14,6.783697772147113e-14],[2.1049135713802517e-14,6.6033198683525184e-13,6.7556240955951196e-12,3.3436888769340212e-11,1.012139392009041e-10,2.170766371406934e-10,3.6327922396447991e-10,5.0649588754472668e-10,6.1590562217529479e-10,6.7501105806125211e-10,6.8296028554426387e-10,6.4943451379569932e-10,5.8830925202221907e-10,5.129915299105645e-10,4.3405262714746176e-10,3.5862470321340089e-10,2.907830219097074e-10,2.3230326244405588e-10,1.8343622837604598e-10,1.4354176736276026e-10,1.1154354732885963e-10,8.6223555162318625e-11,6.6394322926182076e-11,5.0987011440725963e-11,3.9086247070889142e-11,2.9933997700672328e-11,2.291730340718137e-11,1.7549049336587572e-11,1.3447083005992787e-11,1.0314466732979573e-11,7.922124821248356e-12,6.094268083093914e-12,4.6965145805970659e-12,3.6264102111231044e-12,2.8059788663953129e-12,2.1759328969175725e-12,1.6912110309590736e-12,1.3175603951052007e-12,1.0289300163020005e-12,8.054894805316789e-13,6.3212608203785835e-13,4.9730646382146476e-13,3.9221496033304402e-13,3.1010149949139724e-13,2.4578796999477494e-13,1.9529431419831866e-13,1.5555504899377509e-13,1.2420409548224233e-13,9.9411234551548568e-14,7.9757611278047872e-14,6.4140806281713386e-14],[1.1511970655646292e-14,3.9248886491843284e-13,4.2767763610354567e-12,2.2240352949508445e-11,7.0053953259780757e-11,1.5524246594045415e-10,2.6700778952587912e-10,3.8102293218885919e-10,4.7267734233025237e-10,5.2710746707763671e-10,5.4149404256085839e-10,5.2188784115837022e-10,4.7846555738067611e-10,4.2171378133052603e-10,3.602898954880149e-10,3.0030080585869522e-10,2.4544250656466618e-10,1.9751608150276703e-10,1.5701369589905209e-10,1.2362487482236016e-10,9.6614732996767147e-11,7.5078360484157185e-11,5.8096186949259282e-11,4.4818629812671597e-11,3.4504382803463147e-11,2.6530644611062983e-11,2.0387873320922481e-11,1.5667134559336091e-11,1.2044878674291467e-11,9.2678261771716548e-12,7.1392843840897718e-12,5.5074127978097767e-12,4.2555078388924054e-12,3.2941525961224822e-12,2.5549830902965747e-12,1.9858009362073453e-12,1.5467776646374638e-12,1.2075275150705768e-12,9.448616859064683e-13,7.4107189563892365e-13,5.8262199096600888e-13,4.591523693126598e-13,3.6272323271275723e-13,2.8723965734952422e-13,2.2801479957524785e-13,1.8143792209824657e-13,1.44721908175275e-13,1.157110444756924e-13,9.27345116970093e-14,7.4494560100620855e-14,5.9981027957161185e-14],[5.7012379790123397e-15,2.1416115403918374e-13,2.5114190786806376e-12,1.3833708867306188e-11,4.5640140729555419e-11,1.0506687324905138e-10,1.8656045507092863e-10,2.7352564244132907e-10,3.4730711992767144e-10,3.95207512355852e-10,4.1325352418832306e-10,4.045801139313904e-10,3.7612899099502489e-10,3.3568598861811205e-10,2.9004178457245004e-10,2.4422916562763047e-10,2.0147674073834831e-10,1.6351767036430526e-10,1.3100346033198792e-10,1.0388817953437009e-10,8.172996880509668e-11,6.3902706390202361e-11,4.9731300727649743e-11,3.8569949101134428e-11,2.9841485622163738e-11,2.3052164032144606e-11,1.7792149448736988e-11,1.3728554653391453e-11,1.059528289091144e-11,8.1821579938233014e-12,6.3246624724393813e-12,4.894888988074055e-12,3.7938949318500112e-12,2.9454258333618843e-12,2.2908663504190759e-12,1.7852384860130232e-12,1.3940644334149713e-12,1.0909272914972836e-12,8.5558595694069751e-13,6.7252485584518195e-13,5.2984185713310866e-13,4.1839745880431314e-13,3.3116483904750088e-13,2.6273377724059549e-13,2.089321446056512e-13,1.665370735637738e-13,1.330544594990006e-13,1.0655050337274438e-13,8.5522885475732946e-14,6.8802129202500692e-14,5.5475977010802023e-14],[2.5567764365603092e-15,1.0727596012638016e-13,1.3679600698131032e-12,8.0466799881779947e-12,2.7988737407898712e-11,6.7294397805746211e-11,1.2391604516868899e-10,1.8737718889688013e-10,2.4432104275800439e-10,2.8450437941487122e-10,3.0357366848051712e-10,3.0256412027314092e-10,2.8580121076096103e-10,2.5873575971956014e-10,2.2644766565882045e-10,1.9291379574773895e-10,1.6084014769878085e-10,1.3180806943815863e-10,1.0654199012297186e-10,8.5184210527586287e-11,6.7524033606814849e-11,5.3166655335582015e-11,4.1646404628992227e-11,3.2496083985509811e-11,2.5284973529212821e-11,1.9636153497134325e-11,1.5231160294612553e-11,1.1807537282866189e-11,9.1528947104211938e-12,7.0976850459900043e-12,5.5079462802023304e-12,4.2786543824278168e-12,3.3279545655939572e-12,2.5923286747836941e-12,2.0226445310046318e-12,1.5809825885787716e-12,1.2381197963303785e-12,9.7155377802045283e-13,7.6396253961827178e-13,6.0201021838357404e-13,4.7542485636204115e-13,3.7628831248082736e-13,2.9849062461347904e-13,2.3731128724170787e-13,1.8909815875998843e-13,1.5102129687156267e-13,1.2088421007513475e-13,9.6979064932200729e-14,7.7975529819053202e-14,6.2835358033145149e-14,5.074667362841697e-14],[1.0382942065424952e-15,4.9330154464812667e-14,6.9116101785091378e-13,4.37699419159986e-12,1.6156290235714431e-11,4.0789637150470757e-11,7.824341312457674e-11,1.2249183261608175e-10,1.6455320483631967e-10,1.966484204380518e-10,2.1465266348756183e-10,2.1828096187976655e-10,2.0990967022616377e-10,1.9310233261754935e-10,1.7146438291388372e-10,1.4799729545941777e-10,1.2487008779292208e-10,1.0345092660620719e-10,8.4460111230554796e-11,6.8152966643040035e-11,5.4484690795261524e-11,4.3238940678655092e-11,3.4118561865593688e-11,2.6804299594273772e-11,2.0989420720429683e-11,1.6397662878946626e-11,1.2790444543070574e-11,9.9676573265390693e-12,7.7649767401528054e-12,6.0495694641056926e-12,4.7153258403300259e-12,3.6782454755684627e-12,2.872285873692028e-12,2.2457925145973638e-12,1.7585206173870071e-12,1.3792031806332367e-12,1.0835959005281039e-12,8.529236379913113e-13,6.7265672249834119e-13,5.3155341426689822e-13,4.2091434984777934e-13,3.3400418107483893e-13,2.656041141298507e-13,2.1166636734842671e-13,1.6904765487262504e-13,1.3530375925938067e-13,1.0853122515539177e-13,8.7245346844046281e-14,7.0286085563268725e-14,5.6745471200470709e-14,4.5911530048706808e-14],[3.818143056455551e-16,2.0824323122987919e-14,3.2391915713065873e-13,2.2264674608321689e-12,8.7785339123740771e-12,2.3397992673880812e-11,4.6965648169721534e-11,7.6413358094022089e-11,1.0610848208286956e-10,1.305057691337473e-10,1.4609424710619038e-10,1.5191471104822895e-10,1.4901910650124775e-10,1.3954889594648494e-10,1.2591538181455249e-10,1.102729528778964e-10,9.427939309392057e-11,7.9057276480413899e-11,6.5264242242543077e-11,5.3203857658470184e-11,4.2936799873218018e-11,3.4373706775214632e-11,2.7344464707736383e-11,2.1645587139895182e-11,1.7070030168812548e-11,1.3424196684101188e-11,1.0536257325250468e-11,8.2589747394942377e-12,6.4693051171748278e-12,5.0663022175161436e-12,3.9682899088456992e-12,3.1098780186690639e-12,2.4391365874164124e-12,1.9150794236955713e-12,1.5055093356512492e-12,1.1852220694045685e-12,9.3453786913390122e-13,7.3811787660056003e-13,5.8402026502113031e-13,4.6295362325448405e-13,3.676899913920095e-13,2.926055505547999e-13,2.3332245056184649e-13,1.8643021210921145e-13,1.492694087989261e-13,1.1976390059228446e-13,9.6290805800053402e-14,7.7579745272924338e-14,6.2634759300003135e-14,5.0673770048551975e-14,4.1081615927329376e-14],[1.2714171106577859e-16,8.0700767661579296e-15,1.4081392860305708e-13,1.0591022152837274e-12,4.4897725680835132e-12,1.2701797570152633e-11,2.6799404549389306e-11,4.5488663801423391e-11,6.550766867039751e-11,8.3158510241139698e-11,9.5709400855058733e-11,1.0199276012001923e-10,1.0225689245350807e-10,9.7650194177657692e-11,8.9677283848909571e-11,7.9801115417998651e-11,6.9226049181154199e-11,5.8825332502694007e-11,4.9157722947112707e-11,4.0526040697728271e-11,3.304638241044893e-11,2.6711194348645612e-11,2.143945009824474e-11,1.7112984224608853e-11,1.3600786111934719e-11,1.0773962948658729e-11,8.5140300367464129e-12,6.7167385162950443e-12,5.2931096763420227e-12,4.1688531703830661e-12,3.2829536181309701e-12,2.5859203419114989e-12,2.0379933557671059e-12,1.6074650685623039e-12,1.269192595816629e-12,1.0033247509233835e-12,7.9423920533192353e-13,6.2967081458512658e-13,5.0000615936089614e-13,3.9771831336154176e-13,3.1691742111071475e-13,2.5299544366610067e-13,2.0234658940238522e-13,1.6214804127568623e-13,1.3018839931188247e-13,1.0473368935738255e-13,8.4422833312294075e-14,6.8186157870424631e-14,5.5181881234037392e-14,4.474660837953675e-14,3.6356731705175212e-14],[3.8337871496027578e-17,2.8709973483208417e-15,5.6781410937370563e-14,4.7112976433646839e-13,2.1614674468247935e-12,6.5254370016916441e-12,1.4537250017916811e-11,2.5840970161642536e-11,3.8719743417721993e-11,5.08769926598152e-11,6.0353259555936862e-11,6.6057844372433404e-11,6.7824148906950649e-11,6.6164896728861385e-11,6.1941953546445572e-11,5.6088477522343364e-11,4.9432972052846702e-11,4.2618877830552261e-11,3.6091175041709866e-11,3.0120205120758654e-11,2.4840323334194972e-11,2.0289711113199612e-11,1.6444601902625401e-11,1.3245659956150753e-11,1.0616701807752959e-11,8.4770250552298844e-12,6.7488856024678003e-12,5.3615456760301454e-12,4.2530445711982678e-12,3.3705516512535589e-12,2.6699047752599311e-12,2.1147355833886141e-12,1.6754350302243071e-12,1.3281095273119185e-12,1.0536095423814312e-12,8.3666892479646116e-13,6.6516685877985333e-13,5.295093970764528e-13,4.2211987273905195e-13,3.3702430115621898e-13,2.6951729946494703e-13,2.1589486964173209e-13,1.7324187538157204e-13,1.3926375335614841e-13,1.121536918246048e-13,9.0488059239948242e-14,7.3144219927400931e-14,5.9236021847341738e-14,4.8063193645624646e-14,3.9071665737407914e-14,3.1822457720983807e-14],[1.0468200515130594e-17,9.3764031097403489e-16,2.1238230406762181e-14,1.9598568449464045e-13,9.7947884905609435e-13,3.1725746019296439e-12,7.4963812466701052e-12,1.4008324379771666e-11,2.1911448215727399e-11,2.9886420716344583e-11,3.6632917955285199e-11,4.1272900460128919e-11,4.348277392945723e-11,4.3410020223262303e-11,4.149408035904802e-11,3.8288034604801467e-11,3.4328774928471479e-11,3.0064550021956747e-11,2.5828732405953395e-11,2.184310480416418e-11,1.8236002116575807e-11,1.506517000267327e-11,1.2339529297633751e-11,1.0037208031025718e-11,8.1191602709278069e-12,6.5387129750281082e-12,5.2477970948842048e-12,4.2006920408573725e-12,3.3560216826472482e-12,2.6775910979430368e-12,2.1345015174125504e-12,1.7008505156972836e-12,1.3552225013348583e-12,1.0800996718055038e-12,8.6127124790631332e-13,6.8728373870461964e-13,5.4895247830747331e-13,4.389408970873496e-13,3.5140606262104929e-13,2.8170488034041055e-13,2.2615354925770517e-13,1.8183246549685464e-13,1.4642913349381371e-13,1.1811239087761702e-13,9.5432142266180169e-14,7.7239694310979267e-14,6.2624617832593685e-14,5.0864800350813605e-14,4.138698418317238e-14,3.3735614684515254e-14,2.7548259578108843e-14],[2.588333052779589e-18,2.8111764277153194e-16,7.3685504173748288e-15,7.6241125640821821e-14,4.1779518586157967e-13,1.4597279135033554e-12,3.6747970765007968e-12,7.2466169516155115e-12,1.1871565141419798e-11,1.685637254645224e-11,2.1402620267821038e-11,2.4876605695883294e-11,2.6945810866995164e-11,2.7577834358930903e-11,2.6957907723737147e-11,2.5385003541467433e-11,2.3184316427928837e-11,2.0650115437447694e-11,1.8017642708272678e-11,1.5456227785045584e-11,1.3074981780800873e-11,1.0934220485395273e-11,9.0581462665640252e-12,7.4463547322619712e-12,6.0831495816936333e-12,4.9444945094611435e-12,4.002857063658822e-12,3.2303601391673813e-12,2.6006707006045701e-12,2.0900005739530387e-12,1.6775166304274624e-12,1.3453812217911697e-12,1.0785786038707891e-12,8.646321299955243e-13,6.9327939345156309e-13,5.5614599594350185e-13,4.4644068182037042e-13,3.5868291393743983e-13,2.8846671457551066e-13,2.3226033665986981e-13,1.8723903659902991e-13,1.5114716839020761e-13,1.2218551864706849e-13,9.8919930270605351e-14,8.0207611580985316e-14,6.5137970050230889e-14,5.2985269965039391e-14,4.3170849870179608e-14,3.5233028135949912e-14,2.8803165881914943e-14,2.3586645538117341e-14],[5.7952526428389062e-19,7.7372795483510021e-17,2.3713593676588553e-15,2.7735461151610073e-14,1.6774663102120029e-13,6.3560866671406213e-13,1.7124872615867382e-12,3.5773065845163748e-12,6.1580493093252639e-12,9.128345686895879e-12,1.2036134411779788e-11,1.4464478981212652e-11,1.6140106623786262e-11,1.6964386200770985e-11,1.698576120789012e-11,1.6346173912621046e-11,1.5227362730196e-11,1.3810370739773478e-11,1.2251398178490049e-11,1.06714969601066e-11,9.155701389716425e-12,7.7574187272393293e-12,6.5049740970395527e-12,5.4083649514591169e-12,4.4652087111563725e-12,3.6654925576210818e-12,2.9950991877907879e-12,2.4382616417671145e-12,1.9791638715506747e-12,1.6029037187816375e-12,1.2960055802006985e-12,1.0466313039073739e-12,8.446002047960178e-13,6.8129703650718469e-13,5.4952154283383229e-13,4.433144400190802e-13,3.5778130248002163e-13,2.8892664795597905e-13,2.3350445655858443e-13,1.8888751703807045e-13,1.5295568248862895e-13,1.240018276658669e-13,1.0065366872350541e-13,8.1809383182924611e-14,6.6584985183219291e-14,5.4271558742613817e-14,4.4300660475766359e-14,3.6216430765904846e-14,2.965317452232627e-14,2.4317376591372051e-14,1.9973297001179504e-14],[1.1749751430660014e-19,1.9549552803820116e-17,7.0788754661341648e-16,9.4354501519482962e-15,6.3396632259656685e-14,2.6191811441220159e-13,7.5863631483221986e-13,1.6851895555516654e-12,3.0582756675968895e-12,4.7463283269777814e-12,6.5152601556099764e-12,8.1133461798575537e-12,9.344642010267904e-12,1.0104712564451491e-11,1.037964832736553e-11,1.0223032334973239e-11,9.726341144073407e-12,8.9929725739513649e-12,8.1201891557104667e-12,7.1891885845717883e-12,6.2615408231141086e-12,5.3797520342222099e-12,4.5700117902035777e-12,3.8457383241769064e-12,3.211078460172197e-12,2.6639348729639558e-12,2.1983681119086618e-12,1.8063792478212828e-12,1.479155821430575e-12,1.2078898970402385e-12,9.8427528302246168e-13,8.007763179661516e-13,6.5074186647806967e-13,5.2841997191686205e-13,4.289130322126773e-13,3.4810098914008475e-13,2.8255069777795785e-13,2.2942290581418493e-13,1.8638357869649447e-13,1.515231501011327e-13,1.2328523373005713e-13,1.0040506922497877e-13,8.1857242347789256e-14,6.6811836675657704e-14,5.4598013671144412e-14,4.4673992963915774e-14,3.6602456879288658e-14,3.0030494974005738e-14,2.4673311969147812e-14,2.0301031849805702e-14,1.6728034096193354e-14],[2.1571933580950238e-20,4.5345450396298716e-18,1.960120421916381e-16,3.0017256741311399e-15,2.2552805549161072e-14,1.0214076082681757e-13,3.194862685259685e-13,7.5755312880343272e-13,1.4541472346474576e-12,2.3695245787634933e-12,3.3946980013523362e-12,4.3901843652879378e-12,5.2294987562885388e-12,5.8279739123451368e-12,6.1514720880558927e-12,6.2096637790233388e-12,6.0418329067329925e-12,5.7018564386640011e-12,5.2461347778040279e-12,4.725710387449573e-12,4.1822489609982658e-12,3.6468919780652179e-12,3.1409033743564301e-12,2.6772254380542697e-12,2.2623300162746632e-12,1.897997701724523e-12,1.5828424964011455e-12,1.3135204213930538e-12,1.0856301161274137e-12,8.9434718071825081e-13,7.3484536260331255e-13,6.0255662308412669e-13,4.9331520271099855e-13,4.0342196588381048e-13,3.2965665695616124e-13,2.6925820956138613e-13,2.1988722219883018e-13,1.7958010474805974e-13,1.4670101741335871e-13,1.1989532508511837e-13,9.8046645116614784e-14,8.023847691694631e-14,6.5720708810086144e-14,5.3880879887320654e-14,4.4219842420681992e-14,3.633135947664357e-14,2.9885137685668007e-14,2.4612805991445742e-14,2.0296387215277983e-14,1.6758857246826395e-14,1.3856438406425414e-14],[3.586357338820352e-21,9.6555933263545622e-19,5.03445911316874e-17,8.9301862542077596e-16,7.5519128398329535e-15,3.7695583412188683e-14,1.279036849530623e-13,3.249744176833505e-13,6.6197016947618839e-13,1.1358014020621088e-12,1.7025315846618302e-12,2.2916645706193462e-12,2.8287761806168118e-12,3.2547606396028079e-12,3.5356907251605896e-12,3.663373250686819e-12,3.6499114624505366e-12,3.520013798330528e-12,3.3037376165600788e-12,3.0310075958170452e-12,2.7282088698008224e-12,2.4165687645068672e-12,2.1118221386594865e-12,1.8246586394378633e-12,1.5615535587827083e-12,1.3257101435939618e-12,1.1179517680611644e-12,9.3748426702584198e-13,7.8250229623349686e-13,6.5064458092030386e-13,5.3931811386321393e-13,4.4591661083607848e-13,3.6795815707881077e-13,3.0316387746650881e-13,2.4949540216394423e-13,2.0516485449408295e-13,1.6862752551153224e-13,1.3856448510451992e-13,1.1386011351107587e-13,9.3577843970190499e-14,7.6936183935899805e-14,6.3286225672605318e-14,5.2091276011373537e-14,4.2908854782732297e-14,3.5375073467745929e-14,2.9191265817210975e-14,2.4112668262495855e-14,1.9938916790796316e-14,1.6506122464973441e-14,1.3680298943756022e-14,1.1351934896259192e-14],[5.3991094943468244e-22,1.8874374384563217e-19,1.199428781858409e-17,2.4844552344511112e-16,2.3803201251455606e-15,1.316557034056549e-14,4.8677269338703065e-14,1.3303226724938472e-13,2.8851390017517703e-13,5.22734693394586e-13,8.2189031024559459e-13,1.1539975377846843e-12,1.479034265078593e-12,1.7600634853012819e-12,1.9709167209802936e-12,2.0990316457760607e-12,2.1443237535868919e-12,2.1158629374573529e-12,2.0279836972771223e-12,1.8968790603282661e-12,1.7381386634235998e-12,1.565276383474232e-12,1.3890747188757817e-12,1.2175022847572425e-12,1.055975148374522e-12,9.0778352017849175e-13,7.7456258011043941e-13,6.5673537780064488e-13,5.5389206264596199e-13,4.6509361020318738e-13,3.8910223633939336e-13,3.2454773255812209e-13,2.7004152703087012e-13,2.2425026177257874e-13,1.8593935992025679e-13,1.5399523970029705e-13,1.2743297046586099e-13,1.0539449114942336e-13,8.7141113705080535e-14,7.2042926516804405e-14,5.9566869021382341e-14,4.9264626845880311e-14,4.0761051731680071e-14,3.374350128790167e-14,2.7952285439862848e-14,2.3172271460620955e-14,1.9225616201288981e-14,1.5965546467105347e-14,1.3271084657187388e-14,1.104260839280583e-14,9.1981340275850123e-15],[7.36028786825893e-23,3.3869947082583e-20,2.6506213841515882e-18,6.4637265737735459e-17,7.0621310788399049e-16,4.3515774144835549e-15,1.7610903971973932e-14,5.1968065649558873e-14,1.2039081355053485e-13,2.3099255939099151e-13,3.8190662579213515e-13,5.6058858950346045e-13,7.4747902645333584e-13,9.2160629424803021e-13,1.0655186899148118e-12,1.1681040637865071e-12,1.2251599474489685e-12,1.2383567469431134e-12,1.2134340495350067e-12,1.158310399598034e-12,1.0815093860252258e-12,9.9105675223344133e-13,8.9383917053408912e-13,7.9533375380523312e-13,6.9959451677719972e-13,6.0939211059061764e-13,5.2642685509953365e-13,4.5156066191167524e-13,3.8503520971102224e-13,3.2665988888535267e-13,2.7596380059609055e-13,2.3231253862624265e-13,1.9499382566005163e-13,1.6327739327384966e-13,1.3645460766914898e-13,1.1386282177353724e-13,9.4898645025855808e-14,7.9023481235125293e-14,6.5763907054633098e-14,5.4708799390982464e-14,4.5504582415189956e-14,3.7849546683352315e-14,3.1487878062699091e-14,2.6203803853106373e-14,2.1816099554578516e-14,1.8173086289095525e-14,1.5148172854634573e-14,1.2635947413853181e-14,1.0548793956449871e-14,8.8139919832940843e-15,7.3712499988222244e-15],[9.0859753784990045e-24,5.5796225957903186e-21,5.4334104281406886e-19,1.5725914840234488e-17,1.9722328393406622e-16,1.36116752180562e-15,6.056885743486021e-15,1.9372597329520093e-14,4.8097028056916684e-14,9.8005940064657503e-14,1.7081467378974341e-13,2.6270549983427845e-13,3.6514126328578894e-13,4.6727263997892731e-13,5.586665425137808e-13,6.3134800980668528e-13,6.8075310659853322e-13,7.0569834017952433e-13,7.0771875010738628e-13,6.9014916089194601e-13,6.5722675471707243e-13,6.1336873317143769e-13,5.6267635425711854e-13,5.0865171808595384e-13,4.540827278282864e-13,4.0104414329421373e-13,3.5096809625305815e-13,3.0474813392278411e-13,2.6285214916069467e-13,2.2542917845418137e-13,1.9240226427651167e-13,1.6354447033723813e-13,1.3853813898972953e-13,1.1701909950158695e-13,9.8608230846377548e-14,8.2932910166233881e-14,6.9640692631390204e-14,5.8407238277061284e-14,4.8940129553609709e-14,4.0979867331601466e-14,3.4299020821301254e-14,2.8700248034770666e-14,2.4013697570752812e-14,2.0094144077256949e-14,1.6818091199561738e-14,1.4080989383475366e-14,1.1794654479685313e-14,9.8849306372484423e-15,8.2896125607211756e-15,6.956623963717839e-15,5.842438015738466e-15],[1.0156694761768721e-24,8.4380769982090531e-22,1.0331155772044871e-19,3.5779148784723642e-18,5.1844489651617744e-17,4.0293432905956078e-16,1.9802927811603761e-15,6.8914544774646574e-15,1.839676325932201e-14,3.9924965398702056e-14,7.3539015027774936e-14,1.1876257795284477e-13,1.7241059194872358e-13,2.2940511373687406e-13,2.8408156210121345e-13,3.3142161485239144e-13,3.6785857195825024e-13,3.9156827261318496e-13,4.0234446676761141e-13,4.0123025014275933e-13,3.9006703160160116e-13,3.7107385817524728e-13,3.4651612858278213e-13,3.1848067829411508e-13,2.8874831255580303e-13,2.5874284403036146e-13,2.2953310052080764e-13,2.0186697447632957e-13,1.7622130045225396e-13,1.5285629467140329e-13,1.3186754187525188e-13,1.1323175046877441e-13,9.6844736854407673e-14,8.2551513344556178e-14,7.0169150306010032e-14,5.9503455221072578e-14,5.0360614131558601e-14,4.2554888083025297e-14,3.5913326142883614e-14,3.0278296556761261e-14,2.5508477541541326e-14,2.1478804271602302e-14,1.8079745254196172e-14,1.521618079285665e-14,1.2806077088527174e-14,1.0779088921109761e-14,9.07517859442455e-15,7.6433058279229599e-15,6.440219800870439e-15,5.4293682984541068e-15,4.5799280133574092e-15]],"type":"surface","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-normal-posterior-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;17.1: Joint posterior of <span class="math inline">\((\mu, \sigma^2)\)</span> from a normal model.
</figcaption></figure>
</div>
</div>
<p>The HMC algorithm improves from the Metropolis algorithm by simulating smart proposal values. It does so by using the <em>gradient</em> of the logarithm of the posterior density. Let’s first take the log of the joint density:</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">grid_logdensity</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/outer.html">outer</a></span><span class="op">(</span><span class="va">mu_grid</span>,</span>
<span>    Y <span class="op">=</span> <span class="va">sigma2_grid</span>,</span>
<span>    FUN <span class="op">=</span> <span class="va">lp_mu_sigma</span></span>
<span><span class="op">)</span></span>
<span><span class="fu">plot_ly</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="op">~</span><span class="va">sigma2_grid</span>, y <span class="op">=</span> <span class="op">~</span><span class="va">mu_grid</span>, z <span class="op">=</span> <span class="op">~</span><span class="va">grid_logdensity</span>,</span>
<span>    type <span class="op">=</span> <span class="st">"surface"</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-normal-gradient" class="cell-output-display quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-normal-gradient-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="plotly html-widget html-fill-item" id="htmlwidget-c17b08c87d594a3c5d17" style="width:100%;height:650px;"></div>
<script type="application/json" data-for="htmlwidget-c17b08c87d594a3c5d17">{"x":{"visdat":{"122bcc3a5aca1b":["function () ","plotlyVisDat"]},"cur_data":"122bcc3a5aca1b","attrs":{"122bcc3a5aca1b":{"x":{},"y":{},"z":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"surface"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"sigma2_grid"},"yaxis":{"title":"mu_grid"},"zaxis":{"title":"grid_logdensity"}},"hovermode":"closest","showlegend":false,"legend":{"yanchor":"top","y":0.5}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"colorbar":{"title":"grid_logdensity","ticklen":2,"len":0.5,"lenmode":"fraction","y":1,"yanchor":"top"},"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666667","rgba(70,19,97,1)"],["0.0833333333333334","rgba(72,32,111,1)"],["0.125","rgba(71,45,122,1)"],["0.166666666666667","rgba(68,58,128,1)"],["0.208333333333333","rgba(64,70,135,1)"],["0.25","rgba(60,82,138,1)"],["0.291666666666667","rgba(56,93,140,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.375","rgba(46,114,142,1)"],["0.416666666666667","rgba(42,123,142,1)"],["0.458333333333333","rgba(38,133,141,1)"],["0.5","rgba(37,144,140,1)"],["0.541666666666667","rgba(33,154,138,1)"],["0.583333333333333","rgba(39,164,133,1)"],["0.625","rgba(47,174,127,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.708333333333333","rgba(79,191,110,1)"],["0.75","rgba(98,199,98,1)"],["0.791666666666667","rgba(119,207,85,1)"],["0.833333333333333","rgba(147,214,70,1)"],["0.875","rgba(172,220,52,1)"],["0.916666666666667","rgba(199,225,42,1)"],["0.958333333333333","rgba(226,228,40,1)"],["1","rgba(253,231,37,1)"]],"showscale":true,"x":[0.5,0.57999999999999996,0.66000000000000003,0.73999999999999999,0.82000000000000006,0.90000000000000002,0.97999999999999998,1.0600000000000001,1.1400000000000001,1.22,1.3,1.3799999999999999,1.46,1.54,1.6200000000000001,1.7,1.78,1.8600000000000001,1.9399999999999999,2.02,2.1000000000000001,2.1799999999999997,2.2599999999999998,2.3399999999999999,2.4199999999999999,2.5,2.5800000000000001,2.6600000000000001,2.7400000000000002,2.8199999999999998,2.8999999999999999,2.98,3.0600000000000001,3.1400000000000001,3.2200000000000002,3.3000000000000003,3.3799999999999999,3.46,3.54,3.6200000000000001,3.7000000000000002,3.7800000000000002,3.8599999999999999,3.9399999999999999,4.0199999999999996,4.0999999999999996,4.1799999999999997,4.2599999999999998,4.3399999999999999,4.4199999999999999,4.5],"y":[2,2.04,2.0800000000000001,2.1200000000000001,2.1600000000000001,2.2000000000000002,2.2400000000000002,2.2800000000000002,2.3199999999999998,2.3599999999999999,2.3999999999999999,2.4399999999999999,2.48,2.52,2.5600000000000001,2.6000000000000001,2.6400000000000001,2.6800000000000002,2.7199999999999998,2.7599999999999998,2.7999999999999998,2.8399999999999999,2.8799999999999999,2.9199999999999999,2.96,3,3.04,3.0800000000000001,3.1200000000000001,3.1600000000000001,3.2000000000000002,3.2400000000000002,3.2800000000000002,3.3200000000000003,3.3600000000000003,3.4000000000000004,3.4399999999999999,3.48,3.52,3.5600000000000001,3.6000000000000001,3.6400000000000001,3.6799999999999997,3.7199999999999998,3.7599999999999998,3.7999999999999998,3.8399999999999999,3.8799999999999999,3.9199999999999999,3.96,4],"z":[[-67.246490254351897,-58.868941744966541,-52.807443758614525,-48.279856884748312,-44.815353751372157,-42.11442252485638,-39.977978630638376,-38.268869704084466,-36.88975779594,-35.769805715008367,-34.85634338974387,-34.109474675683245,-33.498485271583533,-32.999389496075366,-32.593217476619323,-32.26479565743071,-32.001863239199061,-31.794421883765303,-31.63425026492618,-31.514536982109799,-31.429599699416308,-31.37466793402773,-31.345713401908956,-31.339316295836998,-31.352558993583258,-31.382940906634829,-31.428309767116254,-31.486805802504673,-31.556816092761494,-31.636937030652327,-31.725943274366276,-31.822761934947167,-31.926451009933928,-32.036181280787808,-32.151221050946667,-32.270923225223953,-32.39471432825858,-32.522085136130428,-32.652582655808665,-32.785803235355331,-32.921386626468035,-33.05901085207816,-33.198387756911693,-33.339259139398159,-33.48139338003314,-33.624582495009939,-33.768639555222705,-33.913396420071763,-34.058701743240093,-34.204419214051704,-34.35042600340455],[-64.575306334351893,-56.566196986345858,-50.783819576796347,-46.475002884748307,-43.186583068445337,-40.630431458189712,-38.615129691862862,-37.008877288990121,-35.71818590120315,-34.675058206811649,-33.828964958974638,-33.141654414813679,-32.58369625788491,-32.132121989581854,-31.768777995137842,-31.479153328018946,-31.251530677401313,-31.076361690216913,-30.945800801008655,-30.853352843495941,-30.793603527987738,-30.762011071642412,-30.754743508103644,-30.768550500965201,-30.800661489451024,-30.848704122634832,-30.910638464790672,-30.984703561903167,-31.069373771593611,-31.16332286043956,-31.265394322642138,-31.374576713470656,-31.489983049149615,-31.610833522826027,-31.736440939145425,-31.866198388860319,-31.999568777962722,-32.136075899136209,-32.275296791401885,-32.416855180106708,-32.560415826468038,-32.705679645728956,-32.852379477118944,-33.000276408433692,-33.149156574062985,-33.298828358424572,-33.449119947567198,-33.599877180635147,-33.750961660290777,-33.902249087354868,-34.053627790071218],[-62.00335441435189,-54.348997055311372,-48.835371152553918,-44.737197533396952,-41.618319702591677,-39.201569280411931,-37.302909324515923,-35.795692421065588,-34.590136813483852,-33.620979551073944,-32.839752682051568,-32.209787777132519,-31.702890805830108,-31.29707266490653,-30.974965674150187,-30.722696880960122,-30.52907227290693,-30.384976765485732,-30.282926594823088,-30.216731081119701,-30.181234023225834,-30.172113842284613,-30.185727596599218,-30.218988124896825,-30.269266464657633,-30.33431373863483,-30.412198170217028,-30.50125395288061,-30.600039479622808,-30.707303016467929,-30.82195433643524,-30.943041156423675,-31.069729467450269,-31.201287038749594,-31.337069522996359,-31.476508704011835,-31.619102517607693,-31.764406546535056,-31.912026746204152,-32.061613202206161,-32.212854756197764,-32.365474365305673,-32.519225083336565,-32.673886570870238,-32.829262056650052,-32.985175685253843,-33.141470196371031,-33.29800488955533,-33.454653835405985,-33.611304300024557,-33.76785535451566],[-59.530634494351894,-52.217341951863098,-46.962098485887253,-43.066440830694255,-40.110563653811184,-37.827835991523045,-36.04131752859756,-34.629315100310876,-33.5056105327821,-32.607569747795253,-31.88870655897464,-31.31387476263977,-30.856068915419151,-30.494241522049393,-30.211780513656358,-29.995426316254239,-29.834488025715913,-29.720267109571751,-29.64562764636948,-29.604671694981086,-29.592491185130598,-29.604976245954337,-29.638665667395678,-29.690629167631865,-29.758373919203095,-29.83976975463483,-29.932988883395325,-30.036456975437002,-30.148813216849085,-30.268877498737432,-30.395623315745585,-30.528155263806227,-30.665690264835888,-30.807541828558513,-30.953106802499462,-31.1018541706785,-31.253315547193495,-31.407077078326964,-31.56277252021545,-31.720077301653671,-31.878703415657224,-32.038395010808316,-32.19892457556454,-32.360089626707797,-32.521709827794332,-32.683624475497744,-32.845690301634185,-33.007779546832325,-33.169778268585709,-33.33158485206075,-33.493108696737877],[-57.157146574351898,-50.171231676001028,-45.164001576796352,-41.462732776640202,-38.663314922103872,-36.509231591523047,-34.830354304107765,-33.50974532672597,-32.464607059097887,-31.634828796975579,-30.975826589743871,-30.45391537133542,-30.04323058665203,-29.723628561010429,-29.47922251365636,-29.297341633901297,-29.167777935828276,-29.082232722474977,-29.03390395564783,-29.017174685080096,-29.027375013702024,-29.060598282651586,-29.113557720493024,-29.183473629170326,-29.267983853087387,-29.365072170634829,-29.473010604325555,-29.590312629572342,-29.715694983272442,-29.848046307248069,-29.986401260573171,-30.129919035618308,-30.277865441306478,-30.429597892252779,-30.584552777654743,-30.742234788860319,-30.902207866720119,-31.064087494511931,-31.227534113435787,-31.392247478449253,-31.557961804846414,-31.724441582236892,-31.891477953802884,-32.058885575946377,-32.22649988749582,-32.394174729156283,-32.561780263356674,-32.729201152466132,-32.89633495982995,-33.063090743463469,-33.229387816737884],[-54.882890654351897,-48.210666227725163,-43.4410804252812,-39.926073371234793,-37.27657350746972,-35.245756080411937,-33.670019651046537,-32.436983100310869,-31.467126392431222,-30.702756698614927,-30.101112774359258,-29.629909603219478,-29.264375819528745,-28.985233781789653,-28.777291674150188,-28.628442833901296,-28.528942003244005,-28.470873604195404,-28.447755522658142,-28.454240051416729,-28.485885508940122,-28.538979952376355,-28.610403755891255,-28.69752150951221,-28.79809626631053,-28.91022098663483,-29.032263333007727,-29.162820915286627,-29.300684778892879,-29.444809441999844,-29.594288170917999,-29.748332471859918,-29.906254996862032,-30.067455229832397,-30.2314074484622,-30.397650558557288,-30.565779476187572,-30.735437795089972,-30.906311525865167,-31.0781237325929,-31.250629923765331,-31.423614079591388,-31.596885218051586,-31.77027441858597,-31.943632235754528,-32.116826446229453,-32.28974008153849,-32.462269706456738,-32.634323909138701,-32.8058219742327,-32.976692714515657],[-52.707866734351896,-46.335645607035509,-41.793335031341798,-38.456462614478035,-35.95033940990875,-34.037409458189714,-32.560313569413886,-31.411028421065588,-30.513168532782096,-29.811353452713284,-29.264565112820794,-28.84185745829194,-28.519504614049289,-28.279057184387053,-28.105987995137841,-27.988729916254236,-27.917980227963106,-27.886189754733039,-27.887182347400408,-27.915867793990987,-27.968022670844881,-28.04012125512865,-28.129203773590369,-28.232772808657508,-28.348711158872511,-28.475216202634829,-28.610747069441835,-28.753981832579857,-28.903782603710397,-29.05916690299275,-29.219284046780068,-29.383395572531057,-29.550858931502557,-29.721113841297367,-29.893670814921826,-30.06810147976941,-30.244030375595855,-30.421127980061065,-30.599104757503586,-30.777706064084612,-30.956707772413981,-31.135912502871811,-31.315146368310653,-31.49425615462658,-31.67310687257045,-31.851579626717253,-32.02956975617964,-32.206985208804156,-32.383745116511975,-32.559778544368442,-32.735023390071213],[-50.632074814351895,-44.54616981393206,-40.220765394978166,-37.053900506369928,-34.68461262942094,-32.884191724856379,-31.501236059209802,-30.43188128899012,-29.602733480150519,-28.960619059270662,-28.466183605128485,-28.089758936552812,-27.808616970213677,-27.605098768802637,-27.465311476619323,-27.378202880960121,-27.33489260998558,-27.328181174087881,-27.352184429874633,-27.402057912802867,-27.47378649941631,-27.564022190908464,-27.669957773590369,-27.789227526606226,-27.919828530773337,-28.060057818634828,-28.208461813627881,-28.363795381452039,-28.524988457724998,-28.691118690226794,-28.861388888159379,-29.03510833763173,-29.211677245228046,-29.390573726647684,-29.571342877033629,-29.753587552496683,-29.936960564944968,-30.121158049425226,-30.305913808351043,-30.490994472924388,-30.676195350792359,-30.861336852078161,-31.046261404580086,-31.230830784068203,-31.414923797943587,-31.598434270619691,-31.781269287280118,-31.963347659508383,-32.144598581949765,-32.324960453870709,-32.50437984340455],[-48.655514894351917,-42.842238848414837,-38.723371516190305,-35.718387046910486,-33.479393166006325,-31.786102880411946,-30.492787120434308,-29.499541704084468,-28.735821234536495,-28.150553518287065,-27.705968251282339,-27.373614038002096,-27.131712888021902,-26.963358535036413,-26.855262118594638,-26.796861728018953,-26.779679149311427,-26.796847862259931,-26.842761770080827,-26.91281040785238,-27.00317699465441,-27.110682759715811,-27.232665755891258,-27.366885663358367,-27.511448382013015,-27.664745834634832,-27.825407565565868,-27.99226156190317,-28.164302340936679,-28.340664803701973,-28.520602695055935,-28.703470767161935,-28.888709938038506,-29.075834885883356,-29.264423634797602,-29.454108776739112,-29.644570044234918,-29.835528003182461,-30.026738678407543,-30.217988959112237,-30.40909265890047,-30.599887127210437,-30.790230326859881,-30.979998306910847,-31.169083011873937,-31.357390377936774,-31.54483867483993,-31.731357058569419,-31.916884305452072,-32.101367702739488,-32.284762074515655],[-46.778186974351911,-41.223852710483797,-37.301153394978179,-34.449922236099674,-32.334681019664856,-30.743142924856389,-29.534966753087364,-28.614009666348618,-27.912431795940002,-27.381156829762475,-26.983919051282339,-26.693422762639777,-26.488792367473955,-26.353836483088358,-26.275839921063774,-26.244706457430716,-26.252339845940639,-26.292189819249174,-26.358914368018969,-26.448125279139507,-26.556194156559172,-26.68010296155067,-26.817327720493029,-26.965747218913922,-27.123570712591523,-27.289280250634835,-27.461584325255792,-27.639380373933246,-27.82172425334544,-28.007805243418286,-28.196925467469725,-28.388482861121666,-28.58195700993393,-28.776897319004373,-28.972913088213751,-29.169665152496684,-29.366858813465683,-29.564237841332748,-29.761579367673079,-29.95868952264815,-30.155399696738307,-30.351563328268639,-30.547053135150037,-30.741758723154501,-30.935584514361494,-31.12844794866848,-31.32027791885907,-31.51101340598726,-31.700602287018892,-31.889000290974781,-32.076170083404548],[-45.000091054351913,-39.691011400138976,-35.954111031341817,-33.248506073937513,-31.250476190396565,-29.755311858189721,-28.627774957168999,-27.775285175782582,-27.132565164361054,-26.652428993696901,-26.300036005128494,-26.049185110465864,-25.879855408569846,-25.776532612958491,-25.727044884026739,-25.72173706919542,-25.752874699873225,-25.814207045055625,-25.900642223689072,-26.00800252666426,-26.1328379851306,-26.272282796413055,-26.423943667395683,-26.585812193272897,-26.756195522508882,-26.933661066634834,-27.116992092697654,-27.305151817542271,-27.497254194951278,-27.692540009375733,-27.890357205400761,-28.09014461951093,-28.291418460914322,-28.493761026010745,-28.696811237282077,-28.900256679769413,-29.103826872637285,-29.307287563876102,-29.510435876147657,-29.713096163532128,-29.915116464305875,-30.116365455252762,-30.316729829450555,-30.516112032799171,-30.714428305406273,-30.911606982814817,-31.107587019337537,-31.302316701761907,-31.495752526650229,-31.68785821857659,-31.878603870071213],[-43.321227134351915,-38.243714917380352,-34.682244425281212,-32.114138560423996,-30.226778678201441,-28.822609680411944,-27.771211732679202,-26.983368232386354,-26.396221339799652,-25.964370010090342,-25.654319112820801,-25.440901081480355,-25.304902011309572,-25.2314469246468,-25.20887700748353,-25.227953563313065,-25.281283711109182,-25.362899539679283,-25.467945337091134,-25.592442150426635,-25.733108480368696,-25.887222264302963,-26.052513596599223,-26.227080586435289,-26.40932281176508,-26.597888282634834,-26.791630867891449,-26.98957589273024,-27.1908921657542,-27.394869101574315,-27.600897908849035,-27.80845604232972,-28.017094290979681,-28.226426006902464,-28.436118082002572,-28.645883358557292,-28.855474221749709,-29.064677170812516,-29.27330820383127,-29.481208881764172,-29.688242961603173,-29.894293508162818,-30.099260409761435,-30.303058235844855,-30.505614385008265,-30.706867480375792,-30.906765976275334,-31.105266945893362,-31.302335024346082,-31.497941485544917,-31.69206343451566],[-41.741595214351918,-36.88196326220794,-33.485553576796363,-31.04681969555913,-29.263588483079491,-27.945036391523054,-26.965277079617977,-26.23825883615994,-25.703400322255792,-25.316979878942803,-25.046768374359264,-24.868570675683252,-24.763932175693135,-24.718579418153293,-24.721336291434145,-24.763355939783658,-24.837566879648506,-24.938267303120142,-25.060823708225158,-25.201444150426635,-25.357005642273457,-25.524921365220393,-25.703037508103648,-25.889552398401101,-26.082952580360121,-26.281961898634833,-26.485500650837189,-26.692652599497155,-26.902638165754198,-27.114792520014031,-27.328547577814554,-27.543417129578042,-27.758984500130008,-27.974892261679535,-28.190833622375244,-28.406545188860321,-28.621800860802963,-28.836406662141997,-29.050196350723926,-29.263027677344283,-29.474779188630201,-29.685347486998801,-29.89464487608268,-30.102597332291555,-30.309142753167464,-30.514229441351404,-30.717814789672467,-30.919864138381627,-31.120349780106448,-31.319250091879759,-31.516548776737881],[-40.261195294351914,-35.605756434621732,-32.364038485887271,-30.046549479342914,-28.360905605030712,-27.122591991523056,-26.209970997985323,-25.539956987103338,-25.054102111729478,-24.710258600254278,-24.477383789743879,-24.332193893074557,-24.256945901720531,-24.237930093477971,-24.26442273587859,-24.327944198607184,-24.421724205491202,-24.540310335378209,-24.679277337091136,-24.835008526664261,-25.004529470844886,-25.18538009916535,-25.375515401908959,-25.573227629170333,-25.777084828294008,-25.985881914634835,-26.198601441534862,-26.414381937843022,-26.632492194951279,-26.852310264694882,-27.073306212297311,-27.295027881255894,-27.517089088365303,-27.739159790341954,-27.960957858400086,-28.182242170678503,-28.402806789797047,-28.622476037864537,-28.841100316825621,-29.058552550272459,-29.274725145386956,-29.489527391760703,-29.702883228414283,-29.914729322139273,-30.125013409883884,-30.333692865741646,-30.540733459528923,-30.746108279226696,-30.949796793931334,-31.151784037581116,-31.352059896737881],[-38.880027374351911,-34.415094434621736,-31.317699152553939,-29.11332791177535,-27.518730044055104,-26.355276480411945,-25.505293487781245,-24.888462685216545,-24.448326708220705,-24.14420617402477,-23.946165358974646,-23.831770733654267,-23.783943189391763,-23.789498950620825,-23.83813634081686,-23.921718339783659,-24.033755688637271,-24.169028636453476,-24.323306223689073,-24.493135279139508,-24.675679966082981,-24.868598466137826,-25.069947278015153,-25.278106278742982,-25.491719555566732,-25.709648330634835,-25.930933239984473,-26.154763907767833,-26.380454253345441,-26.607422335616867,-26.835173812297313,-27.063288297363279,-27.291408055685565,-27.519228592889725,-27.746490790077111,-27.972974304011839,-28.198492008731954,-28.422885297980145,-28.646020102136358,-28.8677835005487,-29.088080831873445,-29.306833222448532,-29.523975466756255,-29.739454205388004,-29.953226355157518,-30.165257753546527,-30.375521985844713,-30.583999368428575,-30.790676065820733,-30.995543322648988,-31.198596794515659],[-37.598091454351916,-33.309977262207937,-30.346535576796363,-28.24715499285643,-26.737061800152663,-25.643089858189722,-24.851244549005735,-24.283775930499562,-23.886074111729478,-23.618822600254276,-23.453113082051573,-23.367301197422385,-23.344924038706832,-23.373285989581866,-23.442477106248958,-23.544678363313068,-23.673661329086709,-23.82442220634595,-23.992910368018968,-24.175824407852378,-24.370457127987741,-24.574576466137827,-24.786333136422233,-25.004188347119051,-25.226856762178301,-25.453261146634834,-25.682496046186024,-25.913798509271594,-26.146524340936679,-26.380128732779987,-26.614150377814553,-26.848198377900189,-27.081941402090795,-27.315098669322847,-27.547432417406299,-27.778741588860321,-28.008856517607697,-28.237634442488819,-28.464955706656131,-28.69072052817301,-28.91484624808966,-29.137264979062287,-29.357921591108585,-29.576771982037751,-29.793781588988359,-30.008924104766038,-30.222180368619835,-30.433537405987259,-30.642987595774652,-30.850527947083378,-31.056159470071215],[-36.415387534351915,-32.290404917380357,-29.450547758614547,-27.448030722586161,-26.015900873323396,-24.98603212485639,-24.247824181658796,-23.725896722952392,-23.367344322255793,-23.134107878942803,-22.998226958974648,-22.938785284378906,-22.939888449665737,-22.989291210361088,-23.077445032174886,-23.196824269195421,-23.34144112683952,-23.506491045055629,-23.688089770080826,-23.883075912802873,-24.088860956559174,-24.303314099165348,-24.524672977130194,-24.751473834298537,-24.982496448128714,-25.216720362634835,-25.453289860139513,-25.691485742354299,-25.930702457725001,-26.170429456184245,-26.410235908849039,-26.649758122866633,-26.888689127580989,-27.126770019641317,-27.36378274038767,-27.59954402522396,-27.833900316424263,-28.066723471390553,-28.297907130384946,-28.527363633145388,-28.755021394035605,-28.98082266160197,-29.204721601471281,-29.426682652088513,-29.646679111376422,-29.864691919400187,-30.080708607854284,-30.294722391902752,-30.506731383793085,-30.716737910884284,-30.924747923404549],[-35.331915614351914,-31.356377400138975,-28.629735698008485,-26.715955100964539,-25.3552472635673,-24.384103280411946,-23.695032385740426,-23.214825062575034,-22.892137339799653,-22.690062010090344,-22.581506989743879,-22.546222994523834,-22.568836422268475,-22.637514612958491,-22.743040118594639,-22.878156057430715,-23.0370950818957,-23.215235152582508,-23.408844429874641,-23.614889793990994,-23.830891451797267,-24.054811365220395,-24.284966800139046,-24.519962740281443,-24.758638613417972,-25.000025978634834,-25.243314681844939,-25.487825607015953,-25.732988603710403,-25.978324505829633,-26.223430405400762,-26.467967532262605,-26.711651232156154,-26.954242643845138,-27.195541759021204,-27.435381613102745,-27.673623405181658,-27.910152384685347,-28.144874373322796,-28.377712815465831,-28.608606269711281,-28.837506270067578,-29.064375497844335,-29.289186215540287,-29.511918922321698,-29.732561197448966,-29.951106703548064,-30.167554326175054,-30.381907429876033,-30.594173214051704,-30.804362154515658],[-34.347675694351928,-30.507894710483814,-27.884099394978193,-26.050928127991575,-24.755100970884381,-23.837303324856396,-23.192869161250638,-22.750560949367493,-22.460453164361063,-22.286684993696905,-22.202953174359269,-22.189614327857171,-22.231767956515057,-22.31795619737408,-22.439262365508224,-22.588673728018954,-22.760623194255253,-22.950654528926599,-23.155174347400418,-23.37126605141674,-23.596548613702033,-23.829068264302968,-24.067214605448783,-24.309655065067773,-24.555283258046074,-24.803177994634837,-25.052570511302306,-25.302818103256556,-25.553382778892889,-25.80381388171616,-26.053733867469727,-26.302826606088111,-26.550827715816286,-26.797516541934314,-27.042709473306921,-27.286254352496687,-27.52802578387989,-27.767921182373208,-28.005857435469693,-28.241768075134338,-28.47560087511669,-28.707315804459114,-28.936883280227757,-29.164282672393082,-29.389501021824188,-29.612531938912383,-29.833374655701174,-30.052033208804161,-30.268515734023502,-30.482833856585643,-30.695002163404549],[-33.462667774351928,-29.744956848414848,-27.213638849523647,-25.452949803667249,-24.215461995274623,-23.345632258189731,-22.741334508189414,-22.333104383329758,-22.072291795940011,-21.923976829762481,-21.862565512820808,-21.86895928437891,-21.928683052405468,-22.030615963607843,-22.166111772915631,-22.328377280960133,-22.512025463918171,-22.71274917408789,-22.927079522658147,-23.152204685080108,-23.385832442273461,-23.62608479641306,-23.871416393059405,-24.120550808657512,-24.372430382013015,-24.626176410634837,-24.881057348511607,-25.136463231076107,-25.391884983272448,-25.64689758384382,-25.901146295055938,-26.154335344343146,-26.406218578561383,-26.656591713908835,-26.905285883244808,-27.15216224340578,-27.397107452518938,-27.640029864454135,-27.880856316825625,-28.119529412150914,-28.356005210251823,-28.590251264776576,-28.822244948621538,-29.05197202264689,-29.279425409883885,-29.504604143790431,-29.727512464313616,-29.948159039790077,-30.166556296235484,-30.382719838486093,-30.596667950071218],[-32.676891854351929,-29.06756381393209,-26.618354061644858,-24.922020127991573,-23.736330336738039,-22.909090080411953,-22.340428426556759,-21.962455364461832,-21.727653234536501,-21.60193751828707,-21.560344005128499,-21.584257864089054,-21.659581709939715,-21.775493911659794,-21.923588340816863,-22.097266716254246,-22.291301890884466,-22.501519088066384,-22.724559955647841,-22.957705694981094,-23.198742937511554,-23.445860961550672,-23.697572162970907,-23.952649971050676,-24.210079985318799,-24.469021226634837,-24.728775193472849,-24.988760990474603,-25.24849521684909,-25.507575612212616,-25.765667688159382,-26.02249374702771,-26.27782382039145,-26.531468159768707,-26.783270988834872,-27.033105285830022,-27.280868411098822,-27.526478430928123,-27.769871017390596,-28.010996826515555,-28.249819275116689,-28.486312651019965,-28.720460503025684,-28.952254266301711,-29.181692086500803,-29.408777812083116,-29.633520129385385,-29.855931819132799,-30.076029116511979,-30.293831159753061,-30.509359514515662],[-31.990347934351931,-28.475715607035539,-26.098245031341829,-24.458139100964548,-23.317705995274626,-22.527676791523064,-21.990150916352679,-21.638613892763722,-21.426537480150536,-21.32056705927068,-21.296288651282346,-21.335510066987606,-21.424463929117795,-21.552590041529925,-21.711692069211928,-21.895342033901308,-22.098452475154129,-22.316964270862083,-22.547615646369486,-22.787769081119709,-23.035280099416319,-23.288396759715813,-23.545681915183295,-23.805952552247259,-24.068232067963429,-24.331712442634839,-24.595724046186028,-24.859711381452048,-25.123213479622816,-25.385847966822546,-25.647298046780072,-25.907301814141803,-26.165643441306482,-26.422145879513931,-26.676664790077112,-26.929083479769414,-27.179308659619529,-27.427266881795177,-27.672901537164606,-27.916170318228261,-28.157043069711282,-28.395499963189273,-28.631529943440192,-28.86512940335755,-29.096301051674935,-29.325052943790432,-29.551397650916485,-29.775351546832329,-29.996934194852994,-30.216167820386545,-30.433076856737884],[-31.40303601435193,-27.969412227725194,-25.653311758614556,-24.061306722586171,-22.959588970884383,-22.201392391523065,-21.690501977577171,-21.361579968235418,-21.168944532782113,-21.0798654527133,-21.070399451282345,-21.122715893074563,-21.223329709939712,-21.361904353218236,-21.530422958100814,-21.72260323390131,-21.933477216727162,-22.159084722474987,-22.396246594823097,-22.642394843495946,-22.895443927987749,-23.153692190908473,-23.415745649696571,-23.680458552247259,-23.946886629946903,-24.214250058634839,-24.481903906651144,-24.749314404008437,-25.016039771593618,-25.281714647673606,-25.546037370918004,-25.80875954568543,-26.069677441306482,-26.328624873144506,-26.585467286971522,-26.840096825223959,-27.092428198081073,-27.342395217055291,-27.589947876147658,-27.835049887289035,-28.077676594035609,-28.317813201284515,-28.555453269865062,-28.790597433814401,-29.023252305406274,-29.253429538912378,-29.481145028906916,-29.706418222888669,-29.929271531258525,-30.149729820386547,-30.367819976737884],[-30.914956094351929,-27.548653676001056,-25.283554243463044,-23.731522992856441,-22.661979263567307,-21.930236880411954,-21.44148161023023,-21.131353590876927,-20.95487439243124,-20.879832698614941,-20.8826764051285,-20.945875342349925,-21.056179052405469,-21.203436846724728,-21.379781007483533,-21.57905031625425,-21.796376115603568,-22.027880442905094,-22.270452801008666,-22.521582982109809,-22.779234423225844,-23.041747255128655,-23.307763366510731,-23.57616797105068,-23.846043671269214,-24.116634074634838,-24.387314774868198,-24.657570058143776,-24.926974092761501,-25.195175654765805,-25.461885660573177,-25.726866941658582,-25.989925820391452,-26.250905140660429,-26.509678479518101,-26.766145322193658,-27.02022702648344,-27.271863436708472,-27.521010034339749,-27.767635533697874,-28.011719848089662,-28.253252365305677,-28.492230482300297,-28.72865835767227,-28.962545847694834,-29.19390759744897,-29.422762263356677,-29.649131847301813,-29.87304112572857,-30.094517159753064,-30.313588874515663],[-30.526108174351933,-27.213439951863126,-24.988972485887285,-23.468787911775358,-22.424876873323406,-21.71421025818973,-21.243089814311865,-20.947934760688248,-20.784327059097905,-20.720468796975595,-20.733119512820807,-20.804988414813693,-20.923011956515058,-21.077187522049403,-21.259766217360074,-21.464683280960131,-21.687149171783343,-21.923351432152408,-22.17023426492619,-22.425333496961294,-22.686651585130605,-22.952561952376364,-23.221735065625776,-23.493080808657517,-23.765703191930371,-24.038864490634836,-24.311956650837192,-24.584478343858063,-24.856016443126464,-25.126230988099142,-25.394842915745592,-25.661624002061266,-25.926388578561387,-26.188986682061703,-26.449298367716864,-26.707228970678507,-26.962705144826636,-27.215671540754713,-27.466088011740879,-27.713927257454781,-27.959172831873445,-28.201817455252765,-28.441861580745893,-28.679312174931152,-28.914181678540601,-29.146487119400184,-29.37624935426577,-29.603492420071767,-29.828242978263134,-30.050529838486096,-30.270383550071216],[-30.23649225435193,-26.963771055311405,-24.769566485887285,-23.273101479342927,-22.248281800152675,-21.553312524856398,-21.095326589822069,-20.811323477669383,-20.657302532782118,-20.601773747795271,-20.621728774359269,-20.700055110465868,-20.823828422268484,-20.983156379192259,-21.170378587730447,-21.379502128018956,-21.605796385266487,-21.845497690216924,-22.095590986575676,-22.353646388050404,-22.617695413702034,-22.886136282651592,-23.157660747041703,-23.431197065067771,-23.705865191930371,-23.98094130663484,-24.255829534558121,-24.530039261151295,-24.80316682268851,-25.074880647673609,-25.344909136435248,-25.613030726893481,-25.879065715816289,-26.142869497348325,-26.404326951567796,-26.663347770678506,-26.919862553110654,-27.17381952919402,-27.425181808351049,-27.673925058559753,-27.920035545386959,-28.16350847112578,-28.404346565201852,-28.64255888559105,-28.878159797943589,-29.111168104766044,-29.34160630163419,-29.569499941198529,-29.794877088862211,-30.017767856585643,-30.238204003404551],[-30.046108334351935,-26.799646986345888,-24.625336243463046,-23.144463695559146,-22.132194044055115,-21.447543680411954,-20.998191936760843,-20.721519741820327,-20.573800813483871,-20.52374755107396,-20.548504189743888,-20.631075429306449,-20.758628449665743,-20.921343418153299,-21.111618118594645,-21.323506857430722,-21.552317756053007,-21.794319217098646,-22.046522965957116,-22.306521655377136,-22.572365908940128,-22.842470245954345,-23.11554041075852,-23.390516740281448,-23.666529671269217,-23.942864522634835,-24.21893342603099,-24.494252810023475,-24.768425231447633,-25.041124633489211,-25.312084322642143,-25.581087116155228,-25.847957232156158,-26.112553586520303,-26.374764231070898,-26.634501722193658,-26.89169925133551,-27.146307402026387,-27.398291424170257,-27.647628937012794,-27.894307988630203,-28.138325412924729,-28.379685435668172,-28.618398489651966,-28.854480205903791,-29.087950553546527,-29.318833105461941,-29.547154410682097,-29.772943457525805,-29.996231214051704,-30.217050234515661],[-29.954956414351933,-26.721067744966579,-24.55628175861456,-23.08287456042401,-22.076613605030726,-21.396903724856401,-20.951685855128193,-20.678523553141083,-20.533821901203169,-20.486390206811663,-20.513445758974655,-20.598049371335435,-20.727412038706838,-20.891748638932523,-21.083484809952672,-21.296697469195429,-21.526713284142893,-21.76981601279757,-22.023030203070519,-22.283959298941493,-22.550663070844891,-22.821563842284618,-23.095374056776219,-23.371039834298543,-23.6476966299469,-23.924634138634836,-24.201268325255796,-24.477118990474604,-24.751791669403836,-25.024962945545948,-25.296368474366282,-25.565793169846504,-25.833063127580992,-26.098038949577628,-26.360610206226177,-26.62069082522396,-26.878215239501188,-27.133135159251822,-27.385416859198507,-27.635038892813899,-27.881990161603177,-28.12626828064959,-28.367878192144858,-28.606830987113895,-28.843142902421199,-29.076834465741648,-29.307929765749023,-29.536455828522474,-29.762442084253916,-29.985919910884284,-30.206922243404552],[-29.96303649435194,-26.728033331173478,-24.562403031341837,-23.088334073937524,-22.081540483079507,-21.401392658189735,-20.955808344924112,-20.682334911631649,-20.537365795940012,-20.489701715008387,-20.516553482051581,-20.600976936552826,-20.73017918939177,-20.894372041529927,-21.085978661804525,-21.299073963313077,-21.528982969536152,-21.771988077313701,-22.025112697915883,-22.285959318743473,-22.552586899416319,-22.823417071642417,-23.097161685094804,-23.372766347119054,-23.649366067963431,-23.926250154634836,-24.20283423223254,-24.478637802504679,-24.753266136557123,-25.026395583843822,-25.29776159160766,-25.56714888796731,-25.834383402090797,-26.099325586520301,-26.361864877033632,-26.621915079769416,-26.879410517607695,-27.134302800870323,-27.386558113435793,-27.636154925963069,-27.883082064305878,-28.127337074300385,-28.368924834631905,-28.607856377976841,-28.844147887495829,-29.077819841351406,-29.308896282495436,-29.537404194719656,-29.763372969046543,-29.98683394708338,-30.207820030071218],[-30.070348574351939,-26.820543744966582,-24.643700061644868,-23.16084223609969,-22.14697467820146,-21.461010480411957,-21.010559406148602,-20.732953817292028,-20.584432497694401,-20.533682075664125,-20.557827358974656,-20.639858124958625,-20.766929901720538,-20.929213625945511,-21.119099674150203,-21.330636339783666,-21.559126812232783,-21.800835410647032,-22.052770450493203,-22.312521714783077,-22.578137394654416,-22.848029934027743,-23.120903295714271,-23.395696278742989,-23.671537985318803,-23.947712570634838,-24.223631146961225,-24.498809246113701,-24.77284863290749,-25.045422548382831,-25.316263674366283,-25.585154270517645,-25.851918055685569,-26.116413497348329,-26.378528243493257,-26.638174485830024,-26.89528508565504,-27.149810326881884,-27.401715186882122,-27.650977036460308,-27.897583696738312,-28.141531793877107,-28.382825363129314,-28.6214746622408,-28.857495161127666,-29.090906680375795,-29.321732655701176,-29.549999509273647,-29.775736111903687,-29.99897332264899,-30.219743594515663],[-30.27689265435194,-26.998598986345893,-24.800172849523655,-23.300399046910503,-22.272916190396582,-21.575757191523071,-21.115939038801663,-20.830380270122216,-20.675022006466332,-20.618331288778879,-20.63726738974389,-20.714692936552829,-20.837664175693142,-20.996273392179276,-21.182847846989709,-21.391384598607196,-21.617144812232784,-21.856358012797571,-22.106003460802484,-22.363646487060308,-22.627314556559178,-22.895402429440587,-23.166598888634628,-23.43982962917034,-23.714212382013017,-23.989021386634839,-24.263659069441843,-24.537633321301673,-24.810539158454933,-25.082043839162971,-25.351874722642144,-25.619809317497509,-25.885667088365309,-26.149302682061705,-26.410600305605065,-26.66946904340578,-26.9258389436432,-27.179657737286504,-27.430888079537489,-27.679505224305611,-27.925495058900474,-28.168852439379755,-28.409579777637084,-28.647685839905773,-28.883184723316724,-29.116094982814822,-29.346438885366247,-29.574241772184447,-29.799531512825347,-30.022338037581118,-30.242692936737885],[-30.582668734351941,-27.262199055311413,-25.031821394978202,-23.507004506369963,-22.45936501966488,-21.745632791523072,-21.2719472428833,-20.974614270122217,-20.809134322255805,-20.743649354352652,-20.754873574359273,-20.825481371335439,-20.942382011309583,-21.095551340231225,-21.277223180323041,-21.481318739783667,-21.703036969536157,-21.938555883765314,-22.184811728843719,-22.43933363557516,-22.700118385130608,-22.96553455788095,-23.234248463855867,-23.505166398401109,-23.777389258046078,-24.050176602634842,-24.322917999674402,-24.595110028068589,-24.86633771319946,-25.136259456184249,-25.40459473643525,-25.671114028906906,-25.935630500130014,-26.197993140660429,-26.458081063369036,-26.715798752496688,-26.971072091572196,-27.223845032084199,-27.474076791401899,-27.721739489498983,-27.966816150792365,-28.209299010808323,-28.44918807815522,-28.686489910971765,-28.921216574062996,-29.153384748668479,-29.383014971490649,-29.610130983452052,-29.83475917181152,-30.056928091879762,-30.276668056737886],[-30.987676814351946,-27.611343951863141,-25.338645698008509,-23.780658614478071,-22.706321166006344,-21.970637280411964,-21.478584018393505,-21.165655817292031,-20.986769445062823,-20.909636272385438,-20.910645912820815,-20.972223429306453,-21.081083408569857,-21.227047470101358,-21.402225674150202,-21.600438763313079,-21.8168032841429,-22.047429023550261,-22.289195254616914,-22.539583160327634,-22.796548880368704,-23.058426319348843,-23.323852021377991,-23.591706586435297,-23.861068613417977,-24.13117821863484,-24.401407937658899,-24.671239366414454,-24.940244297141067,-25.208069399446661,-25.474423715745594,-25.739068404745833,-26.001808290979689,-26.262484873144508,-26.520970516785184,-26.777163613102751,-27.030984529442023,-27.282372211274946,-27.531281322475344,-27.77767983204042,-28.02154697241399,-28.262871508162824,-28.501650264683718,-28.737886875438768,-28.971590713366474,-29.202775977936774,-29.431460914074382,-29.657667143076466,-29.881419088862213,-30.10274348554492,-30.321668954515662],[-31.491916894351949,-28.046033676001073,-25.720645758614573,-24.121361371234833,-23.013784629420979,-22.25077065818974,-21.735849365332282,-21.403504911631654,-21.207927374887387,-21.116292042877241,-21.104584405128506,-21.154919110465876,-21.253768367473967,-21.390761781789671,-21.557855328471192,-21.748744669195432,-21.958443756053011,-22.182977432152413,-22.419154038122073,-22.664395061317734,-22.916606042273465,-23.174077713844255,-23.435409561200998,-23.699450193272902,-23.965250448128721,-24.232026234634841,-24.499128883395333,-24.766021336339268,-25.032258910279751,-25.297473668950207,-25.56136166057318,-25.823672445014289,-26.084200460914328,-26.342777879513935,-26.599268665853508,-26.853563625223963,-27.105576257252672,-27.355239274858761,-27.602501672757832,-27.847326251929921,-28.089687523765342,-28.329569931443245,-28.566966337222578,-28.801876733306791,-29.034307141227174,-29.2642686706197,-29.491776713117446,-29.716850251057686,-29.939511263977419,-30.159784218576593,-30.377695630071219],[-32.095388974351948,-28.566268227725214,-26.17782157679639,-24.52911277664024,-23.381755409908784,-22.586032924856411,-22.04374328369963,-21.688161553141089,-21.472608111729492,-21.363616665828065,-21.336689051282356,-21.3735684148137,-21.460436888021913,-21.586694275296164,-21.74411214328601,-21.926236457430726,-22.127958385266496,-22.345201109571768,-22.574688079359184,-22.813769338545455,-23.060289870844898,-23.312488741367194,-23.568921083324895,-23.828397218913928,-24.089934762178309,-24.35272065063484,-24.616080836883707,-24.879455937843026,-25.142381552615518,-25.404472264694888,-25.665408570918007,-25.924926149712277,-26.182807009933939,-26.438872159768714,-26.692975510574009,-26.944998788860328,-27.19484727500415,-27.442446222835642,-27.687737842249355,-27.930678749167491,-28.17123780484642,-28.409394280649593,-28.645136295771803,-28.878459484575824,-29.109365857645081,-29.337862826717263,-29.563962368619837,-29.787680307395714,-30.009035697157145,-30.228050290974785,-30.444748083404551],[-32.798093054351952,-29.172047607035559,-26.710173152553971,-25.003912830694297,-23.810233507469764,-22.976424080411967,-22.40226577349555,-22.019625741820334,-21.780811655589144,-21.651610141237903,-21.606959851282355,-21.628171342349933,-21.701088970213696,-21.814844950620838,-21.96099611859465,-22.13291412801896,-22.325347171783349,-22.534100055808327,-22.755797378328261,-22.987705992010802,-23.227600366082992,-23.473659401917651,-23.724386587749674,-23.978547663358377,-24.235121555566742,-24.493261466634841,-24.752263798124016,-25.011543170925737,-25.270612224148365,-25.529065186680704,-25.78656444678008,-26.042829518839795,-26.297627938038513,-26.55076771390884,-26.802091050946679,-27.051469104011844,-27.298797582696459,-27.543993055205583,-27.786989830949921,-28.027737323753126,-28.266197815657232,-28.502344555781875,-28.736160140331389,-28.967635129245878,-29.196766862620208,-29.423558446229457,-29.648017880581563,-29.870157312090551,-30.089992388401384,-30.307541702739492,-30.522826314515665],[-33.600029134351949,-29.863371813932108,-27.3177004858873,-25.545761533396995,-24.299218922103904,-23.42194412485641,-22.811416834720035,-22.397897477669389,-22.132538006466334,-21.980272469106751,-21.915396805128509,-21.918727893074568,-21.975724614049309,-22.075213807763696,-22.208507254397119,-22.368777680960136,-22.550610115603572,-22.749674270862087,-22.962481935029288,-23.186205021713775,-23.418537527987752,-23.657589695495631,-23.901806074475338,-24.149901526606236,-24.400810828294013,-24.653648682634842,-24.907677767116265,-25.162283035587389,-25.416950924878293,-25.671252434907654,-25.924829288159387,-26.177382552396839,-26.428663245228055,-26.678464541934318,-26.926615286971526,-27.172974570678509,-27.417427180329597,-27.65987977196859,-27.900257638859525,-28.138501975686829,-28.374567556197771,-28.608420756840069,-28.840037870901334,-29.069403667316941,-29.296510156152543,-29.521355529156288,-29.743943249002612,-29.964281265142194,-30.18238133771014,-30.39825845387071,-30.611930323404554],[-34.501197214351947,-30.640240848414869,-28.000403576796391,-26.154658884748347,-24.848711653811222,-23.922593058189744,-23.271196467373098,-22.82297676068826,-22.527787164361072,-22.34960364943462,-22.261999912820816,-22.245238066987614,-22.284343819528765,-22.367800846724734,-22.486645550693417,-22.633827116254256,-22.803747216727167,-22.991923754733058,-23.194741749462278,-23.409266427654366,-23.63310135655918,-23.864279622101137,-24.101179543501885,-24.342458808657518,-24.587002580360128,-24.83388229863484,-25.082322743860452,-25.33167553182799,-25.581397654805301,-25.831034009375738,-26.080203095055939,-26.328585250383419,-26.575912931502565,-26.821962643845144,-27.066548218648542,-27.309515188860328,-27.550736067903557,-27.790106373124658,-28.027541265978169,-28.262972704968597,-28.496347026468044,-28.727622883824196,-28.956769487481647,-29.183765098789024,-29.408595738242099,-29.63125407549775,-29.851738473882996,-30.070052166550642,-30.286202545083412,-30.50020054436845,-30.712060110071221],[-35.501597294351953,-31.502654710483835,-28.758282425281241,-26.830604884748347,-25.458711702591714,-24.478370880411966,-23.781604671454733,-23.29486359087694,-22.966559129273353,-22.759603682221506,-22.646769174359278,-22.607701864089066,-22.626946586652053,-22.692606067503956,-22.795411007483541,-22.928062433901317,-23.084758475154135,-23.26084850742123,-23.452576821627225,-23.656890209832586,-23.871291851797277,-24.093729181734169,-24.322506994829318,-24.556219509512221,-24.793696811765088,-25.033962314634842,-25.276198728356576,-25.51972065964754,-25.763952413929388,-26.008409910084961,-26.252685867469733,-26.496437612799525,-26.739376996862042,-26.981262019641324,-27.221889845977735,-27.461090958557296,-27.698724245418354,-27.934672858673792,-28.168840712305855,-28.40114951159843,-28.631536226468043,-28.859950936734251,-29.086354990072319,-29.310719423662121,-29.533023608888868,-29.75325408525385,-29.971403555222707,-30.187470016315903,-30.401456010521201,-30.613367974232702,-30.823215674515662],[-36.601229374351959,-32.450613400139012,-29.591337031341851,-27.573599533396997,-26.129219068445373,-25.089277591523079,-24.342641446964937,-23.813557968235433,-23.448853901203179,-23.21027256746741,-23.069704589743893,-23.006119284378919,-23.003532915419175,-23.049629470101358,-23.134803624767493,-23.251483633901316,-23.393643890884473,-23.556448528926609,-23.735987151524135,-23.929076368248431,-24.13310901370204,-24.345938374394716,-24.565788428457637,-24.791183629170341,-25.020893522508892,-25.253888730634841,-25.489305720604637,-25.726418419046038,-25.964615202250556,-26.203380137035314,-26.442277605400768,-26.680939639645164,-26.919055441306487,-27.156362669322853,-27.392640168959105,-27.627701879769418,-27.861391712873974,-28.093579228615987,-28.324155977842576,-28.553032395576331,-28.780135156197773,-29.005404915570232,-29.228794378673356,-29.450266641936231,-29.669793768092845,-29.887355558424581,-30.102938493021753,-30.316534814437968,-30.528141734023503,-30.737760743463472,-30.945397016737886],[-37.800093454351959,-33.484116917380391,-30.499567394978214,-28.383642830694299,-26.860233751372206,-25.755313191523079,-24.954306793903715,-24.379059892763735,-23.974671480150548,-23.701610305172331,-23.530806158974663,-23.440490327857184,-23.414102805830133,-23.438871054516945,-23.50482340254527,-23.604090716254259,-23.730403463918183,-23.878723819249188,-24.044972739153003,-24.225824902901895,-24.418552842273471,-24.62090720008279,-24.831023844386841,-25.047351167631881,-25.268592712591534,-25.493661546634844,-25.721643720604639,-25.951768810023481,-26.183386019768804,-26.415944690226805,-26.648978308849046,-26.882091330920332,-27.114948264835899,-27.347264592889733,-27.578799187592644,-27.809347952496694,-28.038738470270424,-28.266825482951248,-28.49348706258834,-28.7186213569023,-28.942143815657232,-29.163984820332139,-29.384087653284755,-29.602406753611358,-29.818906215854042,-30.033558495009949,-30.246343287280126,-30.457246560916843,-30.666259715590325,-30.873378852060757,-31.078604136737887],[-39.09818953435196,-34.60316526220798,-31.482973516190338,-29.260734776640245,-27.651755751372207,-26.476477680411971,-25.616600712271065,-24.99136936446185,-24.544011866115461,-24.233616895336265,-24.030073882051589,-23.91081499452385,-23.858656257884931,-23.860330820750711,-23.905470340816876,-23.985883680960143,-24.095037194255262,-24.227674378388976,-24.379533584513826,-24.547135813792984,-24.727623337511567,-24.918635658798387,-25.118213242616932,-25.324722124896837,-25.536794382013021,-25.753280762634844,-25.973212728356575,-26.195771832579872,-26.420264866484136,-26.646103569659431,-26.872787977814561,-27.099892686625029,-27.327055467450279,-27.553967790341961,-27.780366901878359,-28.006029176739116,-28.230764517607703,-28.454411621679576,-28.676833966543143,-28.897916395576331,-29.117562204846422,-29.335690651019966,-29.552234813906519,-29.767139758687502,-29.980360952172447,-30.191862895009947,-30.40161793799783,-30.609605255752523,-30.815809955221663,-31.02022230002456,-31.222837034515663],[-40.495517614351947,-35.807758434621761,-32.541555394978211,-30.204875371234831,-28.503785068445367,-27.25277105818974,-26.329523202066973,-25.65048638332977,-25.156875059097914,-24.80629233795921,-24.56750775897466,-24.417093284378918,-24.337193271583558,-24.314008768802658,-24.336744439582304,-24.396862528018961,-24.487545081895707,-24.60330020634596,-24.739669687606607,-24.893009100921695,-25.060320499416324,-25.239123750541506,-25.427356623147904,-25.62329650096521,-25.825498530773352,-26.03274637863484,-26.244012743860448,-26.458427486715209,-26.67525174239654,-26.893856775333187,-27.113706612297321,-27.334343706759256,-27.555377049149623,-27.77647226167954,-27.997343311816245,-28.217745552496691,-28.437469854885805,-28.656337644800956,-28.874196689706984,-29.09091751159843,-29.306390323765338,-29.52052240763372,-29.733235860538642,-29.94446565716466,-30.154157977048065,-30.362268758424577,-30.568762445174862,-30.773610898945009,-30.976792452917511,-31.178291087354875,-31.378095710071218],[-41.992077694351948,-37.097896434621767,-33.675313031341844,-31.216064614478075,-29.416321702591713,-28.084193324856408,-27.093074263291467,-26.356410949367504,-25.813261059097911,-25.419636633041179,-25.143107789743894,-24.959325197422395,-24.849713846926022,-24.799904898672786,-24.798645698841565,-24.837027257430726,-24.907927126839528,-25.005601303120152,-25.12538104843135,-25.263444764288032,-25.416644327987754,-25.582371475312147,-25.758453985979763,-25.943074295837008,-26.134705158872528,-26.332058394634842,-26.534043767116266,-26.739735772429494,-26.948346647506028,-27.159204307248078,-27.371734212297319,-27.585444391323016,-27.799913009933938,-28.014778006902471,-28.229728417406307,-28.44449707976942,-28.658854482104744,-28.872603552315411,-29.085575232079865,-29.297624704968598,-29.508628172413989,-29.718480090173408,-29.927090793181129,-30.13438444904283,-30.340297290480905,-30.544776085253851,-30.747776808811224,-30.949263490494307,-31.149207208677883,-31.347585214051708,-31.544380163404554],[-43.587869774351958,-38.473579262207977,-34.884246425281241,-32.294302506369974,-30.389365653811225,-28.970744480411966,-27.907253895944528,-27.10914306257505,-26.513169866115458,-26.073649780582166,-25.75687397435928,-25.53751073365428,-25.396217983912326,-25.318019210361101,-25.29117411859465,-25.30637786919543,-25.356183329086718,-25.434577668711555,-25.536667666988052,-25.658442803891994,-25.796594823225846,-25.948378833110315,-26.111505331112507,-26.284055509512221,-26.464414266310541,-26.651216810634843,-26.843305798124018,-27.039696689722728,-27.2395495818126,-27.442146165404107,-27.646870777814563,-27.853194740316304,-28.060663349803217,-28.26888502601075,-28.477522218648545,-28.686283758557298,-28.894918399264505,-29.103209344222925,-29.310969593661785,-29.518037975686831,-29.724275750792369,-29.929563698639015,-30.133799611833979,-30.336896134322018,-30.538778892470951,-30.739384875497748,-30.938661028906921,-31.13656303040041,-31.333054222502767,-31.528104680115057,-31.721690394515665],[-45.282893854351954,-39.934806917380392,-36.168355576796394,-33.439589046910513,-31.422916922103909,-29.912424524856412,-28.772062100026165,-27.908682722952413,-27.25660148015055,-26.768331780582166,-26.408806312820818,-26.15164989307457,-25.976705682542466,-25.868351703867596,-25.814329698841565,-25.804914363313081,-25.832313688637282,-25.890229303120158,-25.973529543276712,-26.078003219733578,-26.200171985130609,-26.337145823936002,-26.486510658546134,-26.646240141990855,-26.814625853087399,-26.990221626634842,-27.171798836883706,-27.358310238594907,-27.548860545316252,-27.742682349801271,-27.939116308849044,-28.137594753739123,-28.337628068757468,-28.53879331900438,-28.740724715542953,-28.943105588860327,-29.145661606365096,-29.348155020523507,-29.550379774452747,-29.752157323753128,-29.953333058900476,-30.153773233030549,-30.35336231649719,-30.552000713002222,-30.749602783018219,-30.946095129156291,-31.141415105461945,-31.335509518663322,-31.528333494392168,-31.71984948554492,-31.910026403404554],[-47.077149934351965,-41.481579400139012,-37.527640485887304,-34.651924236099703,-32.516975507469766,-30.909233458189746,-29.68749887553637,-28.755029930499582,-28.043555901203181,-27.503682633041183,-27.098904805128512,-26.801742675683272,-26.591176942816439,-26.450902379192271,-26.368112439582308,-26.332636739783673,-26.336318205491217,-26.372556206345962,-26.435966677297333,-26.522126011812787,-26.627375813702042,-26.748672447789215,-26.88346996828065,-27.029628193272906,-27.185339919203109,-27.349072842634843,-27.519522883395336,-27.695576419046038,-27.876279538016981,-28.060812860439572,-28.248470805400771,-28.438644431591474,-28.630807166796686,-28.824502885883362,-29.019335908089538,-29.214962570678512,-29.411084103406516,-29.607440581217148,-29.803805774452748,-29.999982749167494,-30.195800096738314,-30.391108693348009,-30.585778907170766,-30.77969818508344,-30.9727689621227,-31.164906846229457,-31.356039038476297,-31.54610295528304,-31.735045024346086,-31.922819630341301,-32.109388190071222],[-48.970638014351962,-43.113896710483843,-38.962101152553977,-35.931308073937544,-33.671541409908791,-31.961171280411971,-30.653564222475147,-29.648184685216567,-28.874033129273357,-28.279702337959215,-27.827169451282359,-27.487789081480372,-27.239631764734249,-27.065671236335128,-26.952522340816877,-26.889544998607199,-26.868196879648522,-26.881558378388974,-26.92397906904991,-26.990811180129619,-27.078206308940135,-27.182958704669947,-27.302383260316049,-27.434219663358377,-27.576556464657649,-27.727770458634843,-27.886477937658903,-28.051495231076114,-28.221806559914793,-28.396537697319005,-28.574934267469736,-28.756343773873354,-28.940200643920868,-29.126013726647695,-29.313355796288292,-29.501854704011844,-29.691185890388766,-29.881066026303849,-30.071247593661788,-30.261514251929924,-30.451676864305881,-30.641570079591396,-30.831049383854705,-31.019988550565675,-31.208277429784388,-31.395820026717267,-31.582532827949983,-31.768343340259566,-31.95318881236452,-32.137015114504202,-32.319775754515661],[-50.96335809435196,-44.831758848414879,-40.4717375767964,-37.277740560424036,-34.88661462942099,-33.068237991523084,-31.670258140842492,-30.588146987103357,-29.748033164361075,-29.096390895336267,-28.593600251282361,-28.209789110465881,-27.922070148295891,-27.712658275296167,-27.567559402545271,-27.475639139783674,-27.427949711109196,-27.417235819249193,-27.437566718534448,-27.484058724684076,-27.552663470844898,-27.640004594578205,-27.743250534652333,-27.860014552247268,-27.988275489451041,-28.126314474634842,-28.272663999674407,-28.426066674685135,-28.585441611009681,-28.749856860439571,-28.918506695055942,-29.090692780584764,-29.265808500130017,-29.443325841297376,-29.62278438013923,-29.803781988860329,-29.985966967311846,-30.169031355783623,-30.352705232079867,-30.536751832040423,-30.720963361603179,-30.90515739176071,-31.089173746549005,-31.272871809448922,-31.456128186003291,-31.638834670619701,-31.820896473882996,-32.002230673592898,-32.18276485844747,-32.362435938033613,-32.541189096737888],[-53.055310174351973,-46.635165813932126,-42.05654975861458,-38.691221695559165,-36.162195166006356,-34.230433591523088,-32.737580630638412,-31.574916836159964,-30.665556006466339,-29.953748305172333,-29.398197205128515,-28.967742762639794,-28.63849209350137,-28.391863496075388,-28.213223624767494,-28.090919163313082,-28.01557669987324,-27.979588528926612,-27.976729625750941,-28.001868645476154,-28.050747299416329,-28.119810117513989,-28.206071791289499,-28.307012859939576,-28.420496993583271,-28.544704890634844,-28.678081069441848,-28.819290749873108,-28.967184691301654,-29.120770349801276,-29.27918808815939,-29.441691451725703,-29.607630735424138,-29.776439229832409,-29.94762165964233,-30.120744425223968,-30.295427334175749,-30.471336569656451,-30.648178689706985,-30.825695489498987,-31.003659588630207,-31.18187062985595,-31.36015199525367,-31.538347961733187,-31.716321230779414,-31.89395077793678,-32.071129976275344,-32.247764955283039,-32.423773162594934,-32.599082100929536,-32.77362821673789],[-55.246494254351973,-48.524117607035578,-43.716537698008523,-40.171751479342959,-37.498283019664896,-35.447758080411973,-33.855531691862907,-32.608494232386377,-31.626601655589148,-30.851774567467416,-30.240960312820825,-29.761650038002117,-29.388897600350688,-29.103286898672792,-28.889515007483546,-28.735385069195438,-28.631077845940659,-28.568616507421233,-28.541467790699397,-28.544240942505859,-28.572457794654422,-28.622375273477292,-28.690847030227555,-28.7752145864353,-28.873220977054345,-28.982941706634847,-29.102729146961231,-29.231167456640026,-29.367035800790706,-29.509278165404112,-29.65697844678008,-29.809339787296175,-29.965667349803223,-30.125353892252789,-30.287867634797614,-30.452742013102757,-30.619566990980488,-30.787981667922352,-30.957667966543145,-31.128345224305615,-31.299765545386965,-31.47170979387711,-31.643984129968697,-31.816417007418469,-31.988856564112751,-32.161168348668483,-32.333233335127019,-32.504946185329985,-32.676213724806914,-32.846953603191984,-33.017093114515667]],"type":"surface","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-normal-gradient-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;17.2: Gradient of <span class="math inline">\((\mu, \sigma^2)\)</span> from a normal model.
</figcaption></figure>
</div>
</div>
<p>Now, flip it upside-down.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">grid_minuslogdensity</span> <span class="op">&lt;-</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/outer.html">outer</a></span><span class="op">(</span><span class="va">mu_grid</span>,</span>
<span>    Y <span class="op">=</span> <span class="va">sigma2_grid</span>,</span>
<span>    FUN <span class="op">=</span> <span class="va">lp_mu_sigma</span></span>
<span><span class="op">)</span></span>
<span><span class="fu">plot_ly</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="op">~</span><span class="va">sigma2_grid</span>, y <span class="op">=</span> <span class="op">~</span><span class="va">mu_grid</span>, z <span class="op">=</span> <span class="op">~</span><span class="va">grid_minuslogdensity</span>,</span>
<span>    type <span class="op">=</span> <span class="st">"surface"</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-normal-negative-gradient" class="cell-output-display quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-normal-negative-gradient-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="plotly html-widget html-fill-item" id="htmlwidget-c09638fa01b8711be2e3" style="width:100%;height:650px;"></div>
<script type="application/json" data-for="htmlwidget-c09638fa01b8711be2e3">{"x":{"visdat":{"122bcc36a19088":["function () ","plotlyVisDat"]},"cur_data":"122bcc36a19088","attrs":{"122bcc36a19088":{"x":{},"y":{},"z":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"surface"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"sigma2_grid"},"yaxis":{"title":"mu_grid"},"zaxis":{"title":"grid_minuslogdensity"}},"hovermode":"closest","showlegend":false,"legend":{"yanchor":"top","y":0.5}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"colorbar":{"title":"grid_minuslogdensity","ticklen":2,"len":0.5,"lenmode":"fraction","y":1,"yanchor":"top"},"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666667","rgba(70,19,97,1)"],["0.0833333333333333","rgba(72,32,111,1)"],["0.125","rgba(71,45,122,1)"],["0.166666666666667","rgba(68,58,128,1)"],["0.208333333333333","rgba(64,70,135,1)"],["0.25","rgba(60,82,138,1)"],["0.291666666666667","rgba(56,93,140,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.375","rgba(46,114,142,1)"],["0.416666666666667","rgba(42,123,142,1)"],["0.458333333333333","rgba(38,133,141,1)"],["0.5","rgba(37,144,140,1)"],["0.541666666666667","rgba(33,154,138,1)"],["0.583333333333333","rgba(39,164,133,1)"],["0.625","rgba(47,174,127,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.708333333333333","rgba(79,191,110,1)"],["0.75","rgba(98,199,98,1)"],["0.791666666666667","rgba(119,207,85,1)"],["0.833333333333333","rgba(147,214,70,1)"],["0.875","rgba(172,220,52,1)"],["0.916666666666667","rgba(199,225,42,1)"],["0.958333333333333","rgba(226,228,40,1)"],["1","rgba(253,231,37,1)"]],"showscale":true,"x":[0.5,0.57999999999999996,0.66000000000000003,0.73999999999999999,0.82000000000000006,0.90000000000000002,0.97999999999999998,1.0600000000000001,1.1400000000000001,1.22,1.3,1.3799999999999999,1.46,1.54,1.6200000000000001,1.7,1.78,1.8600000000000001,1.9399999999999999,2.02,2.1000000000000001,2.1799999999999997,2.2599999999999998,2.3399999999999999,2.4199999999999999,2.5,2.5800000000000001,2.6600000000000001,2.7400000000000002,2.8199999999999998,2.8999999999999999,2.98,3.0600000000000001,3.1400000000000001,3.2200000000000002,3.3000000000000003,3.3799999999999999,3.46,3.54,3.6200000000000001,3.7000000000000002,3.7800000000000002,3.8599999999999999,3.9399999999999999,4.0199999999999996,4.0999999999999996,4.1799999999999997,4.2599999999999998,4.3399999999999999,4.4199999999999999,4.5],"y":[2,2.04,2.0800000000000001,2.1200000000000001,2.1600000000000001,2.2000000000000002,2.2400000000000002,2.2800000000000002,2.3199999999999998,2.3599999999999999,2.3999999999999999,2.4399999999999999,2.48,2.52,2.5600000000000001,2.6000000000000001,2.6400000000000001,2.6800000000000002,2.7199999999999998,2.7599999999999998,2.7999999999999998,2.8399999999999999,2.8799999999999999,2.9199999999999999,2.96,3,3.04,3.0800000000000001,3.1200000000000001,3.1600000000000001,3.2000000000000002,3.2400000000000002,3.2800000000000002,3.3200000000000003,3.3600000000000003,3.4000000000000004,3.4399999999999999,3.48,3.52,3.5600000000000001,3.6000000000000001,3.6400000000000001,3.6799999999999997,3.7199999999999998,3.7599999999999998,3.7999999999999998,3.8399999999999999,3.8799999999999999,3.9199999999999999,3.96,4],"z":[[67.246490254351897,58.868941744966541,52.807443758614525,48.279856884748312,44.815353751372157,42.11442252485638,39.977978630638376,38.268869704084466,36.88975779594,35.769805715008367,34.85634338974387,34.109474675683245,33.498485271583533,32.999389496075366,32.593217476619323,32.26479565743071,32.001863239199061,31.794421883765303,31.63425026492618,31.514536982109799,31.429599699416308,31.37466793402773,31.345713401908956,31.339316295836998,31.352558993583258,31.382940906634829,31.428309767116254,31.486805802504673,31.556816092761494,31.636937030652327,31.725943274366276,31.822761934947167,31.926451009933928,32.036181280787808,32.151221050946667,32.270923225223953,32.39471432825858,32.522085136130428,32.652582655808665,32.785803235355331,32.921386626468035,33.05901085207816,33.198387756911693,33.339259139398159,33.48139338003314,33.624582495009939,33.768639555222705,33.913396420071763,34.058701743240093,34.204419214051704,34.35042600340455],[64.575306334351893,56.566196986345858,50.783819576796347,46.475002884748307,43.186583068445337,40.630431458189712,38.615129691862862,37.008877288990121,35.71818590120315,34.675058206811649,33.828964958974638,33.141654414813679,32.58369625788491,32.132121989581854,31.768777995137842,31.479153328018946,31.251530677401313,31.076361690216913,30.945800801008655,30.853352843495941,30.793603527987738,30.762011071642412,30.754743508103644,30.768550500965201,30.800661489451024,30.848704122634832,30.910638464790672,30.984703561903167,31.069373771593611,31.16332286043956,31.265394322642138,31.374576713470656,31.489983049149615,31.610833522826027,31.736440939145425,31.866198388860319,31.999568777962722,32.136075899136209,32.275296791401885,32.416855180106708,32.560415826468038,32.705679645728956,32.852379477118944,33.000276408433692,33.149156574062985,33.298828358424572,33.449119947567198,33.599877180635147,33.750961660290777,33.902249087354868,34.053627790071218],[62.00335441435189,54.348997055311372,48.835371152553918,44.737197533396952,41.618319702591677,39.201569280411931,37.302909324515923,35.795692421065588,34.590136813483852,33.620979551073944,32.839752682051568,32.209787777132519,31.702890805830108,31.29707266490653,30.974965674150187,30.722696880960122,30.52907227290693,30.384976765485732,30.282926594823088,30.216731081119701,30.181234023225834,30.172113842284613,30.185727596599218,30.218988124896825,30.269266464657633,30.33431373863483,30.412198170217028,30.50125395288061,30.600039479622808,30.707303016467929,30.82195433643524,30.943041156423675,31.069729467450269,31.201287038749594,31.337069522996359,31.476508704011835,31.619102517607693,31.764406546535056,31.912026746204152,32.061613202206161,32.212854756197764,32.365474365305673,32.519225083336565,32.673886570870238,32.829262056650052,32.985175685253843,33.141470196371031,33.29800488955533,33.454653835405985,33.611304300024557,33.76785535451566],[59.530634494351894,52.217341951863098,46.962098485887253,43.066440830694255,40.110563653811184,37.827835991523045,36.04131752859756,34.629315100310876,33.5056105327821,32.607569747795253,31.88870655897464,31.31387476263977,30.856068915419151,30.494241522049393,30.211780513656358,29.995426316254239,29.834488025715913,29.720267109571751,29.64562764636948,29.604671694981086,29.592491185130598,29.604976245954337,29.638665667395678,29.690629167631865,29.758373919203095,29.83976975463483,29.932988883395325,30.036456975437002,30.148813216849085,30.268877498737432,30.395623315745585,30.528155263806227,30.665690264835888,30.807541828558513,30.953106802499462,31.1018541706785,31.253315547193495,31.407077078326964,31.56277252021545,31.720077301653671,31.878703415657224,32.038395010808316,32.19892457556454,32.360089626707797,32.521709827794332,32.683624475497744,32.845690301634185,33.007779546832325,33.169778268585709,33.33158485206075,33.493108696737877],[57.157146574351898,50.171231676001028,45.164001576796352,41.462732776640202,38.663314922103872,36.509231591523047,34.830354304107765,33.50974532672597,32.464607059097887,31.634828796975579,30.975826589743871,30.45391537133542,30.04323058665203,29.723628561010429,29.47922251365636,29.297341633901297,29.167777935828276,29.082232722474977,29.03390395564783,29.017174685080096,29.027375013702024,29.060598282651586,29.113557720493024,29.183473629170326,29.267983853087387,29.365072170634829,29.473010604325555,29.590312629572342,29.715694983272442,29.848046307248069,29.986401260573171,30.129919035618308,30.277865441306478,30.429597892252779,30.584552777654743,30.742234788860319,30.902207866720119,31.064087494511931,31.227534113435787,31.392247478449253,31.557961804846414,31.724441582236892,31.891477953802884,32.058885575946377,32.22649988749582,32.394174729156283,32.561780263356674,32.729201152466132,32.89633495982995,33.063090743463469,33.229387816737884],[54.882890654351897,48.210666227725163,43.4410804252812,39.926073371234793,37.27657350746972,35.245756080411937,33.670019651046537,32.436983100310869,31.467126392431222,30.702756698614927,30.101112774359258,29.629909603219478,29.264375819528745,28.985233781789653,28.777291674150188,28.628442833901296,28.528942003244005,28.470873604195404,28.447755522658142,28.454240051416729,28.485885508940122,28.538979952376355,28.610403755891255,28.69752150951221,28.79809626631053,28.91022098663483,29.032263333007727,29.162820915286627,29.300684778892879,29.444809441999844,29.594288170917999,29.748332471859918,29.906254996862032,30.067455229832397,30.2314074484622,30.397650558557288,30.565779476187572,30.735437795089972,30.906311525865167,31.0781237325929,31.250629923765331,31.423614079591388,31.596885218051586,31.77027441858597,31.943632235754528,32.116826446229453,32.28974008153849,32.462269706456738,32.634323909138701,32.8058219742327,32.976692714515657],[52.707866734351896,46.335645607035509,41.793335031341798,38.456462614478035,35.95033940990875,34.037409458189714,32.560313569413886,31.411028421065588,30.513168532782096,29.811353452713284,29.264565112820794,28.84185745829194,28.519504614049289,28.279057184387053,28.105987995137841,27.988729916254236,27.917980227963106,27.886189754733039,27.887182347400408,27.915867793990987,27.968022670844881,28.04012125512865,28.129203773590369,28.232772808657508,28.348711158872511,28.475216202634829,28.610747069441835,28.753981832579857,28.903782603710397,29.05916690299275,29.219284046780068,29.383395572531057,29.550858931502557,29.721113841297367,29.893670814921826,30.06810147976941,30.244030375595855,30.421127980061065,30.599104757503586,30.777706064084612,30.956707772413981,31.135912502871811,31.315146368310653,31.49425615462658,31.67310687257045,31.851579626717253,32.02956975617964,32.206985208804156,32.383745116511975,32.559778544368442,32.735023390071213],[50.632074814351895,44.54616981393206,40.220765394978166,37.053900506369928,34.68461262942094,32.884191724856379,31.501236059209802,30.43188128899012,29.602733480150519,28.960619059270662,28.466183605128485,28.089758936552812,27.808616970213677,27.605098768802637,27.465311476619323,27.378202880960121,27.33489260998558,27.328181174087881,27.352184429874633,27.402057912802867,27.47378649941631,27.564022190908464,27.669957773590369,27.789227526606226,27.919828530773337,28.060057818634828,28.208461813627881,28.363795381452039,28.524988457724998,28.691118690226794,28.861388888159379,29.03510833763173,29.211677245228046,29.390573726647684,29.571342877033629,29.753587552496683,29.936960564944968,30.121158049425226,30.305913808351043,30.490994472924388,30.676195350792359,30.861336852078161,31.046261404580086,31.230830784068203,31.414923797943587,31.598434270619691,31.781269287280118,31.963347659508383,32.144598581949765,32.324960453870709,32.50437984340455],[48.655514894351917,42.842238848414837,38.723371516190305,35.718387046910486,33.479393166006325,31.786102880411946,30.492787120434308,29.499541704084468,28.735821234536495,28.150553518287065,27.705968251282339,27.373614038002096,27.131712888021902,26.963358535036413,26.855262118594638,26.796861728018953,26.779679149311427,26.796847862259931,26.842761770080827,26.91281040785238,27.00317699465441,27.110682759715811,27.232665755891258,27.366885663358367,27.511448382013015,27.664745834634832,27.825407565565868,27.99226156190317,28.164302340936679,28.340664803701973,28.520602695055935,28.703470767161935,28.888709938038506,29.075834885883356,29.264423634797602,29.454108776739112,29.644570044234918,29.835528003182461,30.026738678407543,30.217988959112237,30.40909265890047,30.599887127210437,30.790230326859881,30.979998306910847,31.169083011873937,31.357390377936774,31.54483867483993,31.731357058569419,31.916884305452072,32.101367702739488,32.284762074515655],[46.778186974351911,41.223852710483797,37.301153394978179,34.449922236099674,32.334681019664856,30.743142924856389,29.534966753087364,28.614009666348618,27.912431795940002,27.381156829762475,26.983919051282339,26.693422762639777,26.488792367473955,26.353836483088358,26.275839921063774,26.244706457430716,26.252339845940639,26.292189819249174,26.358914368018969,26.448125279139507,26.556194156559172,26.68010296155067,26.817327720493029,26.965747218913922,27.123570712591523,27.289280250634835,27.461584325255792,27.639380373933246,27.82172425334544,28.007805243418286,28.196925467469725,28.388482861121666,28.58195700993393,28.776897319004373,28.972913088213751,29.169665152496684,29.366858813465683,29.564237841332748,29.761579367673079,29.95868952264815,30.155399696738307,30.351563328268639,30.547053135150037,30.741758723154501,30.935584514361494,31.12844794866848,31.32027791885907,31.51101340598726,31.700602287018892,31.889000290974781,32.076170083404548],[45.000091054351913,39.691011400138976,35.954111031341817,33.248506073937513,31.250476190396565,29.755311858189721,28.627774957168999,27.775285175782582,27.132565164361054,26.652428993696901,26.300036005128494,26.049185110465864,25.879855408569846,25.776532612958491,25.727044884026739,25.72173706919542,25.752874699873225,25.814207045055625,25.900642223689072,26.00800252666426,26.1328379851306,26.272282796413055,26.423943667395683,26.585812193272897,26.756195522508882,26.933661066634834,27.116992092697654,27.305151817542271,27.497254194951278,27.692540009375733,27.890357205400761,28.09014461951093,28.291418460914322,28.493761026010745,28.696811237282077,28.900256679769413,29.103826872637285,29.307287563876102,29.510435876147657,29.713096163532128,29.915116464305875,30.116365455252762,30.316729829450555,30.516112032799171,30.714428305406273,30.911606982814817,31.107587019337537,31.302316701761907,31.495752526650229,31.68785821857659,31.878603870071213],[43.321227134351915,38.243714917380352,34.682244425281212,32.114138560423996,30.226778678201441,28.822609680411944,27.771211732679202,26.983368232386354,26.396221339799652,25.964370010090342,25.654319112820801,25.440901081480355,25.304902011309572,25.2314469246468,25.20887700748353,25.227953563313065,25.281283711109182,25.362899539679283,25.467945337091134,25.592442150426635,25.733108480368696,25.887222264302963,26.052513596599223,26.227080586435289,26.40932281176508,26.597888282634834,26.791630867891449,26.98957589273024,27.1908921657542,27.394869101574315,27.600897908849035,27.80845604232972,28.017094290979681,28.226426006902464,28.436118082002572,28.645883358557292,28.855474221749709,29.064677170812516,29.27330820383127,29.481208881764172,29.688242961603173,29.894293508162818,30.099260409761435,30.303058235844855,30.505614385008265,30.706867480375792,30.906765976275334,31.105266945893362,31.302335024346082,31.497941485544917,31.69206343451566],[41.741595214351918,36.88196326220794,33.485553576796363,31.04681969555913,29.263588483079491,27.945036391523054,26.965277079617977,26.23825883615994,25.703400322255792,25.316979878942803,25.046768374359264,24.868570675683252,24.763932175693135,24.718579418153293,24.721336291434145,24.763355939783658,24.837566879648506,24.938267303120142,25.060823708225158,25.201444150426635,25.357005642273457,25.524921365220393,25.703037508103648,25.889552398401101,26.082952580360121,26.281961898634833,26.485500650837189,26.692652599497155,26.902638165754198,27.114792520014031,27.328547577814554,27.543417129578042,27.758984500130008,27.974892261679535,28.190833622375244,28.406545188860321,28.621800860802963,28.836406662141997,29.050196350723926,29.263027677344283,29.474779188630201,29.685347486998801,29.89464487608268,30.102597332291555,30.309142753167464,30.514229441351404,30.717814789672467,30.919864138381627,31.120349780106448,31.319250091879759,31.516548776737881],[40.261195294351914,35.605756434621732,32.364038485887271,30.046549479342914,28.360905605030712,27.122591991523056,26.209970997985323,25.539956987103338,25.054102111729478,24.710258600254278,24.477383789743879,24.332193893074557,24.256945901720531,24.237930093477971,24.26442273587859,24.327944198607184,24.421724205491202,24.540310335378209,24.679277337091136,24.835008526664261,25.004529470844886,25.18538009916535,25.375515401908959,25.573227629170333,25.777084828294008,25.985881914634835,26.198601441534862,26.414381937843022,26.632492194951279,26.852310264694882,27.073306212297311,27.295027881255894,27.517089088365303,27.739159790341954,27.960957858400086,28.182242170678503,28.402806789797047,28.622476037864537,28.841100316825621,29.058552550272459,29.274725145386956,29.489527391760703,29.702883228414283,29.914729322139273,30.125013409883884,30.333692865741646,30.540733459528923,30.746108279226696,30.949796793931334,31.151784037581116,31.352059896737881],[38.880027374351911,34.415094434621736,31.317699152553939,29.11332791177535,27.518730044055104,26.355276480411945,25.505293487781245,24.888462685216545,24.448326708220705,24.14420617402477,23.946165358974646,23.831770733654267,23.783943189391763,23.789498950620825,23.83813634081686,23.921718339783659,24.033755688637271,24.169028636453476,24.323306223689073,24.493135279139508,24.675679966082981,24.868598466137826,25.069947278015153,25.278106278742982,25.491719555566732,25.709648330634835,25.930933239984473,26.154763907767833,26.380454253345441,26.607422335616867,26.835173812297313,27.063288297363279,27.291408055685565,27.519228592889725,27.746490790077111,27.972974304011839,28.198492008731954,28.422885297980145,28.646020102136358,28.8677835005487,29.088080831873445,29.306833222448532,29.523975466756255,29.739454205388004,29.953226355157518,30.165257753546527,30.375521985844713,30.583999368428575,30.790676065820733,30.995543322648988,31.198596794515659],[37.598091454351916,33.309977262207937,30.346535576796363,28.24715499285643,26.737061800152663,25.643089858189722,24.851244549005735,24.283775930499562,23.886074111729478,23.618822600254276,23.453113082051573,23.367301197422385,23.344924038706832,23.373285989581866,23.442477106248958,23.544678363313068,23.673661329086709,23.82442220634595,23.992910368018968,24.175824407852378,24.370457127987741,24.574576466137827,24.786333136422233,25.004188347119051,25.226856762178301,25.453261146634834,25.682496046186024,25.913798509271594,26.146524340936679,26.380128732779987,26.614150377814553,26.848198377900189,27.081941402090795,27.315098669322847,27.547432417406299,27.778741588860321,28.008856517607697,28.237634442488819,28.464955706656131,28.69072052817301,28.91484624808966,29.137264979062287,29.357921591108585,29.576771982037751,29.793781588988359,30.008924104766038,30.222180368619835,30.433537405987259,30.642987595774652,30.850527947083378,31.056159470071215],[36.415387534351915,32.290404917380357,29.450547758614547,27.448030722586161,26.015900873323396,24.98603212485639,24.247824181658796,23.725896722952392,23.367344322255793,23.134107878942803,22.998226958974648,22.938785284378906,22.939888449665737,22.989291210361088,23.077445032174886,23.196824269195421,23.34144112683952,23.506491045055629,23.688089770080826,23.883075912802873,24.088860956559174,24.303314099165348,24.524672977130194,24.751473834298537,24.982496448128714,25.216720362634835,25.453289860139513,25.691485742354299,25.930702457725001,26.170429456184245,26.410235908849039,26.649758122866633,26.888689127580989,27.126770019641317,27.36378274038767,27.59954402522396,27.833900316424263,28.066723471390553,28.297907130384946,28.527363633145388,28.755021394035605,28.98082266160197,29.204721601471281,29.426682652088513,29.646679111376422,29.864691919400187,30.080708607854284,30.294722391902752,30.506731383793085,30.716737910884284,30.924747923404549],[35.331915614351914,31.356377400138975,28.629735698008485,26.715955100964539,25.3552472635673,24.384103280411946,23.695032385740426,23.214825062575034,22.892137339799653,22.690062010090344,22.581506989743879,22.546222994523834,22.568836422268475,22.637514612958491,22.743040118594639,22.878156057430715,23.0370950818957,23.215235152582508,23.408844429874641,23.614889793990994,23.830891451797267,24.054811365220395,24.284966800139046,24.519962740281443,24.758638613417972,25.000025978634834,25.243314681844939,25.487825607015953,25.732988603710403,25.978324505829633,26.223430405400762,26.467967532262605,26.711651232156154,26.954242643845138,27.195541759021204,27.435381613102745,27.673623405181658,27.910152384685347,28.144874373322796,28.377712815465831,28.608606269711281,28.837506270067578,29.064375497844335,29.289186215540287,29.511918922321698,29.732561197448966,29.951106703548064,30.167554326175054,30.381907429876033,30.594173214051704,30.804362154515658],[34.347675694351928,30.507894710483814,27.884099394978193,26.050928127991575,24.755100970884381,23.837303324856396,23.192869161250638,22.750560949367493,22.460453164361063,22.286684993696905,22.202953174359269,22.189614327857171,22.231767956515057,22.31795619737408,22.439262365508224,22.588673728018954,22.760623194255253,22.950654528926599,23.155174347400418,23.37126605141674,23.596548613702033,23.829068264302968,24.067214605448783,24.309655065067773,24.555283258046074,24.803177994634837,25.052570511302306,25.302818103256556,25.553382778892889,25.80381388171616,26.053733867469727,26.302826606088111,26.550827715816286,26.797516541934314,27.042709473306921,27.286254352496687,27.52802578387989,27.767921182373208,28.005857435469693,28.241768075134338,28.47560087511669,28.707315804459114,28.936883280227757,29.164282672393082,29.389501021824188,29.612531938912383,29.833374655701174,30.052033208804161,30.268515734023502,30.482833856585643,30.695002163404549],[33.462667774351928,29.744956848414848,27.213638849523647,25.452949803667249,24.215461995274623,23.345632258189731,22.741334508189414,22.333104383329758,22.072291795940011,21.923976829762481,21.862565512820808,21.86895928437891,21.928683052405468,22.030615963607843,22.166111772915631,22.328377280960133,22.512025463918171,22.71274917408789,22.927079522658147,23.152204685080108,23.385832442273461,23.62608479641306,23.871416393059405,24.120550808657512,24.372430382013015,24.626176410634837,24.881057348511607,25.136463231076107,25.391884983272448,25.64689758384382,25.901146295055938,26.154335344343146,26.406218578561383,26.656591713908835,26.905285883244808,27.15216224340578,27.397107452518938,27.640029864454135,27.880856316825625,28.119529412150914,28.356005210251823,28.590251264776576,28.822244948621538,29.05197202264689,29.279425409883885,29.504604143790431,29.727512464313616,29.948159039790077,30.166556296235484,30.382719838486093,30.596667950071218],[32.676891854351929,29.06756381393209,26.618354061644858,24.922020127991573,23.736330336738039,22.909090080411953,22.340428426556759,21.962455364461832,21.727653234536501,21.60193751828707,21.560344005128499,21.584257864089054,21.659581709939715,21.775493911659794,21.923588340816863,22.097266716254246,22.291301890884466,22.501519088066384,22.724559955647841,22.957705694981094,23.198742937511554,23.445860961550672,23.697572162970907,23.952649971050676,24.210079985318799,24.469021226634837,24.728775193472849,24.988760990474603,25.24849521684909,25.507575612212616,25.765667688159382,26.02249374702771,26.27782382039145,26.531468159768707,26.783270988834872,27.033105285830022,27.280868411098822,27.526478430928123,27.769871017390596,28.010996826515555,28.249819275116689,28.486312651019965,28.720460503025684,28.952254266301711,29.181692086500803,29.408777812083116,29.633520129385385,29.855931819132799,30.076029116511979,30.293831159753061,30.509359514515662],[31.990347934351931,28.475715607035539,26.098245031341829,24.458139100964548,23.317705995274626,22.527676791523064,21.990150916352679,21.638613892763722,21.426537480150536,21.32056705927068,21.296288651282346,21.335510066987606,21.424463929117795,21.552590041529925,21.711692069211928,21.895342033901308,22.098452475154129,22.316964270862083,22.547615646369486,22.787769081119709,23.035280099416319,23.288396759715813,23.545681915183295,23.805952552247259,24.068232067963429,24.331712442634839,24.595724046186028,24.859711381452048,25.123213479622816,25.385847966822546,25.647298046780072,25.907301814141803,26.165643441306482,26.422145879513931,26.676664790077112,26.929083479769414,27.179308659619529,27.427266881795177,27.672901537164606,27.916170318228261,28.157043069711282,28.395499963189273,28.631529943440192,28.86512940335755,29.096301051674935,29.325052943790432,29.551397650916485,29.775351546832329,29.996934194852994,30.216167820386545,30.433076856737884],[31.40303601435193,27.969412227725194,25.653311758614556,24.061306722586171,22.959588970884383,22.201392391523065,21.690501977577171,21.361579968235418,21.168944532782113,21.0798654527133,21.070399451282345,21.122715893074563,21.223329709939712,21.361904353218236,21.530422958100814,21.72260323390131,21.933477216727162,22.159084722474987,22.396246594823097,22.642394843495946,22.895443927987749,23.153692190908473,23.415745649696571,23.680458552247259,23.946886629946903,24.214250058634839,24.481903906651144,24.749314404008437,25.016039771593618,25.281714647673606,25.546037370918004,25.80875954568543,26.069677441306482,26.328624873144506,26.585467286971522,26.840096825223959,27.092428198081073,27.342395217055291,27.589947876147658,27.835049887289035,28.077676594035609,28.317813201284515,28.555453269865062,28.790597433814401,29.023252305406274,29.253429538912378,29.481145028906916,29.706418222888669,29.929271531258525,30.149729820386547,30.367819976737884],[30.914956094351929,27.548653676001056,25.283554243463044,23.731522992856441,22.661979263567307,21.930236880411954,21.44148161023023,21.131353590876927,20.95487439243124,20.879832698614941,20.8826764051285,20.945875342349925,21.056179052405469,21.203436846724728,21.379781007483533,21.57905031625425,21.796376115603568,22.027880442905094,22.270452801008666,22.521582982109809,22.779234423225844,23.041747255128655,23.307763366510731,23.57616797105068,23.846043671269214,24.116634074634838,24.387314774868198,24.657570058143776,24.926974092761501,25.195175654765805,25.461885660573177,25.726866941658582,25.989925820391452,26.250905140660429,26.509678479518101,26.766145322193658,27.02022702648344,27.271863436708472,27.521010034339749,27.767635533697874,28.011719848089662,28.253252365305677,28.492230482300297,28.72865835767227,28.962545847694834,29.19390759744897,29.422762263356677,29.649131847301813,29.87304112572857,30.094517159753064,30.313588874515663],[30.526108174351933,27.213439951863126,24.988972485887285,23.468787911775358,22.424876873323406,21.71421025818973,21.243089814311865,20.947934760688248,20.784327059097905,20.720468796975595,20.733119512820807,20.804988414813693,20.923011956515058,21.077187522049403,21.259766217360074,21.464683280960131,21.687149171783343,21.923351432152408,22.17023426492619,22.425333496961294,22.686651585130605,22.952561952376364,23.221735065625776,23.493080808657517,23.765703191930371,24.038864490634836,24.311956650837192,24.584478343858063,24.856016443126464,25.126230988099142,25.394842915745592,25.661624002061266,25.926388578561387,26.188986682061703,26.449298367716864,26.707228970678507,26.962705144826636,27.215671540754713,27.466088011740879,27.713927257454781,27.959172831873445,28.201817455252765,28.441861580745893,28.679312174931152,28.914181678540601,29.146487119400184,29.37624935426577,29.603492420071767,29.828242978263134,30.050529838486096,30.270383550071216],[30.23649225435193,26.963771055311405,24.769566485887285,23.273101479342927,22.248281800152675,21.553312524856398,21.095326589822069,20.811323477669383,20.657302532782118,20.601773747795271,20.621728774359269,20.700055110465868,20.823828422268484,20.983156379192259,21.170378587730447,21.379502128018956,21.605796385266487,21.845497690216924,22.095590986575676,22.353646388050404,22.617695413702034,22.886136282651592,23.157660747041703,23.431197065067771,23.705865191930371,23.98094130663484,24.255829534558121,24.530039261151295,24.80316682268851,25.074880647673609,25.344909136435248,25.613030726893481,25.879065715816289,26.142869497348325,26.404326951567796,26.663347770678506,26.919862553110654,27.17381952919402,27.425181808351049,27.673925058559753,27.920035545386959,28.16350847112578,28.404346565201852,28.64255888559105,28.878159797943589,29.111168104766044,29.34160630163419,29.569499941198529,29.794877088862211,30.017767856585643,30.238204003404551],[30.046108334351935,26.799646986345888,24.625336243463046,23.144463695559146,22.132194044055115,21.447543680411954,20.998191936760843,20.721519741820327,20.573800813483871,20.52374755107396,20.548504189743888,20.631075429306449,20.758628449665743,20.921343418153299,21.111618118594645,21.323506857430722,21.552317756053007,21.794319217098646,22.046522965957116,22.306521655377136,22.572365908940128,22.842470245954345,23.11554041075852,23.390516740281448,23.666529671269217,23.942864522634835,24.21893342603099,24.494252810023475,24.768425231447633,25.041124633489211,25.312084322642143,25.581087116155228,25.847957232156158,26.112553586520303,26.374764231070898,26.634501722193658,26.89169925133551,27.146307402026387,27.398291424170257,27.647628937012794,27.894307988630203,28.138325412924729,28.379685435668172,28.618398489651966,28.854480205903791,29.087950553546527,29.318833105461941,29.547154410682097,29.772943457525805,29.996231214051704,30.217050234515661],[29.954956414351933,26.721067744966579,24.55628175861456,23.08287456042401,22.076613605030726,21.396903724856401,20.951685855128193,20.678523553141083,20.533821901203169,20.486390206811663,20.513445758974655,20.598049371335435,20.727412038706838,20.891748638932523,21.083484809952672,21.296697469195429,21.526713284142893,21.76981601279757,22.023030203070519,22.283959298941493,22.550663070844891,22.821563842284618,23.095374056776219,23.371039834298543,23.6476966299469,23.924634138634836,24.201268325255796,24.477118990474604,24.751791669403836,25.024962945545948,25.296368474366282,25.565793169846504,25.833063127580992,26.098038949577628,26.360610206226177,26.62069082522396,26.878215239501188,27.133135159251822,27.385416859198507,27.635038892813899,27.881990161603177,28.12626828064959,28.367878192144858,28.606830987113895,28.843142902421199,29.076834465741648,29.307929765749023,29.536455828522474,29.762442084253916,29.985919910884284,30.206922243404552],[29.96303649435194,26.728033331173478,24.562403031341837,23.088334073937524,22.081540483079507,21.401392658189735,20.955808344924112,20.682334911631649,20.537365795940012,20.489701715008387,20.516553482051581,20.600976936552826,20.73017918939177,20.894372041529927,21.085978661804525,21.299073963313077,21.528982969536152,21.771988077313701,22.025112697915883,22.285959318743473,22.552586899416319,22.823417071642417,23.097161685094804,23.372766347119054,23.649366067963431,23.926250154634836,24.20283423223254,24.478637802504679,24.753266136557123,25.026395583843822,25.29776159160766,25.56714888796731,25.834383402090797,26.099325586520301,26.361864877033632,26.621915079769416,26.879410517607695,27.134302800870323,27.386558113435793,27.636154925963069,27.883082064305878,28.127337074300385,28.368924834631905,28.607856377976841,28.844147887495829,29.077819841351406,29.308896282495436,29.537404194719656,29.763372969046543,29.98683394708338,30.207820030071218],[30.070348574351939,26.820543744966582,24.643700061644868,23.16084223609969,22.14697467820146,21.461010480411957,21.010559406148602,20.732953817292028,20.584432497694401,20.533682075664125,20.557827358974656,20.639858124958625,20.766929901720538,20.929213625945511,21.119099674150203,21.330636339783666,21.559126812232783,21.800835410647032,22.052770450493203,22.312521714783077,22.578137394654416,22.848029934027743,23.120903295714271,23.395696278742989,23.671537985318803,23.947712570634838,24.223631146961225,24.498809246113701,24.77284863290749,25.045422548382831,25.316263674366283,25.585154270517645,25.851918055685569,26.116413497348329,26.378528243493257,26.638174485830024,26.89528508565504,27.149810326881884,27.401715186882122,27.650977036460308,27.897583696738312,28.141531793877107,28.382825363129314,28.6214746622408,28.857495161127666,29.090906680375795,29.321732655701176,29.549999509273647,29.775736111903687,29.99897332264899,30.219743594515663],[30.27689265435194,26.998598986345893,24.800172849523655,23.300399046910503,22.272916190396582,21.575757191523071,21.115939038801663,20.830380270122216,20.675022006466332,20.618331288778879,20.63726738974389,20.714692936552829,20.837664175693142,20.996273392179276,21.182847846989709,21.391384598607196,21.617144812232784,21.856358012797571,22.106003460802484,22.363646487060308,22.627314556559178,22.895402429440587,23.166598888634628,23.43982962917034,23.714212382013017,23.989021386634839,24.263659069441843,24.537633321301673,24.810539158454933,25.082043839162971,25.351874722642144,25.619809317497509,25.885667088365309,26.149302682061705,26.410600305605065,26.66946904340578,26.9258389436432,27.179657737286504,27.430888079537489,27.679505224305611,27.925495058900474,28.168852439379755,28.409579777637084,28.647685839905773,28.883184723316724,29.116094982814822,29.346438885366247,29.574241772184447,29.799531512825347,30.022338037581118,30.242692936737885],[30.582668734351941,27.262199055311413,25.031821394978202,23.507004506369963,22.45936501966488,21.745632791523072,21.2719472428833,20.974614270122217,20.809134322255805,20.743649354352652,20.754873574359273,20.825481371335439,20.942382011309583,21.095551340231225,21.277223180323041,21.481318739783667,21.703036969536157,21.938555883765314,22.184811728843719,22.43933363557516,22.700118385130608,22.96553455788095,23.234248463855867,23.505166398401109,23.777389258046078,24.050176602634842,24.322917999674402,24.595110028068589,24.86633771319946,25.136259456184249,25.40459473643525,25.671114028906906,25.935630500130014,26.197993140660429,26.458081063369036,26.715798752496688,26.971072091572196,27.223845032084199,27.474076791401899,27.721739489498983,27.966816150792365,28.209299010808323,28.44918807815522,28.686489910971765,28.921216574062996,29.153384748668479,29.383014971490649,29.610130983452052,29.83475917181152,30.056928091879762,30.276668056737886],[30.987676814351946,27.611343951863141,25.338645698008509,23.780658614478071,22.706321166006344,21.970637280411964,21.478584018393505,21.165655817292031,20.986769445062823,20.909636272385438,20.910645912820815,20.972223429306453,21.081083408569857,21.227047470101358,21.402225674150202,21.600438763313079,21.8168032841429,22.047429023550261,22.289195254616914,22.539583160327634,22.796548880368704,23.058426319348843,23.323852021377991,23.591706586435297,23.861068613417977,24.13117821863484,24.401407937658899,24.671239366414454,24.940244297141067,25.208069399446661,25.474423715745594,25.739068404745833,26.001808290979689,26.262484873144508,26.520970516785184,26.777163613102751,27.030984529442023,27.282372211274946,27.531281322475344,27.77767983204042,28.02154697241399,28.262871508162824,28.501650264683718,28.737886875438768,28.971590713366474,29.202775977936774,29.431460914074382,29.657667143076466,29.881419088862213,30.10274348554492,30.321668954515662],[31.491916894351949,28.046033676001073,25.720645758614573,24.121361371234833,23.013784629420979,22.25077065818974,21.735849365332282,21.403504911631654,21.207927374887387,21.116292042877241,21.104584405128506,21.154919110465876,21.253768367473967,21.390761781789671,21.557855328471192,21.748744669195432,21.958443756053011,22.182977432152413,22.419154038122073,22.664395061317734,22.916606042273465,23.174077713844255,23.435409561200998,23.699450193272902,23.965250448128721,24.232026234634841,24.499128883395333,24.766021336339268,25.032258910279751,25.297473668950207,25.56136166057318,25.823672445014289,26.084200460914328,26.342777879513935,26.599268665853508,26.853563625223963,27.105576257252672,27.355239274858761,27.602501672757832,27.847326251929921,28.089687523765342,28.329569931443245,28.566966337222578,28.801876733306791,29.034307141227174,29.2642686706197,29.491776713117446,29.716850251057686,29.939511263977419,30.159784218576593,30.377695630071219],[32.095388974351948,28.566268227725214,26.17782157679639,24.52911277664024,23.381755409908784,22.586032924856411,22.04374328369963,21.688161553141089,21.472608111729492,21.363616665828065,21.336689051282356,21.3735684148137,21.460436888021913,21.586694275296164,21.74411214328601,21.926236457430726,22.127958385266496,22.345201109571768,22.574688079359184,22.813769338545455,23.060289870844898,23.312488741367194,23.568921083324895,23.828397218913928,24.089934762178309,24.35272065063484,24.616080836883707,24.879455937843026,25.142381552615518,25.404472264694888,25.665408570918007,25.924926149712277,26.182807009933939,26.438872159768714,26.692975510574009,26.944998788860328,27.19484727500415,27.442446222835642,27.687737842249355,27.930678749167491,28.17123780484642,28.409394280649593,28.645136295771803,28.878459484575824,29.109365857645081,29.337862826717263,29.563962368619837,29.787680307395714,30.009035697157145,30.228050290974785,30.444748083404551],[32.798093054351952,29.172047607035559,26.710173152553971,25.003912830694297,23.810233507469764,22.976424080411967,22.40226577349555,22.019625741820334,21.780811655589144,21.651610141237903,21.606959851282355,21.628171342349933,21.701088970213696,21.814844950620838,21.96099611859465,22.13291412801896,22.325347171783349,22.534100055808327,22.755797378328261,22.987705992010802,23.227600366082992,23.473659401917651,23.724386587749674,23.978547663358377,24.235121555566742,24.493261466634841,24.752263798124016,25.011543170925737,25.270612224148365,25.529065186680704,25.78656444678008,26.042829518839795,26.297627938038513,26.55076771390884,26.802091050946679,27.051469104011844,27.298797582696459,27.543993055205583,27.786989830949921,28.027737323753126,28.266197815657232,28.502344555781875,28.736160140331389,28.967635129245878,29.196766862620208,29.423558446229457,29.648017880581563,29.870157312090551,30.089992388401384,30.307541702739492,30.522826314515665],[33.600029134351949,29.863371813932108,27.3177004858873,25.545761533396995,24.299218922103904,23.42194412485641,22.811416834720035,22.397897477669389,22.132538006466334,21.980272469106751,21.915396805128509,21.918727893074568,21.975724614049309,22.075213807763696,22.208507254397119,22.368777680960136,22.550610115603572,22.749674270862087,22.962481935029288,23.186205021713775,23.418537527987752,23.657589695495631,23.901806074475338,24.149901526606236,24.400810828294013,24.653648682634842,24.907677767116265,25.162283035587389,25.416950924878293,25.671252434907654,25.924829288159387,26.177382552396839,26.428663245228055,26.678464541934318,26.926615286971526,27.172974570678509,27.417427180329597,27.65987977196859,27.900257638859525,28.138501975686829,28.374567556197771,28.608420756840069,28.840037870901334,29.069403667316941,29.296510156152543,29.521355529156288,29.743943249002612,29.964281265142194,30.18238133771014,30.39825845387071,30.611930323404554],[34.501197214351947,30.640240848414869,28.000403576796391,26.154658884748347,24.848711653811222,23.922593058189744,23.271196467373098,22.82297676068826,22.527787164361072,22.34960364943462,22.261999912820816,22.245238066987614,22.284343819528765,22.367800846724734,22.486645550693417,22.633827116254256,22.803747216727167,22.991923754733058,23.194741749462278,23.409266427654366,23.63310135655918,23.864279622101137,24.101179543501885,24.342458808657518,24.587002580360128,24.83388229863484,25.082322743860452,25.33167553182799,25.581397654805301,25.831034009375738,26.080203095055939,26.328585250383419,26.575912931502565,26.821962643845144,27.066548218648542,27.309515188860328,27.550736067903557,27.790106373124658,28.027541265978169,28.262972704968597,28.496347026468044,28.727622883824196,28.956769487481647,29.183765098789024,29.408595738242099,29.63125407549775,29.851738473882996,30.070052166550642,30.286202545083412,30.50020054436845,30.712060110071221],[35.501597294351953,31.502654710483835,28.758282425281241,26.830604884748347,25.458711702591714,24.478370880411966,23.781604671454733,23.29486359087694,22.966559129273353,22.759603682221506,22.646769174359278,22.607701864089066,22.626946586652053,22.692606067503956,22.795411007483541,22.928062433901317,23.084758475154135,23.26084850742123,23.452576821627225,23.656890209832586,23.871291851797277,24.093729181734169,24.322506994829318,24.556219509512221,24.793696811765088,25.033962314634842,25.276198728356576,25.51972065964754,25.763952413929388,26.008409910084961,26.252685867469733,26.496437612799525,26.739376996862042,26.981262019641324,27.221889845977735,27.461090958557296,27.698724245418354,27.934672858673792,28.168840712305855,28.40114951159843,28.631536226468043,28.859950936734251,29.086354990072319,29.310719423662121,29.533023608888868,29.75325408525385,29.971403555222707,30.187470016315903,30.401456010521201,30.613367974232702,30.823215674515662],[36.601229374351959,32.450613400139012,29.591337031341851,27.573599533396997,26.129219068445373,25.089277591523079,24.342641446964937,23.813557968235433,23.448853901203179,23.21027256746741,23.069704589743893,23.006119284378919,23.003532915419175,23.049629470101358,23.134803624767493,23.251483633901316,23.393643890884473,23.556448528926609,23.735987151524135,23.929076368248431,24.13310901370204,24.345938374394716,24.565788428457637,24.791183629170341,25.020893522508892,25.253888730634841,25.489305720604637,25.726418419046038,25.964615202250556,26.203380137035314,26.442277605400768,26.680939639645164,26.919055441306487,27.156362669322853,27.392640168959105,27.627701879769418,27.861391712873974,28.093579228615987,28.324155977842576,28.553032395576331,28.780135156197773,29.005404915570232,29.228794378673356,29.450266641936231,29.669793768092845,29.887355558424581,30.102938493021753,30.316534814437968,30.528141734023503,30.737760743463472,30.945397016737886],[37.800093454351959,33.484116917380391,30.499567394978214,28.383642830694299,26.860233751372206,25.755313191523079,24.954306793903715,24.379059892763735,23.974671480150548,23.701610305172331,23.530806158974663,23.440490327857184,23.414102805830133,23.438871054516945,23.50482340254527,23.604090716254259,23.730403463918183,23.878723819249188,24.044972739153003,24.225824902901895,24.418552842273471,24.62090720008279,24.831023844386841,25.047351167631881,25.268592712591534,25.493661546634844,25.721643720604639,25.951768810023481,26.183386019768804,26.415944690226805,26.648978308849046,26.882091330920332,27.114948264835899,27.347264592889733,27.578799187592644,27.809347952496694,28.038738470270424,28.266825482951248,28.49348706258834,28.7186213569023,28.942143815657232,29.163984820332139,29.384087653284755,29.602406753611358,29.818906215854042,30.033558495009949,30.246343287280126,30.457246560916843,30.666259715590325,30.873378852060757,31.078604136737887],[39.09818953435196,34.60316526220798,31.482973516190338,29.260734776640245,27.651755751372207,26.476477680411971,25.616600712271065,24.99136936446185,24.544011866115461,24.233616895336265,24.030073882051589,23.91081499452385,23.858656257884931,23.860330820750711,23.905470340816876,23.985883680960143,24.095037194255262,24.227674378388976,24.379533584513826,24.547135813792984,24.727623337511567,24.918635658798387,25.118213242616932,25.324722124896837,25.536794382013021,25.753280762634844,25.973212728356575,26.195771832579872,26.420264866484136,26.646103569659431,26.872787977814561,27.099892686625029,27.327055467450279,27.553967790341961,27.780366901878359,28.006029176739116,28.230764517607703,28.454411621679576,28.676833966543143,28.897916395576331,29.117562204846422,29.335690651019966,29.552234813906519,29.767139758687502,29.980360952172447,30.191862895009947,30.40161793799783,30.609605255752523,30.815809955221663,31.02022230002456,31.222837034515663],[40.495517614351947,35.807758434621761,32.541555394978211,30.204875371234831,28.503785068445367,27.25277105818974,26.329523202066973,25.65048638332977,25.156875059097914,24.80629233795921,24.56750775897466,24.417093284378918,24.337193271583558,24.314008768802658,24.336744439582304,24.396862528018961,24.487545081895707,24.60330020634596,24.739669687606607,24.893009100921695,25.060320499416324,25.239123750541506,25.427356623147904,25.62329650096521,25.825498530773352,26.03274637863484,26.244012743860448,26.458427486715209,26.67525174239654,26.893856775333187,27.113706612297321,27.334343706759256,27.555377049149623,27.77647226167954,27.997343311816245,28.217745552496691,28.437469854885805,28.656337644800956,28.874196689706984,29.09091751159843,29.306390323765338,29.52052240763372,29.733235860538642,29.94446565716466,30.154157977048065,30.362268758424577,30.568762445174862,30.773610898945009,30.976792452917511,31.178291087354875,31.378095710071218],[41.992077694351948,37.097896434621767,33.675313031341844,31.216064614478075,29.416321702591713,28.084193324856408,27.093074263291467,26.356410949367504,25.813261059097911,25.419636633041179,25.143107789743894,24.959325197422395,24.849713846926022,24.799904898672786,24.798645698841565,24.837027257430726,24.907927126839528,25.005601303120152,25.12538104843135,25.263444764288032,25.416644327987754,25.582371475312147,25.758453985979763,25.943074295837008,26.134705158872528,26.332058394634842,26.534043767116266,26.739735772429494,26.948346647506028,27.159204307248078,27.371734212297319,27.585444391323016,27.799913009933938,28.014778006902471,28.229728417406307,28.44449707976942,28.658854482104744,28.872603552315411,29.085575232079865,29.297624704968598,29.508628172413989,29.718480090173408,29.927090793181129,30.13438444904283,30.340297290480905,30.544776085253851,30.747776808811224,30.949263490494307,31.149207208677883,31.347585214051708,31.544380163404554],[43.587869774351958,38.473579262207977,34.884246425281241,32.294302506369974,30.389365653811225,28.970744480411966,27.907253895944528,27.10914306257505,26.513169866115458,26.073649780582166,25.75687397435928,25.53751073365428,25.396217983912326,25.318019210361101,25.29117411859465,25.30637786919543,25.356183329086718,25.434577668711555,25.536667666988052,25.658442803891994,25.796594823225846,25.948378833110315,26.111505331112507,26.284055509512221,26.464414266310541,26.651216810634843,26.843305798124018,27.039696689722728,27.2395495818126,27.442146165404107,27.646870777814563,27.853194740316304,28.060663349803217,28.26888502601075,28.477522218648545,28.686283758557298,28.894918399264505,29.103209344222925,29.310969593661785,29.518037975686831,29.724275750792369,29.929563698639015,30.133799611833979,30.336896134322018,30.538778892470951,30.739384875497748,30.938661028906921,31.13656303040041,31.333054222502767,31.528104680115057,31.721690394515665],[45.282893854351954,39.934806917380392,36.168355576796394,33.439589046910513,31.422916922103909,29.912424524856412,28.772062100026165,27.908682722952413,27.25660148015055,26.768331780582166,26.408806312820818,26.15164989307457,25.976705682542466,25.868351703867596,25.814329698841565,25.804914363313081,25.832313688637282,25.890229303120158,25.973529543276712,26.078003219733578,26.200171985130609,26.337145823936002,26.486510658546134,26.646240141990855,26.814625853087399,26.990221626634842,27.171798836883706,27.358310238594907,27.548860545316252,27.742682349801271,27.939116308849044,28.137594753739123,28.337628068757468,28.53879331900438,28.740724715542953,28.943105588860327,29.145661606365096,29.348155020523507,29.550379774452747,29.752157323753128,29.953333058900476,30.153773233030549,30.35336231649719,30.552000713002222,30.749602783018219,30.946095129156291,31.141415105461945,31.335509518663322,31.528333494392168,31.71984948554492,31.910026403404554],[47.077149934351965,41.481579400139012,37.527640485887304,34.651924236099703,32.516975507469766,30.909233458189746,29.68749887553637,28.755029930499582,28.043555901203181,27.503682633041183,27.098904805128512,26.801742675683272,26.591176942816439,26.450902379192271,26.368112439582308,26.332636739783673,26.336318205491217,26.372556206345962,26.435966677297333,26.522126011812787,26.627375813702042,26.748672447789215,26.88346996828065,27.029628193272906,27.185339919203109,27.349072842634843,27.519522883395336,27.695576419046038,27.876279538016981,28.060812860439572,28.248470805400771,28.438644431591474,28.630807166796686,28.824502885883362,29.019335908089538,29.214962570678512,29.411084103406516,29.607440581217148,29.803805774452748,29.999982749167494,30.195800096738314,30.391108693348009,30.585778907170766,30.77969818508344,30.9727689621227,31.164906846229457,31.356039038476297,31.54610295528304,31.735045024346086,31.922819630341301,32.109388190071222],[48.970638014351962,43.113896710483843,38.962101152553977,35.931308073937544,33.671541409908791,31.961171280411971,30.653564222475147,29.648184685216567,28.874033129273357,28.279702337959215,27.827169451282359,27.487789081480372,27.239631764734249,27.065671236335128,26.952522340816877,26.889544998607199,26.868196879648522,26.881558378388974,26.92397906904991,26.990811180129619,27.078206308940135,27.182958704669947,27.302383260316049,27.434219663358377,27.576556464657649,27.727770458634843,27.886477937658903,28.051495231076114,28.221806559914793,28.396537697319005,28.574934267469736,28.756343773873354,28.940200643920868,29.126013726647695,29.313355796288292,29.501854704011844,29.691185890388766,29.881066026303849,30.071247593661788,30.261514251929924,30.451676864305881,30.641570079591396,30.831049383854705,31.019988550565675,31.208277429784388,31.395820026717267,31.582532827949983,31.768343340259566,31.95318881236452,32.137015114504202,32.319775754515661],[50.96335809435196,44.831758848414879,40.4717375767964,37.277740560424036,34.88661462942099,33.068237991523084,31.670258140842492,30.588146987103357,29.748033164361075,29.096390895336267,28.593600251282361,28.209789110465881,27.922070148295891,27.712658275296167,27.567559402545271,27.475639139783674,27.427949711109196,27.417235819249193,27.437566718534448,27.484058724684076,27.552663470844898,27.640004594578205,27.743250534652333,27.860014552247268,27.988275489451041,28.126314474634842,28.272663999674407,28.426066674685135,28.585441611009681,28.749856860439571,28.918506695055942,29.090692780584764,29.265808500130017,29.443325841297376,29.62278438013923,29.803781988860329,29.985966967311846,30.169031355783623,30.352705232079867,30.536751832040423,30.720963361603179,30.90515739176071,31.089173746549005,31.272871809448922,31.456128186003291,31.638834670619701,31.820896473882996,32.002230673592898,32.18276485844747,32.362435938033613,32.541189096737888],[53.055310174351973,46.635165813932126,42.05654975861458,38.691221695559165,36.162195166006356,34.230433591523088,32.737580630638412,31.574916836159964,30.665556006466339,29.953748305172333,29.398197205128515,28.967742762639794,28.63849209350137,28.391863496075388,28.213223624767494,28.090919163313082,28.01557669987324,27.979588528926612,27.976729625750941,28.001868645476154,28.050747299416329,28.119810117513989,28.206071791289499,28.307012859939576,28.420496993583271,28.544704890634844,28.678081069441848,28.819290749873108,28.967184691301654,29.120770349801276,29.27918808815939,29.441691451725703,29.607630735424138,29.776439229832409,29.94762165964233,30.120744425223968,30.295427334175749,30.471336569656451,30.648178689706985,30.825695489498987,31.003659588630207,31.18187062985595,31.36015199525367,31.538347961733187,31.716321230779414,31.89395077793678,32.071129976275344,32.247764955283039,32.423773162594934,32.599082100929536,32.77362821673789],[55.246494254351973,48.524117607035578,43.716537698008523,40.171751479342959,37.498283019664896,35.447758080411973,33.855531691862907,32.608494232386377,31.626601655589148,30.851774567467416,30.240960312820825,29.761650038002117,29.388897600350688,29.103286898672792,28.889515007483546,28.735385069195438,28.631077845940659,28.568616507421233,28.541467790699397,28.544240942505859,28.572457794654422,28.622375273477292,28.690847030227555,28.7752145864353,28.873220977054345,28.982941706634847,29.102729146961231,29.231167456640026,29.367035800790706,29.509278165404112,29.65697844678008,29.809339787296175,29.965667349803223,30.125353892252789,30.287867634797614,30.452742013102757,30.619566990980488,30.787981667922352,30.957667966543145,31.128345224305615,31.299765545386965,31.47170979387711,31.643984129968697,31.816417007418469,31.988856564112751,32.161168348668483,32.333233335127019,32.504946185329985,32.676213724806914,32.846953603191984,33.017093114515667]],"type":"surface","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-normal-negative-gradient-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;17.3: "Flipped" gradient of <span class="math inline">\((\mu, \sigma^2)\)</span> from a normal model.
</figcaption></figure>
</div>
</div>
<p>Imagine placing a marble on the above surface. With gravity, it is natural that the marble will have a tendency to move to the bottom of the surface. If you place the marble in a higher location, it will have a higher <em>potential energy</em> and tends to move faster towards the bottom, because that energy converts to a larger <em>kinetic energy</em>. If you place it close to the bottom, it will tend to move slower.</p>
<p>For simplicity, let’s consider just one dimension with the following picture:</p>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">lp_sigma</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">sigma2</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">kappa_n</span> <span class="op">&lt;-</span> <span class="va">kappa_0</span> <span class="op">+</span> <span class="va">n</span></span>
<span>    <span class="va">nu_n</span> <span class="op">&lt;-</span> <span class="va">nu_0</span> <span class="op">+</span> <span class="va">n</span></span>
<span>    <span class="va">sigma2_n</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">nu_0</span> <span class="op">*</span> <span class="va">sigma2_0</span> <span class="op">+</span> <span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="va">s2y</span> <span class="op">+</span></span>
<span>        <span class="va">kappa_0</span> <span class="op">*</span> <span class="va">n</span> <span class="op">/</span> <span class="va">kappa_n</span> <span class="op">*</span> <span class="op">(</span><span class="va">ybar</span> <span class="op">-</span> <span class="va">mu_0</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="va">nu_n</span></span>
<span>    <span class="va">log_dens</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="op">-</span><span class="va">nu_n</span> <span class="op">/</span> <span class="fl">2</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">sigma2</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="op">(</span><span class="op">-</span><span class="va">nu_n</span> <span class="op">*</span> <span class="va">sigma2_n</span> <span class="op">/</span> <span class="fl">2</span> <span class="op">/</span> <span class="va">sigma2</span><span class="op">)</span></span>
<span>    <span class="va">log_dens</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/is.finite.html">is.nan</a></span><span class="op">(</span><span class="va">log_dens</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="cn">Inf</span></span>
<span>    <span class="va">log_dens</span></span>
<span><span class="op">}</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">4.5</span><span class="op">)</span><span class="op">)</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">stat_function</span><span class="op">(</span>fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">-</span> <span class="fu">lp_sigma</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="va">sigma</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>         y <span class="op">=</span> <span class="st">"-log(density)"</span><span class="op">)</span></span>
<span><span class="va">p2</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_point</span><span class="op">(</span></span>
<span>        x <span class="op">=</span> <span class="fl">0.6</span>, y <span class="op">=</span> <span class="op">-</span><span class="fu">lp_sigma</span><span class="op">(</span><span class="fl">0.6</span><span class="op">)</span>,</span>
<span>        size <span class="op">=</span> <span class="fl">2</span></span>
<span>    <span class="op">)</span></span>
<span><span class="va">p2</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_point</span><span class="op">(</span></span>
<span>        x <span class="op">=</span> <span class="fl">1.4</span>, y <span class="op">=</span> <span class="op">-</span><span class="fu">lp_sigma</span><span class="op">(</span><span class="fl">1.4</span><span class="op">)</span>,</span>
<span>        size <span class="op">=</span> <span class="fl">2</span></span>
<span>    <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-posterior-sigma" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-posterior-sigma-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-posterior-sigma" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-posterior-sigma-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-posterior-sigma-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="09c-hmc_files/figure-html/fig-posterior-sigma-1.png" class="img-fluid figure-img" data-ref-parent="fig-posterior-sigma" width="384">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-posterior-sigma-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) High potential energy
</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-posterior-sigma" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-posterior-sigma-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-posterior-sigma-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="09c-hmc_files/figure-html/fig-posterior-sigma-2.png" class="img-fluid figure-img" data-ref-parent="fig-posterior-sigma" width="384">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-posterior-sigma-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Low potential energy
</figcaption></figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-posterior-sigma-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;17.4: Marginal log posterior distribution of <span class="math inline">\(\sigma^2\)</span>.
</figcaption></figure>
</div>
<p>For the graph on the left, the marble (represented as a dot) has high potential energy and should quickly go down to the bottom; on the right, the marble has low potential energy and should move less fast.</p>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>If the sampler is near the bottom (i.e., the point with high posterior density), it tends to stay there.</p>
</div>
</div>
</div>
<p>But we don’t want the marble to stay at the bottom without moving; otherwise, all our posterior draws will be just the posterior mode. In HMC, it moves the marble with a push, called <em>momentum</em>. The direction and the magnitude of the momentum will be randomly simulated, usually from a normal distribution. If the momentum is large, it should travel farther away; however, it also depends on the <em>gradient</em>, which is the slope in a one-dimension case.</p>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>HMC generates a proposed value by simulating the motion of an object on a surface, based on an initial momentum with a random magnitude and direction, and locating the object after a fixed amount of time.</p>
</div>
</div>
</div>
<p>At the beginning of a trajectory, the marble has a certain amount of kinetic and potential energy, and the sum is the total amount of energy, called the <em>Hamiltonian</em>. Based on the conservation of energy, at any point in the motion, the Hamiltonian should remain constant.</p>
<p>The following shows the trajectory of a point starting at 2, with a random momentum of 0.5 in the positive direction.</p>
<div id="fig-momentum-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-momentum-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/hmc1.gif" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-momentum-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;17.5: Animation of HMC trajectory (momentum to the right)
</figcaption></figure>
</div>
<p>This one has the same starting value, with a random momentum of 0.5 in the <em>negative</em> direction.</p>
<div id="fig-momentum-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-momentum-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/hmc2.gif" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-momentum-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;17.6: Animation of HMC trajectory (momentum to the left)
</figcaption></figure>
</div>
<section id="leapfrog-integrator" class="level2" data-number="17.1"><h2 data-number="17.1" class="anchored" data-anchor-id="leapfrog-integrator">
<span class="header-section-number">17.1</span> Leapfrog Integrator</h2>
<p>To simulate the marble’s motion, one needs to solve a system of differential equations, which is not an easy task. A standard method is the so-called <em>leapfrog</em> integrator, which discretizes a unit of time into <span class="math inline">\(L\)</span> steps. The following shows how it approximates the motion using <span class="math inline">\(L\)</span> = 3 and <span class="math inline">\(L\)</span> = 10 steps. The red dot is the target. As can be seen, larger <span class="math inline">\(L\)</span> simulates the motion more accurately.</p>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">num_steps</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">leapfrog_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span></span>
<span>    <span class="fu">leapfrog_step</span><span class="op">(</span><span class="fl">3</span>, rho <span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span>, num_steps <span class="op">=</span> <span class="va">num_steps</span><span class="op">)</span>,</span>
<span>    step <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="va">num_steps</span></span>
<span><span class="op">)</span></span>
<span><span class="va">final_x</span> <span class="op">&lt;-</span> <span class="fu">leapfrog_step</span><span class="op">(</span><span class="fl">3</span>, rho <span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span>, num_steps <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span><span class="op">[</span><span class="fl">1001</span>, <span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">p2</span> <span class="op">+</span> <span class="fu">geom_point</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">leapfrog_df</span>,</span>
<span>    <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="op">-</span><span class="fu">lp_sigma</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"green"</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_point</span><span class="op">(</span></span>
<span>        x <span class="op">=</span> <span class="va">final_x</span>, y <span class="op">=</span> <span class="op">-</span><span class="fu">lp_sigma</span><span class="op">(</span><span class="va">final_x</span><span class="op">)</span>,</span>
<span>        col <span class="op">=</span> <span class="st">"red"</span>, size <span class="op">=</span> <span class="fl">2</span>, shape <span class="op">=</span> <span class="fl">21</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_path</span><span class="op">(</span></span>
<span>        data <span class="op">=</span> <span class="va">leapfrog_df</span>,</span>
<span>        <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="op">-</span><span class="fu">lp_sigma</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"green"</span></span>
<span>    <span class="op">)</span></span>
<span><span class="va">num_steps</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span><span class="va">leapfrog_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span></span>
<span>    <span class="fu">leapfrog_step</span><span class="op">(</span><span class="fl">3</span>, rho <span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span>, num_steps <span class="op">=</span> <span class="va">num_steps</span><span class="op">)</span>,</span>
<span>    step <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="va">num_steps</span></span>
<span><span class="op">)</span></span>
<span><span class="va">p2</span> <span class="op">+</span> <span class="fu">geom_point</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">leapfrog_df</span>,</span>
<span>    <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="op">-</span><span class="fu">lp_sigma</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"green"</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_point</span><span class="op">(</span></span>
<span>        x <span class="op">=</span> <span class="va">final_x</span>, y <span class="op">=</span> <span class="op">-</span><span class="fu">lp_sigma</span><span class="op">(</span><span class="va">final_x</span><span class="op">)</span>,</span>
<span>        col <span class="op">=</span> <span class="st">"red"</span>, size <span class="op">=</span> <span class="fl">2</span>, shape <span class="op">=</span> <span class="fl">21</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_path</span><span class="op">(</span></span>
<span>        data <span class="op">=</span> <span class="va">leapfrog_df</span>,</span>
<span>        <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="op">-</span><span class="fu">lp_sigma</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"green"</span></span>
<span>    <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-posterior-sigma-leapfrog" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-posterior-sigma-leapfrog-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-posterior-sigma-leapfrog" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-posterior-sigma-leapfrog-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-posterior-sigma-leapfrog-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="09c-hmc_files/figure-html/fig-posterior-sigma-leapfrog-1.png" class="img-fluid figure-img" data-ref-parent="fig-posterior-sigma-leapfrog" width="384">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-posterior-sigma-leapfrog-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) 3 steps
</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-posterior-sigma-leapfrog" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-posterior-sigma-leapfrog-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-posterior-sigma-leapfrog-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="09c-hmc_files/figure-html/fig-posterior-sigma-leapfrog-2.png" class="img-fluid figure-img" data-ref-parent="fig-posterior-sigma-leapfrog" width="384">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-posterior-sigma-leapfrog-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) 10 steps
</figcaption></figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-posterior-sigma-leapfrog-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;17.7: Simulated motion using the leapfrog integrator.
</figcaption></figure>
</div>
<p>Suppose the simulated trajectory differs from the true trajectory by a certain threshold, like the one on the left. In that case, it is called a <em>divergent transition</em>, in which case the proposed value should not be trusted. In software like STAN, it will print out a warning about that. When the number of divergent transitions is large, one thing to do is increase <span class="math inline">\(L\)</span>. If that does not help, it may indicate difficulty in a high-dimensional model, and reparameterization may be needed.</p>
<p>For more information on HMC, go to <a href="https://mc-stan.org/docs/reference-manual/mcmc.html" class="uri">https://mc-stan.org/docs/reference-manual/mcmc.html</a>. You can also find some sample R code at <a href="http://www.stat.columbia.edu/~gelman/book/software.pdf" class="uri">http://www.stat.columbia.edu/~gelman/book/software.pdf</a>.</p>
</section><section id="the-no-u-turn-sampler-nuts" class="level2" data-number="17.2"><h2 data-number="17.2" class="anchored" data-anchor-id="the-no-u-turn-sampler-nuts">
<span class="header-section-number">17.2</span> The No-U-Turn Sampler (NUTS)</h2>
<p>Although HMC is more efficient by generating smarter proposal values, one performance bottleneck is that the motion sometimes takes a U-turn, like in some graphs above, in which the marble goes up (right) and then goes down (left), and eventually may stay in a similar location. The improvement of NUTS is that it uses a binary search tree that simulates both the forward and backward trajectory. The algorithm is complex, but to my understanding, it achieves two purposes: (a) finding the path that avoids a U-turn and (b) selecting an appropriate number of leapfrog steps, <span class="math inline">\(L\)</span>. When each leapfrog step moves slowly, the search process may take a long time. With NUTS, one can control the maximum <em>depth</em> of the search tree.</p>
<p>See <a href="https://mc-stan.org/docs/reference-manual/mcmc.html#hmc-algorithm-parameters" class="uri">https://mc-stan.org/docs/reference-manual/mcmc.html#hmc-algorithm-parameters</a> for more information on NUTS.</p>


<!-- -->

</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./09b-gibbs.html" class="pagination-link" aria-label="Gibbs Sampling">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Gibbs Sampling</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./10-glm.html" class="pagination-link" aria-label="Generalized Linear Model">
        <span class="nav-page-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Generalized Linear Model</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb6" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># Hamiltonian Monte Carlo</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>comma <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">digits =</span> <span class="dv">2</span>L) <span class="fu">format</span>(x, <span class="at">digits =</span> digits, <span class="at">big.mark =</span> <span class="st">","</span>)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">panel.grid.major.y =</span> <span class="fu">element_line</span>(<span class="at">color =</span> <span class="st">"grey92"</span>)))</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>A more recent development in MCMC is the development of algorithms under the umbrella of *Hamiltonian Monte Carlo* or *hybrid Monte Carlo* (HMC). The algorithm is a bit complex, and my goal is to help you develop some intuition of the algorithm, hopefully, enough to help you diagnose the Markov chains.</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>It produces simulation samples that are much less correlated, meaning that if you get 10,000 samples from Metropolis and 10,000 samples from HMC, HMC generally provides a much higher effective sample size (ESS). </span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>It does not require conjugate priors</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>When there is a problem in convergence, HMC tends to raise a clear red flag, meaning it goes really, really wrong.</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>So now, how does HMC work? First, consider a two-dimensional posterior below, which is the posterior of $(\mu, \sigma^2)$ from a normal model.</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-normal-posterior</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: Joint posterior of $(\mu, \sigma^2)$ from a normal model.</span></span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-asp: 1</span></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>ybar <span class="ot">&lt;-</span> <span class="fl">3.096129</span></span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>s2y <span class="ot">&lt;-</span> <span class="fl">1.356451</span></span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">31</span></span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Hyperparameters</span></span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>mu_0 <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>sigma2_0 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>kappa_0 <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">2</span></span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>nu_0 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Joint log density</span></span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>lp_mu_sigma <span class="ot">&lt;-</span> <span class="cf">function</span>(mu, sigma2) {</span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a>    kappa_n <span class="ot">&lt;-</span> kappa_0 <span class="sc">+</span> n</span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a>    mu_n <span class="ot">&lt;-</span> (kappa_0 <span class="sc">*</span> mu_0 <span class="sc">+</span> n <span class="sc">*</span> ybar) <span class="sc">/</span> kappa_n</span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>    nu_n <span class="ot">&lt;-</span> nu_0 <span class="sc">+</span> n</span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a>    sigma2_n <span class="ot">&lt;-</span> (nu_0 <span class="sc">*</span> sigma2_0 <span class="sc">+</span> (n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> s2y <span class="sc">+</span></span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a>        kappa_0 <span class="sc">*</span> n <span class="sc">/</span> kappa_n <span class="sc">*</span> (ybar <span class="sc">-</span> mu_0)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> nu_n</span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a>    log_dens <span class="ot">&lt;-</span> <span class="sc">-</span>(mu <span class="sc">-</span> mu_n)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="dv">2</span> <span class="sc">/</span> sigma2 <span class="sc">*</span> kappa_n <span class="sc">+</span></span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a>        (<span class="sc">-</span>nu_n <span class="sc">/</span> <span class="dv">2</span> <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">log</span>(sigma2) <span class="sc">+</span></span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a>        (<span class="sc">-</span>nu_n <span class="sc">*</span> sigma2_n <span class="sc">/</span> <span class="dv">2</span> <span class="sc">/</span> sigma2)</span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a>    log_dens[<span class="fu">is.nan</span>(log_dens)] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="cn">Inf</span></span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a>    log_dens</span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true" tabindex="-1"></a>num_gridpoints <span class="ot">&lt;-</span> <span class="dv">51</span></span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true" tabindex="-1"></a>mu_grid <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">2</span>, <span class="at">to =</span> <span class="dv">4</span>, <span class="at">length.out =</span> num_gridpoints)</span>
<span id="cb6-53"><a href="#cb6-53" aria-hidden="true" tabindex="-1"></a>sigma2_grid <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.5</span>, <span class="at">to =</span> <span class="fl">4.5</span>, <span class="at">length.out =</span> num_gridpoints)</span>
<span id="cb6-54"><a href="#cb6-54" aria-hidden="true" tabindex="-1"></a>grid_density <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">outer</span>(mu_grid,</span>
<span id="cb6-55"><a href="#cb6-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">Y =</span> sigma2_grid,</span>
<span id="cb6-56"><a href="#cb6-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">FUN =</span> lp_mu_sigma</span>
<span id="cb6-57"><a href="#cb6-57" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb6-58"><a href="#cb6-58" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(</span>
<span id="cb6-59"><a href="#cb6-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="sc">~</span>sigma2_grid, <span class="at">y =</span> <span class="sc">~</span>mu_grid, <span class="at">z =</span> <span class="sc">~</span>grid_density,</span>
<span id="cb6-60"><a href="#cb6-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">"surface"</span></span>
<span id="cb6-61"><a href="#cb6-61" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-62"><a href="#cb6-62" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb6-63"><a href="#cb6-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-64"><a href="#cb6-64" aria-hidden="true" tabindex="-1"></a>The HMC algorithm improves from the Metropolis algorithm by simulating smart proposal values. It does so by using the *gradient* of the logarithm of the posterior density. Let's first take the log of the joint density:</span>
<span id="cb6-65"><a href="#cb6-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-68"><a href="#cb6-68" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb6-69"><a href="#cb6-69" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb6-70"><a href="#cb6-70" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-normal-gradient</span></span>
<span id="cb6-71"><a href="#cb6-71" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: Gradient of $(\mu, \sigma^2)$ from a normal model.</span></span>
<span id="cb6-72"><a href="#cb6-72" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-asp: 1</span></span>
<span id="cb6-73"><a href="#cb6-73" aria-hidden="true" tabindex="-1"></a>grid_logdensity <span class="ot">&lt;-</span> <span class="fu">outer</span>(mu_grid,</span>
<span id="cb6-74"><a href="#cb6-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">Y =</span> sigma2_grid,</span>
<span id="cb6-75"><a href="#cb6-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">FUN =</span> lp_mu_sigma</span>
<span id="cb6-76"><a href="#cb6-76" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-77"><a href="#cb6-77" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(</span>
<span id="cb6-78"><a href="#cb6-78" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="sc">~</span>sigma2_grid, <span class="at">y =</span> <span class="sc">~</span>mu_grid, <span class="at">z =</span> <span class="sc">~</span>grid_logdensity,</span>
<span id="cb6-79"><a href="#cb6-79" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">"surface"</span></span>
<span id="cb6-80"><a href="#cb6-80" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-81"><a href="#cb6-81" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb6-82"><a href="#cb6-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-83"><a href="#cb6-83" aria-hidden="true" tabindex="-1"></a>Now, flip it upside-down.</span>
<span id="cb6-84"><a href="#cb6-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-87"><a href="#cb6-87" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb6-88"><a href="#cb6-88" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb6-89"><a href="#cb6-89" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-normal-negative-gradient</span></span>
<span id="cb6-90"><a href="#cb6-90" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: \"Flipped\" gradient of $(\mu, \sigma^2)$ from a normal model.</span></span>
<span id="cb6-91"><a href="#cb6-91" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-asp: 1</span></span>
<span id="cb6-92"><a href="#cb6-92" aria-hidden="true" tabindex="-1"></a>grid_minuslogdensity <span class="ot">&lt;-</span> <span class="sc">-</span> <span class="fu">outer</span>(mu_grid,</span>
<span id="cb6-93"><a href="#cb6-93" aria-hidden="true" tabindex="-1"></a>    <span class="at">Y =</span> sigma2_grid,</span>
<span id="cb6-94"><a href="#cb6-94" aria-hidden="true" tabindex="-1"></a>    <span class="at">FUN =</span> lp_mu_sigma</span>
<span id="cb6-95"><a href="#cb6-95" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-96"><a href="#cb6-96" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(</span>
<span id="cb6-97"><a href="#cb6-97" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="sc">~</span>sigma2_grid, <span class="at">y =</span> <span class="sc">~</span>mu_grid, <span class="at">z =</span> <span class="sc">~</span>grid_minuslogdensity,</span>
<span id="cb6-98"><a href="#cb6-98" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">"surface"</span></span>
<span id="cb6-99"><a href="#cb6-99" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-100"><a href="#cb6-100" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb6-101"><a href="#cb6-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-102"><a href="#cb6-102" aria-hidden="true" tabindex="-1"></a>Imagine placing a marble on the above surface. With gravity, it is natural that the marble will have a tendency to move to the bottom of the surface. If you place the marble in a higher location, it will have a higher *potential energy* and tends to move faster towards the bottom, because that energy converts to a larger *kinetic energy*. If you place it close to the bottom, it will tend to move slower.</span>
<span id="cb6-103"><a href="#cb6-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-104"><a href="#cb6-104" aria-hidden="true" tabindex="-1"></a>For simplicity, let's consider just one dimension with the following picture:</span>
<span id="cb6-105"><a href="#cb6-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-108"><a href="#cb6-108" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb6-109"><a href="#cb6-109" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb6-110"><a href="#cb6-110" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-posterior-sigma</span></span>
<span id="cb6-111"><a href="#cb6-111" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-ncol: 2</span></span>
<span id="cb6-112"><a href="#cb6-112" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 4</span></span>
<span id="cb6-113"><a href="#cb6-113" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-asp: 1</span></span>
<span id="cb6-114"><a href="#cb6-114" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: Marginal log posterior distribution of $\sigma^2$.</span></span>
<span id="cb6-115"><a href="#cb6-115" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-subcap:</span></span>
<span id="cb6-116"><a href="#cb6-116" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - High potential energy</span></span>
<span id="cb6-117"><a href="#cb6-117" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - Low potential energy</span></span>
<span id="cb6-118"><a href="#cb6-118" aria-hidden="true" tabindex="-1"></a>lp_sigma <span class="ot">&lt;-</span> <span class="cf">function</span>(sigma2) {</span>
<span id="cb6-119"><a href="#cb6-119" aria-hidden="true" tabindex="-1"></a>    kappa_n <span class="ot">&lt;-</span> kappa_0 <span class="sc">+</span> n</span>
<span id="cb6-120"><a href="#cb6-120" aria-hidden="true" tabindex="-1"></a>    nu_n <span class="ot">&lt;-</span> nu_0 <span class="sc">+</span> n</span>
<span id="cb6-121"><a href="#cb6-121" aria-hidden="true" tabindex="-1"></a>    sigma2_n <span class="ot">&lt;-</span> (nu_0 <span class="sc">*</span> sigma2_0 <span class="sc">+</span> (n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> s2y <span class="sc">+</span></span>
<span id="cb6-122"><a href="#cb6-122" aria-hidden="true" tabindex="-1"></a>        kappa_0 <span class="sc">*</span> n <span class="sc">/</span> kappa_n <span class="sc">*</span> (ybar <span class="sc">-</span> mu_0)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> nu_n</span>
<span id="cb6-123"><a href="#cb6-123" aria-hidden="true" tabindex="-1"></a>    log_dens <span class="ot">&lt;-</span> (<span class="sc">-</span>nu_n <span class="sc">/</span> <span class="dv">2</span> <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">log</span>(sigma2) <span class="sc">+</span></span>
<span id="cb6-124"><a href="#cb6-124" aria-hidden="true" tabindex="-1"></a>        (<span class="sc">-</span>nu_n <span class="sc">*</span> sigma2_n <span class="sc">/</span> <span class="dv">2</span> <span class="sc">/</span> sigma2)</span>
<span id="cb6-125"><a href="#cb6-125" aria-hidden="true" tabindex="-1"></a>    log_dens[<span class="fu">is.nan</span>(log_dens)] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="cn">Inf</span></span>
<span id="cb6-126"><a href="#cb6-126" aria-hidden="true" tabindex="-1"></a>    log_dens</span>
<span id="cb6-127"><a href="#cb6-127" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-128"><a href="#cb6-128" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">4.5</span>)), <span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span></span>
<span id="cb6-129"><a href="#cb6-129" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) <span class="sc">-</span> <span class="fu">lp_sigma</span>(x)) <span class="sc">+</span></span>
<span id="cb6-130"><a href="#cb6-130" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(sigma<span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb6-131"><a href="#cb6-131" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">"-log(density)"</span>)</span>
<span id="cb6-132"><a href="#cb6-132" aria-hidden="true" tabindex="-1"></a>p2 <span class="sc">+</span></span>
<span id="cb6-133"><a href="#cb6-133" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(</span>
<span id="cb6-134"><a href="#cb6-134" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="fl">0.6</span>, <span class="at">y =</span> <span class="sc">-</span><span class="fu">lp_sigma</span>(<span class="fl">0.6</span>),</span>
<span id="cb6-135"><a href="#cb6-135" aria-hidden="true" tabindex="-1"></a>        <span class="at">size =</span> <span class="dv">2</span></span>
<span id="cb6-136"><a href="#cb6-136" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb6-137"><a href="#cb6-137" aria-hidden="true" tabindex="-1"></a>p2 <span class="sc">+</span></span>
<span id="cb6-138"><a href="#cb6-138" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(</span>
<span id="cb6-139"><a href="#cb6-139" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="fl">1.4</span>, <span class="at">y =</span> <span class="sc">-</span><span class="fu">lp_sigma</span>(<span class="fl">1.4</span>),</span>
<span id="cb6-140"><a href="#cb6-140" aria-hidden="true" tabindex="-1"></a>        <span class="at">size =</span> <span class="dv">2</span></span>
<span id="cb6-141"><a href="#cb6-141" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb6-142"><a href="#cb6-142" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb6-143"><a href="#cb6-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-144"><a href="#cb6-144" aria-hidden="true" tabindex="-1"></a>For the graph on the left, the marble (represented as a dot) has high potential energy and should quickly go down to the bottom; on the right, the marble has low potential energy and should move less fast. </span>
<span id="cb6-145"><a href="#cb6-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-146"><a href="#cb6-146" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb6-147"><a href="#cb6-147" aria-hidden="true" tabindex="-1"></a>If the sampler is near the bottom (i.e., the point with high posterior density), it tends to stay there.</span>
<span id="cb6-148"><a href="#cb6-148" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb6-149"><a href="#cb6-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-150"><a href="#cb6-150" aria-hidden="true" tabindex="-1"></a>But we don't want the marble to stay at the bottom without moving; otherwise, all our posterior draws will be just the posterior mode. In HMC, it moves the marble with a push, called *momentum*. The direction and the magnitude of the momentum will be randomly simulated, usually from a normal distribution. If the momentum is large, it should travel farther away; however, it also depends on the *gradient*, which is the slope in a one-dimension case.</span>
<span id="cb6-151"><a href="#cb6-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-152"><a href="#cb6-152" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb6-153"><a href="#cb6-153" aria-hidden="true" tabindex="-1"></a>HMC generates a proposed value by simulating the motion of an object on a surface, based on an initial momentum with a random magnitude and direction, and locating the object after a fixed amount of time.</span>
<span id="cb6-154"><a href="#cb6-154" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb6-155"><a href="#cb6-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-156"><a href="#cb6-156" aria-hidden="true" tabindex="-1"></a>At the beginning of a trajectory, the marble has a certain amount of kinetic and potential energy, and the sum is the total amount of energy, called the *Hamiltonian*. Based on the conservation of energy, at any point in the motion, the Hamiltonian should remain constant. </span>
<span id="cb6-157"><a href="#cb6-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-160"><a href="#cb6-160" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb6-161"><a href="#cb6-161" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb6-162"><a href="#cb6-162" aria-hidden="true" tabindex="-1"></a>leapfrog_step <span class="ot">&lt;-</span> <span class="cf">function</span>(x, rho, num_steps, <span class="at">eps =</span> <span class="dv">1</span> <span class="sc">/</span> num_steps) {</span>
<span id="cb6-163"><a href="#cb6-163" aria-hidden="true" tabindex="-1"></a>    out <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, num_steps <span class="sc">+</span> <span class="dv">1</span>),</span>
<span id="cb6-164"><a href="#cb6-164" aria-hidden="true" tabindex="-1"></a>                      <span class="at">rho =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, num_steps <span class="sc">+</span> <span class="dv">1</span>))</span>
<span id="cb6-165"><a href="#cb6-165" aria-hidden="true" tabindex="-1"></a>    out[<span class="dv">1</span>, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(x, rho)</span>
<span id="cb6-166"><a href="#cb6-166" aria-hidden="true" tabindex="-1"></a>    kappa_n <span class="ot">&lt;-</span> kappa_0 <span class="sc">+</span> n</span>
<span id="cb6-167"><a href="#cb6-167" aria-hidden="true" tabindex="-1"></a>    nu_n <span class="ot">&lt;-</span> nu_0 <span class="sc">+</span> n</span>
<span id="cb6-168"><a href="#cb6-168" aria-hidden="true" tabindex="-1"></a>    sigma2_n <span class="ot">&lt;-</span> (nu_0 <span class="sc">*</span> sigma2_0 <span class="sc">+</span> (n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> s2y <span class="sc">+</span></span>
<span id="cb6-169"><a href="#cb6-169" aria-hidden="true" tabindex="-1"></a>        kappa_0 <span class="sc">*</span> n <span class="sc">/</span> kappa_n <span class="sc">*</span> (ybar <span class="sc">-</span> mu_0)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> nu_n</span>
<span id="cb6-170"><a href="#cb6-170" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_len</span>(num_steps)) {</span>
<span id="cb6-171"><a href="#cb6-171" aria-hidden="true" tabindex="-1"></a>        rho <span class="ot">&lt;-</span> rho <span class="sc">-</span> eps <span class="sc">/</span> <span class="dv">2</span> <span class="sc">*</span></span>
<span id="cb6-172"><a href="#cb6-172" aria-hidden="true" tabindex="-1"></a>            ((nu_n <span class="sc">/</span> <span class="dv">2</span> <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">/</span> x <span class="sc">-</span> nu_n <span class="sc">*</span> sigma2_n <span class="sc">/</span> <span class="dv">2</span> <span class="sc">/</span> x<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb6-173"><a href="#cb6-173" aria-hidden="true" tabindex="-1"></a>        x <span class="ot">&lt;-</span> x <span class="sc">+</span> eps <span class="sc">*</span> rho</span>
<span id="cb6-174"><a href="#cb6-174" aria-hidden="true" tabindex="-1"></a>        rho <span class="ot">&lt;-</span> rho <span class="sc">-</span> eps <span class="sc">/</span> <span class="dv">2</span> <span class="sc">*</span></span>
<span id="cb6-175"><a href="#cb6-175" aria-hidden="true" tabindex="-1"></a>            ((nu_n <span class="sc">/</span> <span class="dv">2</span> <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">/</span> x <span class="sc">-</span> nu_n <span class="sc">*</span> sigma2_n <span class="sc">/</span> <span class="dv">2</span> <span class="sc">/</span> x<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb6-176"><a href="#cb6-176" aria-hidden="true" tabindex="-1"></a>        out[i <span class="sc">+</span> <span class="dv">1</span>, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(x, rho)</span>
<span id="cb6-177"><a href="#cb6-177" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb6-178"><a href="#cb6-178" aria-hidden="true" tabindex="-1"></a>    out</span>
<span id="cb6-179"><a href="#cb6-179" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-180"><a href="#cb6-180" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb6-181"><a href="#cb6-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-182"><a href="#cb6-182" aria-hidden="true" tabindex="-1"></a>::: {.content-visible when-format="html"}</span>
<span id="cb6-183"><a href="#cb6-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-184"><a href="#cb6-184" aria-hidden="true" tabindex="-1"></a>The following shows the trajectory of a point starting at 2, with a random momentum of 0.5 in the positive direction.</span>
<span id="cb6-185"><a href="#cb6-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-188"><a href="#cb6-188" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb6-189"><a href="#cb6-189" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb6-190"><a href="#cb6-190" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: !expr '!file.exists("images/hmc1.gif")'</span></span>
<span id="cb6-191"><a href="#cb6-191" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gganimate)</span>
<span id="cb6-192"><a href="#cb6-192" aria-hidden="true" tabindex="-1"></a>num_steps <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb6-193"><a href="#cb6-193" aria-hidden="true" tabindex="-1"></a>leapfrog_steps <span class="ot">&lt;-</span> <span class="fu">leapfrog_step</span>(<span class="dv">2</span>, <span class="at">rho =</span> <span class="fl">0.5</span>, <span class="at">num_steps =</span> num_steps)</span>
<span id="cb6-194"><a href="#cb6-194" aria-hidden="true" tabindex="-1"></a>p_animate <span class="ot">&lt;-</span></span>
<span id="cb6-195"><a href="#cb6-195" aria-hidden="true" tabindex="-1"></a>    p2 <span class="sc">+</span> <span class="fu">geom_point</span>(</span>
<span id="cb6-196"><a href="#cb6-196" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> <span class="fu">cbind</span>(leapfrog_steps, <span class="at">step =</span> <span class="dv">0</span><span class="sc">:</span>num_steps),</span>
<span id="cb6-197"><a href="#cb6-197" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> <span class="sc">-</span><span class="fu">lp_sigma</span>(x))</span>
<span id="cb6-198"><a href="#cb6-198" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb6-199"><a href="#cb6-199" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(sigma<span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb6-200"><a href="#cb6-200" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">"-log(density)"</span>) <span class="sc">+</span></span>
<span id="cb6-201"><a href="#cb6-201" aria-hidden="true" tabindex="-1"></a>    <span class="fu">transition_time</span>(step)</span>
<span id="cb6-202"><a href="#cb6-202" aria-hidden="true" tabindex="-1"></a><span class="fu">animate</span>(p_animate,</span>
<span id="cb6-203"><a href="#cb6-203" aria-hidden="true" tabindex="-1"></a>    <span class="at">nframes =</span> num_steps <span class="sc">+</span> <span class="dv">1</span>, <span class="at">fps =</span> num_steps <span class="sc">/</span> <span class="dv">2</span>,</span>
<span id="cb6-204"><a href="#cb6-204" aria-hidden="true" tabindex="-1"></a>    <span class="at">renderer =</span> <span class="fu">gifski_renderer</span>(),</span>
<span id="cb6-205"><a href="#cb6-205" aria-hidden="true" tabindex="-1"></a>    <span class="at">end_pause =</span> <span class="dv">10</span></span>
<span id="cb6-206"><a href="#cb6-206" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-207"><a href="#cb6-207" aria-hidden="true" tabindex="-1"></a><span class="fu">anim_save</span>(<span class="st">"images/hmc1.gif"</span>)</span>
<span id="cb6-208"><a href="#cb6-208" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb6-209"><a href="#cb6-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-210"><a href="#cb6-210" aria-hidden="true" tabindex="-1"></a><span class="al">![Animation of HMC trajectory (momentum to the right)](images/hmc1.gif)</span>{#fig-momentum-1}</span>
<span id="cb6-211"><a href="#cb6-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-212"><a href="#cb6-212" aria-hidden="true" tabindex="-1"></a>This one has the same starting value, with a random momentum of 0.5 in the *negative* direction.</span>
<span id="cb6-213"><a href="#cb6-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-216"><a href="#cb6-216" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb6-217"><a href="#cb6-217" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb6-218"><a href="#cb6-218" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: !expr '!file.exists("images/hmc2.gif")'</span></span>
<span id="cb6-219"><a href="#cb6-219" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gganimate)</span>
<span id="cb6-220"><a href="#cb6-220" aria-hidden="true" tabindex="-1"></a>num_steps <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb6-221"><a href="#cb6-221" aria-hidden="true" tabindex="-1"></a>leapfrog_steps <span class="ot">&lt;-</span> <span class="fu">leapfrog_step</span>(<span class="dv">2</span>, <span class="at">rho =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">num_steps =</span> num_steps)</span>
<span id="cb6-222"><a href="#cb6-222" aria-hidden="true" tabindex="-1"></a>p_animate <span class="ot">&lt;-</span></span>
<span id="cb6-223"><a href="#cb6-223" aria-hidden="true" tabindex="-1"></a>    p2 <span class="sc">+</span> <span class="fu">geom_point</span>(</span>
<span id="cb6-224"><a href="#cb6-224" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> <span class="fu">cbind</span>(leapfrog_steps, <span class="at">step =</span> <span class="dv">0</span><span class="sc">:</span>num_steps),</span>
<span id="cb6-225"><a href="#cb6-225" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> <span class="sc">-</span><span class="fu">lp_sigma</span>(x))</span>
<span id="cb6-226"><a href="#cb6-226" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb6-227"><a href="#cb6-227" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(sigma<span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb6-228"><a href="#cb6-228" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">"-log(density)"</span>) <span class="sc">+</span></span>
<span id="cb6-229"><a href="#cb6-229" aria-hidden="true" tabindex="-1"></a>    <span class="fu">transition_time</span>(step)</span>
<span id="cb6-230"><a href="#cb6-230" aria-hidden="true" tabindex="-1"></a><span class="fu">animate</span>(p_animate,</span>
<span id="cb6-231"><a href="#cb6-231" aria-hidden="true" tabindex="-1"></a>    <span class="at">nframes =</span> num_steps <span class="sc">+</span> <span class="dv">1</span>, <span class="at">fps =</span> num_steps <span class="sc">/</span> <span class="dv">2</span>,</span>
<span id="cb6-232"><a href="#cb6-232" aria-hidden="true" tabindex="-1"></a>    <span class="at">renderer =</span> <span class="fu">gifski_renderer</span>(),</span>
<span id="cb6-233"><a href="#cb6-233" aria-hidden="true" tabindex="-1"></a>    <span class="at">end_pause =</span> <span class="dv">10</span></span>
<span id="cb6-234"><a href="#cb6-234" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-235"><a href="#cb6-235" aria-hidden="true" tabindex="-1"></a><span class="fu">anim_save</span>(<span class="st">"images/hmc2.gif"</span>)</span>
<span id="cb6-236"><a href="#cb6-236" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb6-237"><a href="#cb6-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-238"><a href="#cb6-238" aria-hidden="true" tabindex="-1"></a><span class="al">![Animation of HMC trajectory (momentum to the left)](images/hmc2.gif)</span>{#fig-momentum-2}</span>
<span id="cb6-239"><a href="#cb6-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-240"><a href="#cb6-240" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb6-241"><a href="#cb6-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-242"><a href="#cb6-242" aria-hidden="true" tabindex="-1"></a><span class="fu">## Leapfrog Integrator</span></span>
<span id="cb6-243"><a href="#cb6-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-244"><a href="#cb6-244" aria-hidden="true" tabindex="-1"></a>To simulate the marble's motion, one needs to solve a system of differential equations, which is not an easy task. A standard method is  the so-called *leapfrog* integrator, which discretizes a unit of time into $L$ steps. The following shows how it approximates the motion using $L$ = 3 and $L$ = 10 steps. The red dot is the target. As can be seen, larger $L$ simulates the motion more accurately. </span>
<span id="cb6-245"><a href="#cb6-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-248"><a href="#cb6-248" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb6-249"><a href="#cb6-249" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb6-250"><a href="#cb6-250" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-posterior-sigma-leapfrog</span></span>
<span id="cb6-251"><a href="#cb6-251" aria-hidden="true" tabindex="-1"></a><span class="co">#| layout-ncol: 2</span></span>
<span id="cb6-252"><a href="#cb6-252" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 4</span></span>
<span id="cb6-253"><a href="#cb6-253" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-asp: 1</span></span>
<span id="cb6-254"><a href="#cb6-254" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: Simulated motion using the leapfrog integrator.</span></span>
<span id="cb6-255"><a href="#cb6-255" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-subcap:</span></span>
<span id="cb6-256"><a href="#cb6-256" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - 3 steps</span></span>
<span id="cb6-257"><a href="#cb6-257" aria-hidden="true" tabindex="-1"></a><span class="co">#|   - 10 steps</span></span>
<span id="cb6-258"><a href="#cb6-258" aria-hidden="true" tabindex="-1"></a>num_steps <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb6-259"><a href="#cb6-259" aria-hidden="true" tabindex="-1"></a>leapfrog_df <span class="ot">&lt;-</span> <span class="fu">cbind</span>(</span>
<span id="cb6-260"><a href="#cb6-260" aria-hidden="true" tabindex="-1"></a>    <span class="fu">leapfrog_step</span>(<span class="dv">3</span>, <span class="at">rho =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">num_steps =</span> num_steps),</span>
<span id="cb6-261"><a href="#cb6-261" aria-hidden="true" tabindex="-1"></a>    <span class="at">step =</span> <span class="dv">0</span><span class="sc">:</span>num_steps</span>
<span id="cb6-262"><a href="#cb6-262" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-263"><a href="#cb6-263" aria-hidden="true" tabindex="-1"></a>final_x <span class="ot">&lt;-</span> <span class="fu">leapfrog_step</span>(<span class="dv">3</span>, <span class="at">rho =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">num_steps =</span> <span class="dv">1000</span>)[<span class="dv">1001</span>, <span class="dv">1</span>]</span>
<span id="cb6-264"><a href="#cb6-264" aria-hidden="true" tabindex="-1"></a>p2 <span class="sc">+</span> <span class="fu">geom_point</span>(</span>
<span id="cb6-265"><a href="#cb6-265" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> leapfrog_df,</span>
<span id="cb6-266"><a href="#cb6-266" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> <span class="sc">-</span><span class="fu">lp_sigma</span>(x)), <span class="at">col =</span> <span class="st">"green"</span></span>
<span id="cb6-267"><a href="#cb6-267" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb6-268"><a href="#cb6-268" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(</span>
<span id="cb6-269"><a href="#cb6-269" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> final_x, <span class="at">y =</span> <span class="sc">-</span><span class="fu">lp_sigma</span>(final_x),</span>
<span id="cb6-270"><a href="#cb6-270" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">shape =</span> <span class="dv">21</span></span>
<span id="cb6-271"><a href="#cb6-271" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb6-272"><a href="#cb6-272" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_path</span>(</span>
<span id="cb6-273"><a href="#cb6-273" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> leapfrog_df,</span>
<span id="cb6-274"><a href="#cb6-274" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> <span class="sc">-</span><span class="fu">lp_sigma</span>(x)), <span class="at">col =</span> <span class="st">"green"</span></span>
<span id="cb6-275"><a href="#cb6-275" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb6-276"><a href="#cb6-276" aria-hidden="true" tabindex="-1"></a>num_steps <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb6-277"><a href="#cb6-277" aria-hidden="true" tabindex="-1"></a>leapfrog_df <span class="ot">&lt;-</span> <span class="fu">cbind</span>(</span>
<span id="cb6-278"><a href="#cb6-278" aria-hidden="true" tabindex="-1"></a>    <span class="fu">leapfrog_step</span>(<span class="dv">3</span>, <span class="at">rho =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">num_steps =</span> num_steps),</span>
<span id="cb6-279"><a href="#cb6-279" aria-hidden="true" tabindex="-1"></a>    <span class="at">step =</span> <span class="dv">0</span><span class="sc">:</span>num_steps</span>
<span id="cb6-280"><a href="#cb6-280" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-281"><a href="#cb6-281" aria-hidden="true" tabindex="-1"></a>p2 <span class="sc">+</span> <span class="fu">geom_point</span>(</span>
<span id="cb6-282"><a href="#cb6-282" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> leapfrog_df,</span>
<span id="cb6-283"><a href="#cb6-283" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> <span class="sc">-</span><span class="fu">lp_sigma</span>(x)), <span class="at">col =</span> <span class="st">"green"</span></span>
<span id="cb6-284"><a href="#cb6-284" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb6-285"><a href="#cb6-285" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(</span>
<span id="cb6-286"><a href="#cb6-286" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> final_x, <span class="at">y =</span> <span class="sc">-</span><span class="fu">lp_sigma</span>(final_x),</span>
<span id="cb6-287"><a href="#cb6-287" aria-hidden="true" tabindex="-1"></a>        <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">shape =</span> <span class="dv">21</span></span>
<span id="cb6-288"><a href="#cb6-288" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb6-289"><a href="#cb6-289" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_path</span>(</span>
<span id="cb6-290"><a href="#cb6-290" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> leapfrog_df,</span>
<span id="cb6-291"><a href="#cb6-291" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> <span class="sc">-</span><span class="fu">lp_sigma</span>(x)), <span class="at">col =</span> <span class="st">"green"</span></span>
<span id="cb6-292"><a href="#cb6-292" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb6-293"><a href="#cb6-293" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb6-294"><a href="#cb6-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-295"><a href="#cb6-295" aria-hidden="true" tabindex="-1"></a>Suppose the simulated trajectory differs from the true trajectory by a certain threshold, like the one on the left. In that case, it is called a *divergent transition*, in which case the proposed value should not be trusted. In software like STAN, it will print out a warning about that. When the number of divergent transitions is large, one thing to do is increase $L$. If that does not help, it may indicate difficulty in a high-dimensional model, and reparameterization may be needed.</span>
<span id="cb6-296"><a href="#cb6-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-297"><a href="#cb6-297" aria-hidden="true" tabindex="-1"></a>For more information on HMC, go to <span class="ot">&lt;https://mc-stan.org/docs/reference-manual/mcmc.html&gt;</span>. You can also find some sample R code at <span class="ot">&lt;http://www.stat.columbia.edu/~gelman/book/software.pdf&gt;</span>.</span>
<span id="cb6-298"><a href="#cb6-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-299"><a href="#cb6-299" aria-hidden="true" tabindex="-1"></a><span class="fu">## The No-U-Turn Sampler (NUTS)</span></span>
<span id="cb6-300"><a href="#cb6-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-301"><a href="#cb6-301" aria-hidden="true" tabindex="-1"></a>Although HMC is more efficient by generating smarter proposal values, one performance bottleneck is that the motion sometimes takes a U-turn, like in some graphs above, in which the marble goes up (right) and then goes down (left), and eventually may stay in a similar location. The improvement of NUTS is that it uses a binary search tree that simulates both the forward and backward trajectory. The algorithm is complex, but to my understanding, it achieves two purposes: (a) finding the path that avoids a U-turn and (b) selecting an appropriate number of leapfrog steps, $L$. When each leapfrog step moves slowly, the search process may take a long time. With NUTS, one can control the maximum *depth* of the search tree.</span>
<span id="cb6-302"><a href="#cb6-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-303"><a href="#cb6-303" aria-hidden="true" tabindex="-1"></a>See <span class="ot">&lt;https://mc-stan.org/docs/reference-manual/mcmc.html#hmc-algorithm-parameters&gt;</span> for more information on NUTS.</span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p>Copyright 2024, Hok Chio (Mark) Lai</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>This book was built with <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>


</body></html>